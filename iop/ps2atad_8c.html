<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ps2sdk: iop/dev9/atad/src/ps2atad.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="code.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ps2sdk
   &#160;<span id="projectnumber">1.1</span>
   </div>
   <div id="projectbrief">A collection of Open Source libraries used for developing applications on Sony&#39;s PlayStation 2Â® (PS2).</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('ps2atad_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">ps2atad.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;types.h&gt;</code><br />
<code>#include &lt;<a class="el" href="defs_8h_source.html">defs.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="irx_8h_source.html">irx.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="loadcore_8h_source.html">loadcore.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="thbase_8h_source.html">thbase.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="thevent_8h_source.html">thevent.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="stdio_8h_source.html">stdio.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="sysclib_8h_source.html">sysclib.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="dev9_8h_source.html">dev9.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="atad_8h_source.html">atad.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="speedregs_8h_source.html">speedregs.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="atahw_8h_source.html">atahw.h</a>&gt;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for ps2atad.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="ps2atad_8c__incl.svg" width="100%" height="552"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div>
<p><a href="ps2atad_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structata__cmd__info__t.html">ata_cmd_info_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structata__cmd__state__t.html">ata_cmd_state_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a0d598793f4b45908f46521f31f108dff"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a0d598793f4b45908f46521f31f108dff">MODNAME</a>&#160;&#160;&#160;&quot;atad&quot;</td></tr>
<tr class="separator:a0d598793f4b45908f46521f31f108dff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1250382de8ce63fd75727fe97bbb8187"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a1250382de8ce63fd75727fe97bbb8187">M_PRINTF</a>(<a class="el" href="iomanX_8c.html#a7454b3cf0ebfcba54720071dbd0d8d20">format</a>,  args...)&#160;&#160;&#160;	<a class="el" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<a class="el" href="usb_2usbmass__bd_2src_2main_8c.html#a0d598793f4b45908f46521f31f108dff">MODNAME</a> &quot;: &quot; <a class="el" href="iomanX_8c.html#a7454b3cf0ebfcba54720071dbd0d8d20">format</a>, ## args)</td></tr>
<tr class="separator:a1250382de8ce63fd75727fe97bbb8187"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46c1fb0f4185dc45eda625530bc0fd73"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a46c1fb0f4185dc45eda625530bc0fd73">BANNER</a>&#160;&#160;&#160;&quot;ATA device <a class="el" href="usb__mass_8c.html#ad7b604544aff4d6d8945fcb17e533f5c">driver</a> %s - Copyright (c) 2003 Marcus R. Brown\n&quot;</td></tr>
<tr class="separator:a46c1fb0f4185dc45eda625530bc0fd73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c6d5de492ac61ad29aec7aa9a436bbf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a1c6d5de492ac61ad29aec7aa9a436bbf">VERSION</a>&#160;&#160;&#160;&quot;v1.2&quot;</td></tr>
<tr class="separator:a1c6d5de492ac61ad29aec7aa9a436bbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0501ebf99d49abd4da7c617069a3d0d3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a0501ebf99d49abd4da7c617069a3d0d3">ATA_XFER_MODE_PIO</a>&#160;&#160;&#160;0x08</td></tr>
<tr class="separator:a0501ebf99d49abd4da7c617069a3d0d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14fe84248abb890fc60fe8f15a1b4a81"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a14fe84248abb890fc60fe8f15a1b4a81">ATA_XFER_MODE_UDMA</a>&#160;&#160;&#160;0x40</td></tr>
<tr class="separator:a14fe84248abb890fc60fe8f15a1b4a81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50452dedf60a5212bb1fdc34d7bed0c5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a50452dedf60a5212bb1fdc34d7bed0c5">ATA_EV_TIMEOUT</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a50452dedf60a5212bb1fdc34d7bed0c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95a26f0483406276dbed0c5773f71428"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a95a26f0483406276dbed0c5773f71428">ATA_EV_COMPLETE</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a95a26f0483406276dbed0c5773f71428"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0867c52fd38c6b77b455373854673459"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a0867c52fd38c6b77b455373854673459">ATA_CMD_TABLE_SIZE</a>&#160;&#160;&#160;(sizeof <a class="el" href="hdproatad_8c.html#abb55a24e7d572d1e58cc40e65b3e52d4">ata_cmd_table</a>/sizeof(<a class="el" href="structata__cmd__info__t.html">ata_cmd_info_t</a>))</td></tr>
<tr class="separator:a0867c52fd38c6b77b455373854673459"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82ab2311a481a6d46e499c10cc138d4d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a82ab2311a481a6d46e499c10cc138d4d">SEC_CTRL_CMD_TABLE_SIZE</a>&#160;&#160;&#160;(sizeof <a class="el" href="ps2atad_8c.html#ab4616ef4238e77ee363c63d8a5f101e2">sec_ctrl_cmd_table</a>/sizeof(<a class="el" href="structata__cmd__info__t.html">ata_cmd_info_t</a>))</td></tr>
<tr class="separator:a82ab2311a481a6d46e499c10cc138d4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd3c64565836f2654180caa8d14a3bea"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#acd3c64565836f2654180caa8d14a3bea">SMART_CMD_TABLE_SIZE</a>&#160;&#160;&#160;(sizeof <a class="el" href="hdproatad_8c.html#a931f820c13618c3af525915a18fd755c">smart_cmd_table</a>/sizeof(<a class="el" href="structata__cmd__info__t.html">ata_cmd_info_t</a>))</td></tr>
<tr class="separator:acd3c64565836f2654180caa8d14a3bea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06baa2c49e3e5508abca470f9db8baa9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a06baa2c49e3e5508abca470f9db8baa9">ATA_WAIT_BUSY</a>&#160;&#160;&#160;0x80</td></tr>
<tr class="separator:a06baa2c49e3e5508abca470f9db8baa9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63118a523505472fa95cd2696e297406"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a63118a523505472fa95cd2696e297406">ATA_WAIT_BUSBUSY</a>&#160;&#160;&#160;0x88</td></tr>
<tr class="separator:a63118a523505472fa95cd2696e297406"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9d4860c58b04a2ac5d3f1f003e5a8e7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#ac9d4860c58b04a2ac5d3f1f003e5a8e7">ata_wait_busy</a>()&#160;&#160;&#160;<a class="el" href="hdproatad_8c.html#a886021ff3904acdbf64a88befd93330a">gen_ata_wait_busy</a>(<a class="el" href="hdproatad_8c.html#a06baa2c49e3e5508abca470f9db8baa9">ATA_WAIT_BUSY</a>)</td></tr>
<tr class="separator:ac9d4860c58b04a2ac5d3f1f003e5a8e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47d0aa3b3027856f7af6c5b0496ecc8e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a47d0aa3b3027856f7af6c5b0496ecc8e">ata_wait_bus_busy</a>()&#160;&#160;&#160;<a class="el" href="hdproatad_8c.html#a886021ff3904acdbf64a88befd93330a">gen_ata_wait_busy</a>(<a class="el" href="hdproatad_8c.html#a63118a523505472fa95cd2696e297406">ATA_WAIT_BUSBUSY</a>)</td></tr>
<tr class="separator:a47d0aa3b3027856f7af6c5b0496ecc8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a89c734517935f08827f3e6cdedf3e40a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a89c734517935f08827f3e6cdedf3e40a">IRX_ID</a> (<a class="el" href="usb_2usbmass__bd_2src_2main_8c.html#a0d598793f4b45908f46521f31f108dff">MODNAME</a>, 2, 7)</td></tr>
<tr class="separator:a89c734517935f08827f3e6cdedf3e40a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0b1d184a9a3e735ede5bd8ad5ccdc22"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#af0b1d184a9a3e735ede5bd8ad5ccdc22">ata_intr_cb</a> (int flag)</td></tr>
<tr class="separator:af0b1d184a9a3e735ede5bd8ad5ccdc22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5293599bdaf7e0088900694936606ee"><td class="memItemLeft" align="right" valign="top">static unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#aa5293599bdaf7e0088900694936606ee">ata_alarm_cb</a> (void *unused)</td></tr>
<tr class="separator:aa5293599bdaf7e0088900694936606ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2908a76726fc3566bbdf7a9394d10da4"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a2908a76726fc3566bbdf7a9394d10da4">ata_set_dir</a> (int dir)</td></tr>
<tr class="separator:a2908a76726fc3566bbdf7a9394d10da4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a34bad4a0850d3cf877949bdaf78218"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a9a34bad4a0850d3cf877949bdaf78218">ata_pio_mode</a> (int mode)</td></tr>
<tr class="separator:a9a34bad4a0850d3cf877949bdaf78218"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a077ecda08e27dfa44cadda1e1c8b18b8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a077ecda08e27dfa44cadda1e1c8b18b8">ata_ultra_dma_mode</a> (int mode)</td></tr>
<tr class="separator:a077ecda08e27dfa44cadda1e1c8b18b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae806c1f3b59570cec35c27dbdd9cfe4"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#aae806c1f3b59570cec35c27dbdd9cfe4">ata_shutdown_cb</a> (void)</td></tr>
<tr class="separator:aae806c1f3b59570cec35c27dbdd9cfe4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80f0a9a75a37a8c73bac955b9cd39746"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a80f0a9a75a37a8c73bac955b9cd39746">ata_pre_dma_cb</a> (int bcr, int dir)</td></tr>
<tr class="separator:a80f0a9a75a37a8c73bac955b9cd39746"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a040e68dee95540d676c13ada05a92c2d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a040e68dee95540d676c13ada05a92c2d">ata_post_dma_cb</a> (int bcr, int dir)</td></tr>
<tr class="separator:a040e68dee95540d676c13ada05a92c2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20c53af141ae920d0af8d759fe48c064"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a20c53af141ae920d0af8d759fe48c064">ata_create_event_flag</a> (void)</td></tr>
<tr class="separator:a20c53af141ae920d0af8d759fe48c064"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d259b9f2c7d45f4713e0c483d0fa25b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a7d259b9f2c7d45f4713e0c483d0fa25b">_start</a> (int argc, char *argv[])</td></tr>
<tr class="separator:a7d259b9f2c7d45f4713e0c483d0fa25b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a557e0ee78cacbe4a43a088ada163f8bf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a557e0ee78cacbe4a43a088ada163f8bf">_exit</a> (void)</td></tr>
<tr class="separator:a557e0ee78cacbe4a43a088ada163f8bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd06b5df0dc5102851a9f035b4397725"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#abd06b5df0dc5102851a9f035b4397725">ata_get_error</a> (void)</td></tr>
<tr class="separator:abd06b5df0dc5102851a9f035b4397725"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a886021ff3904acdbf64a88befd93330a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a886021ff3904acdbf64a88befd93330a">gen_ata_wait_busy</a> (int bits)</td></tr>
<tr class="separator:a886021ff3904acdbf64a88befd93330a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa869626ecb5359525c66f68b8fd44f3"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#afa869626ecb5359525c66f68b8fd44f3">ata_device_select</a> (int device)</td></tr>
<tr class="separator:afa869626ecb5359525c66f68b8fd44f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a072b372a9a27da323409e0d693ab92b8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a072b372a9a27da323409e0d693ab92b8">ata_io_start</a> (void *buf, <a class="el" href="tamtypes_8h.html#a2caf5cd7bcdbe1eefa727f44ffb10bac">u32</a> blkcount, <a class="el" href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a> feature, <a class="el" href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a> nsector, <a class="el" href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a> sector, <a class="el" href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a> lcyl, <a class="el" href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a> hcyl, <a class="el" href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a> <a class="el" href="ps2ip_8h.html#a2b406456012f9f74aeb33de6f3df053c">select</a>, <a class="el" href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a> command)</td></tr>
<tr class="separator:a072b372a9a27da323409e0d693ab92b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af91a5f06a7899804bffc4734c8d53e53"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#af91a5f06a7899804bffc4734c8d53e53">ata_pio_transfer</a> (<a class="el" href="structata__cmd__state__t.html">ata_cmd_state_t</a> *cmd_state)</td></tr>
<tr class="separator:af91a5f06a7899804bffc4734c8d53e53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57905ac2753d3af573cda8f88ac0539a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a57905ac2753d3af573cda8f88ac0539a">ata_dma_complete</a> (void *buf, <a class="el" href="tamtypes_8h.html#a2caf5cd7bcdbe1eefa727f44ffb10bac">u32</a> blkcount, int dir)</td></tr>
<tr class="separator:a57905ac2753d3af573cda8f88ac0539a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d648ea6a0eeb70159b54f0cba6602d9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a7d648ea6a0eeb70159b54f0cba6602d9">ata_io_finish</a> (void)</td></tr>
<tr class="separator:a7d648ea6a0eeb70159b54f0cba6602d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bd0b23d7e3ae5bba9abb6e2852d0218"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a6bd0b23d7e3ae5bba9abb6e2852d0218">ata_bus_reset</a> (void)</td></tr>
<tr class="separator:a6bd0b23d7e3ae5bba9abb6e2852d0218"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0d320995c13d10d7e0dfeb2928d8adf"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#ab0d320995c13d10d7e0dfeb2928d8adf">ata_reset_devices</a> (void)</td></tr>
<tr class="separator:ab0d320995c13d10d7e0dfeb2928d8adf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3829b4feb57d04814b802a1fc5b732b5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a3829b4feb57d04814b802a1fc5b732b5">ata_device_flush_cache</a> (int device)</td></tr>
<tr class="separator:a3829b4feb57d04814b802a1fc5b732b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5fe2ce0f6c8ff1c2af5faaac8bc20a9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#ad5fe2ce0f6c8ff1c2af5faaac8bc20a9">ata_device_idle</a> (int device, int period)</td></tr>
<tr class="separator:ad5fe2ce0f6c8ff1c2af5faaac8bc20a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74641792cccc14f3a6c8676374c414cd"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a74641792cccc14f3a6c8676374c414cd">ata_device_identify</a> (int device, void *<a class="el" href="structinfo.html">info</a>)</td></tr>
<tr class="separator:a74641792cccc14f3a6c8676374c414cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b3ec1d0aeda2b32dc5dd7635cecf77b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a5b3ec1d0aeda2b32dc5dd7635cecf77b">ata_device_pkt_identify</a> (int device, void *<a class="el" href="structinfo.html">info</a>)</td></tr>
<tr class="separator:a5b3ec1d0aeda2b32dc5dd7635cecf77b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa14172e73d2398ff898353839aef7d21"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#aa14172e73d2398ff898353839aef7d21">ata_device_sce_identify_drive</a> (int device, void *data)</td></tr>
<tr class="separator:aa14172e73d2398ff898353839aef7d21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11c2db58d257d48f25a26a963e8bc698"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a11c2db58d257d48f25a26a963e8bc698">ata_device_smart_enable</a> (int device)</td></tr>
<tr class="separator:a11c2db58d257d48f25a26a963e8bc698"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d4aae34d39b741895c17cace6f05b3e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a3d4aae34d39b741895c17cace6f05b3e">ata_device_smart_save_attr</a> (int device)</td></tr>
<tr class="separator:a3d4aae34d39b741895c17cace6f05b3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22e8d778ec05b07d112e1a1256bc421a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a22e8d778ec05b07d112e1a1256bc421a">ata_device_smart_get_status</a> (int device)</td></tr>
<tr class="separator:a22e8d778ec05b07d112e1a1256bc421a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1834dc226e9b1f884dc42d1a51dc6fc1"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a1834dc226e9b1f884dc42d1a51dc6fc1">ata_device_set_transfer_mode</a> (int device, int type, int mode)</td></tr>
<tr class="separator:a1834dc226e9b1f884dc42d1a51dc6fc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e81d9acd6155b847e9f228c0e0a1df8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a8e81d9acd6155b847e9f228c0e0a1df8">ata_device_sector_io</a> (int device, void *buf, <a class="el" href="tamtypes_8h.html#a2caf5cd7bcdbe1eefa727f44ffb10bac">u32</a> lba, <a class="el" href="tamtypes_8h.html#a2caf5cd7bcdbe1eefa727f44ffb10bac">u32</a> nsectors, int dir)</td></tr>
<tr class="separator:a8e81d9acd6155b847e9f228c0e0a1df8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a048c448fc8c924064d004dc320230780"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a048c448fc8c924064d004dc320230780">ata_get_security_status</a> (int device, <a class="el" href="structata__devinfo__t.html">ata_devinfo_t</a> *devinfo, <a class="el" href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a> *param)</td></tr>
<tr class="separator:a048c448fc8c924064d004dc320230780"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd72dceef811b7b8b5a209c9f570e2d8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#acd72dceef811b7b8b5a209c9f570e2d8">ata_device_sce_sec_set_password</a> (int device, void *password)</td></tr>
<tr class="separator:acd72dceef811b7b8b5a209c9f570e2d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bad5776d75e69c005ffa7dadd50d550"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a8bad5776d75e69c005ffa7dadd50d550">ata_device_sce_sec_unlock</a> (int device, void *password)</td></tr>
<tr class="separator:a8bad5776d75e69c005ffa7dadd50d550"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a971e6935f9ebcbe8178ada833665d56e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a971e6935f9ebcbe8178ada833665d56e">ata_device_sce_sec_erase</a> (int device)</td></tr>
<tr class="separator:a971e6935f9ebcbe8178ada833665d56e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7219d59eb0dda86631c77e5b13eee187"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a7219d59eb0dda86631c77e5b13eee187">ata_device_probe</a> (<a class="el" href="structata__devinfo__t.html">ata_devinfo_t</a> *devinfo)</td></tr>
<tr class="separator:a7219d59eb0dda86631c77e5b13eee187"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a2d7a85814d91e05d924243b95bb68a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a4a2d7a85814d91e05d924243b95bb68a">ata_init_devices</a> (<a class="el" href="structata__devinfo__t.html">ata_devinfo_t</a> *devinfo)</td></tr>
<tr class="separator:a4a2d7a85814d91e05d924243b95bb68a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f939bc4c7eb60ded290e298dea8a835"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structata__devinfo__t.html">ata_devinfo_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a2f939bc4c7eb60ded290e298dea8a835">ata_get_devinfo</a> (int device)</td></tr>
<tr class="separator:a2f939bc4c7eb60ded290e298dea8a835"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5802aa7f4eea2a97d250d6241defa966"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a5802aa7f4eea2a97d250d6241defa966">ata_device_idle_immediate</a> (int device)</td></tr>
<tr class="separator:a5802aa7f4eea2a97d250d6241defa966"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2858d85ffb9fcd6a6e30d268d134fe3c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a2858d85ffb9fcd6a6e30d268d134fe3c">ata_device_standby_immediate</a> (int device)</td></tr>
<tr class="separator:a2858d85ffb9fcd6a6e30d268d134fe3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a36d5160a12b758a05b46552665fa0420"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a36d5160a12b758a05b46552665fa0420">ata_devinfo_init</a> = 0</td></tr>
<tr class="separator:a36d5160a12b758a05b46552665fa0420"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a63343d9b3948674c9b63eb02a2848580"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a63343d9b3948674c9b63eb02a2848580">ata_evflg</a> = -1</td></tr>
<tr class="separator:a63343d9b3948674c9b63eb02a2848580"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd506af8f0da0f60a2b367a78964b8b2"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="tamtypes_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#acd506af8f0da0f60a2b367a78964b8b2">ata_disable_lba48</a> = 0</td></tr>
<tr class="separator:acd506af8f0da0f60a2b367a78964b8b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2dd933f6c797949159ee6ab90e86f53"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structata__devinfo__t.html">ata_devinfo_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#ac2dd933f6c797949159ee6ab90e86f53">atad_devinfo</a> [2]</td></tr>
<tr class="separator:ac2dd933f6c797949159ee6ab90e86f53"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7e4a242bab16217e288f17efa109daf"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#ad7e4a242bab16217e288f17efa109daf">ata_param</a> [256]</td></tr>
<tr class="separator:ad7e4a242bab16217e288f17efa109daf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb55a24e7d572d1e58cc40e65b3e52d4"><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="structata__cmd__info__t.html">ata_cmd_info_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#abb55a24e7d572d1e58cc40e65b3e52d4">ata_cmd_table</a> []</td></tr>
<tr class="separator:abb55a24e7d572d1e58cc40e65b3e52d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4616ef4238e77ee363c63d8a5f101e2"><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="structata__cmd__info__t.html">ata_cmd_info_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#ab4616ef4238e77ee363c63d8a5f101e2">sec_ctrl_cmd_table</a> []</td></tr>
<tr class="separator:ab4616ef4238e77ee363c63d8a5f101e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a931f820c13618c3af525915a18fd755c"><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="structata__cmd__info__t.html">ata_cmd_info_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a931f820c13618c3af525915a18fd755c">smart_cmd_table</a> []</td></tr>
<tr class="separator:a931f820c13618c3af525915a18fd755c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4150d69c3e790e1f2996abf107cb3eb5"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="structata__cmd__state__t.html">ata_cmd_state_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a4150d69c3e790e1f2996abf107cb3eb5">atad_cmd_state</a></td></tr>
<tr class="separator:a4150d69c3e790e1f2996abf107cb3eb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d3162693508354859edc5d7623dc6ee"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structirx__export__table.html">irx_export_table</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ps2atad_8c.html#a6d3162693508354859edc5d7623dc6ee">_exp_atad</a></td></tr>
<tr class="separator:a6d3162693508354859edc5d7623dc6ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>ATA device driver. This module provides the low-level ATA support for hard disk drives, based on ATAD v2.7. It is 100% compatible with its proprietary counterpart called atad.irx.</p>
<p>This module also include support for 48-bit feature set (done by Clement). To avoid causing an "emergency park" for some HDDs, shutdown callback 15 of dev9 is used for issuing the STANDBY IMMEDIATE command prior to DEV9 getting shut down. </p>

<p class="definition">Definition in file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a0867c52fd38c6b77b455373854673459"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0867c52fd38c6b77b455373854673459">&#9670;&nbsp;</a></span>ATA_CMD_TABLE_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATA_CMD_TABLE_SIZE&#160;&#160;&#160;(sizeof <a class="el" href="hdproatad_8c.html#abb55a24e7d572d1e58cc40e65b3e52d4">ata_cmd_table</a>/sizeof(<a class="el" href="structata__cmd__info__t.html">ata_cmd_info_t</a>))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00128">128</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>

</div>
</div>
<a id="a95a26f0483406276dbed0c5773f71428"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95a26f0483406276dbed0c5773f71428">&#9670;&nbsp;</a></span>ATA_EV_COMPLETE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATA_EV_COMPLETE&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00052">52</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>

</div>
</div>
<a id="a50452dedf60a5212bb1fdc34d7bed0c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50452dedf60a5212bb1fdc34d7bed0c5">&#9670;&nbsp;</a></span>ATA_EV_TIMEOUT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATA_EV_TIMEOUT&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00051">51</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>

</div>
</div>
<a id="a47d0aa3b3027856f7af6c5b0496ecc8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a47d0aa3b3027856f7af6c5b0496ecc8e">&#9670;&nbsp;</a></span>ata_wait_bus_busy</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ata_wait_bus_busy</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="hdproatad_8c.html#a886021ff3904acdbf64a88befd93330a">gen_ata_wait_busy</a>(<a class="el" href="hdproatad_8c.html#a63118a523505472fa95cd2696e297406">ATA_WAIT_BUSBUSY</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00307">307</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>

</div>
</div>
<a id="a63118a523505472fa95cd2696e297406"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63118a523505472fa95cd2696e297406">&#9670;&nbsp;</a></span>ATA_WAIT_BUSBUSY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATA_WAIT_BUSBUSY&#160;&#160;&#160;0x88</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00304">304</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>

</div>
</div>
<a id="a06baa2c49e3e5508abca470f9db8baa9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06baa2c49e3e5508abca470f9db8baa9">&#9670;&nbsp;</a></span>ATA_WAIT_BUSY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATA_WAIT_BUSY&#160;&#160;&#160;0x80</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00303">303</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>

</div>
</div>
<a id="ac9d4860c58b04a2ac5d3f1f003e5a8e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9d4860c58b04a2ac5d3f1f003e5a8e7">&#9670;&nbsp;</a></span>ata_wait_busy</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ata_wait_busy</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="hdproatad_8c.html#a886021ff3904acdbf64a88befd93330a">gen_ata_wait_busy</a>(<a class="el" href="hdproatad_8c.html#a06baa2c49e3e5508abca470f9db8baa9">ATA_WAIT_BUSY</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00306">306</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>

</div>
</div>
<a id="a0501ebf99d49abd4da7c617069a3d0d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0501ebf99d49abd4da7c617069a3d0d3">&#9670;&nbsp;</a></span>ATA_XFER_MODE_PIO</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATA_XFER_MODE_PIO&#160;&#160;&#160;0x08</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00045">45</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>

</div>
</div>
<a id="a14fe84248abb890fc60fe8f15a1b4a81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14fe84248abb890fc60fe8f15a1b4a81">&#9670;&nbsp;</a></span>ATA_XFER_MODE_UDMA</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ATA_XFER_MODE_UDMA&#160;&#160;&#160;0x40</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00049">49</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>

</div>
</div>
<a id="a46c1fb0f4185dc45eda625530bc0fd73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46c1fb0f4185dc45eda625530bc0fd73">&#9670;&nbsp;</a></span>BANNER</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define BANNER&#160;&#160;&#160;&quot;ATA device <a class="el" href="usb__mass_8c.html#ad7b604544aff4d6d8945fcb17e533f5c">driver</a> %s - Copyright (c) 2003 Marcus R. Brown\n&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00042">42</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>

</div>
</div>
<a id="a1250382de8ce63fd75727fe97bbb8187"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1250382de8ce63fd75727fe97bbb8187">&#9670;&nbsp;</a></span>M_PRINTF</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define M_PRINTF</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="iomanX_8c.html#a7454b3cf0ebfcba54720071dbd0d8d20">format</a>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">args...&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;	<a class="el" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<a class="el" href="usb_2usbmass__bd_2src_2main_8c.html#a0d598793f4b45908f46521f31f108dff">MODNAME</a> &quot;: &quot; <a class="el" href="iomanX_8c.html#a7454b3cf0ebfcba54720071dbd0d8d20">format</a>, ## args)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00039">39</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>

</div>
</div>
<a id="a0d598793f4b45908f46521f31f108dff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d598793f4b45908f46521f31f108dff">&#9670;&nbsp;</a></span>MODNAME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MODNAME&#160;&#160;&#160;&quot;atad&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00036">36</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>

</div>
</div>
<a id="a82ab2311a481a6d46e499c10cc138d4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82ab2311a481a6d46e499c10cc138d4d">&#9670;&nbsp;</a></span>SEC_CTRL_CMD_TABLE_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SEC_CTRL_CMD_TABLE_SIZE&#160;&#160;&#160;(sizeof <a class="el" href="ps2atad_8c.html#ab4616ef4238e77ee363c63d8a5f101e2">sec_ctrl_cmd_table</a>/sizeof(<a class="el" href="structata__cmd__info__t.html">ata_cmd_info_t</a>))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00140">140</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>

</div>
</div>
<a id="acd3c64565836f2654180caa8d14a3bea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd3c64565836f2654180caa8d14a3bea">&#9670;&nbsp;</a></span>SMART_CMD_TABLE_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SMART_CMD_TABLE_SIZE&#160;&#160;&#160;(sizeof <a class="el" href="hdproatad_8c.html#a931f820c13618c3af525915a18fd755c">smart_cmd_table</a>/sizeof(<a class="el" href="structata__cmd__info__t.html">ata_cmd_info_t</a>))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00153">153</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>

</div>
</div>
<a id="a1c6d5de492ac61ad29aec7aa9a436bbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c6d5de492ac61ad29aec7aa9a436bbf">&#9670;&nbsp;</a></span>VERSION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VERSION&#160;&#160;&#160;&quot;v1.2&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00043">43</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a557e0ee78cacbe4a43a088ada163f8bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a557e0ee78cacbe4a43a088ada163f8bf">&#9670;&nbsp;</a></span>_exit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int _exit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00276">276</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;{ <span class="keywordflow">return</span> 0; }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="dir_8c_source.html#l00028">pfsGetDentry()</a>.</p>

</div>
</div>
<a id="a7d259b9f2c7d45f4713e0c483d0fa25b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d259b9f2c7d45f4713e0c483d0fa25b">&#9670;&nbsp;</a></span>_start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int _start </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00207">207</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;{</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <a class="code" href="speedregs_8h.html#ae17edfe9beb1af5c9a18069f5346c1b5">USE_SPD_REGS</a>;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="keywordtype">int</span> res = 1;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<a class="code" href="ps2atad_8c.html#a46c1fb0f4185dc45eda625530bc0fd73">BANNER</a>, <a class="code" href="ps2atad_8c.html#a1c6d5de492ac61ad29aec7aa9a436bbf">VERSION</a>);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="keywordflow">if</span> (!(<a class="code" href="speedregs_8h.html#a0de0649a772d3a30be4b67b3d222d246">SPD_REG16</a>(<a class="code" href="speedregs_8h.html#a85eb9bfd973914dd8b7ab0f1bbc476ff">SPD_R_REV_3</a>) &amp; <a class="code" href="speedregs_8h.html#afdb70bb3a0325f45d64e02c044bdb454">SPD_CAPS_ATA</a>) || !(<a class="code" href="speedregs_8h.html#a0de0649a772d3a30be4b67b3d222d246">SPD_REG16</a>(<a class="code" href="speedregs_8h.html#a4bc28405fc23722ae482b394dda4ae0a">SPD_R_REV_8</a>) &amp; 0x02)) {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                <a class="code" href="ps2atad_8c.html#a1250382de8ce63fd75727fe97bbb8187">M_PRINTF</a>(<span class="stringliteral">&quot;HDD is not connected, exiting.\n&quot;</span>);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        }</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="comment">/*      The PSX (Not the PlayStation or PSOne, but a PS2 with a DVR unit) has got an extra processor (Fujitsu MB91302A, aka the &quot;DVRP&quot;) that seems to be emulating the console&#39;s PS2 ATA interface.</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">                The stock disks of all PSX units are definitely 48-bit LBA compliant because of their capacities, but the DVRP&#39;s emulation seems to have a design problem:</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">                        1. It indicates that 48-bit LBA is supported.</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">                        2. The 48-bit LBA capacity fields show the true capacity of the disk.</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">                        3. Accesses to beyond the 28-bit LBA capacity (Which is 40.000GB by default) will result in I/O errors.</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">                        4. (For some PSX units like the DESR-7500): Double-writes to the ATA registers seem to cause the ATA interface to stall.</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">                The problem is obviously in the DVRP&#39;s firmware, but we currently have no way to fix these bugs because the DVRP is even more heavily secured that the IOP.</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">                In the eyes of Sony, there isn&#39;t a problem because none of their retail PlayStation 2 software ever supported 48-bit LBA.</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">                The obvious workaround here would be to disable 48-bit LBA support when ATAD is loaded on a PSX. */</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <a class="code" href="ps2atad_8c.html#acd506af8f0da0f60a2b367a78964b8b2">ata_disable_lba48</a> = (<a class="code" href="speedregs_8h.html#a0de0649a772d3a30be4b67b3d222d246">SPD_REG16</a>(<a class="code" href="speedregs_8h.html#a85eb9bfd973914dd8b7ab0f1bbc476ff">SPD_R_REV_3</a>) &amp; <a class="code" href="speedregs_8h.html#a39512fc7ea6ee17f6f08c3c38b05c122">SPD_CAPS_DVR</a>)?1:0;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="preprocessor">#ifdef ATA_GAMESTAR_WORKAROUND</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="comment">/*      Some compatible adaptors may malfunction if transfers are not done according to the old ps2atad design.</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">                Official adaptors appear to have a 0x0001 set for this register, but not compatibles.</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">                While official I/O to this register are 8-bit, some compatibles have a 0x01 for the lower 8-bits,</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">                but the upper 8-bits contain some random value. Hence perform a 16-bit read instead. */</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="speedregs_8h.html#a0de0649a772d3a30be4b67b3d222d246">SPD_REG16</a>(0x20) != 1) {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                ata_gamestar_workaround = 1;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                <a class="code" href="ps2atad_8c.html#a1250382de8ce63fd75727fe97bbb8187">M_PRINTF</a>(<span class="stringliteral">&quot;Compatible adaptor detected.\n&quot;</span>);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                ata_gamestar_workaround = 0;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        }   </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordflow">if</span> ((<a class="code" href="ps2atad_8c.html#a63343d9b3948674c9b63eb02a2848580">ata_evflg</a> = <a class="code" href="ps2atad_8c.html#a20c53af141ae920d0af8d759fe48c064">ata_create_event_flag</a>()) &lt; 0) {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                <a class="code" href="ps2atad_8c.html#a1250382de8ce63fd75727fe97bbb8187">M_PRINTF</a>(<span class="stringliteral">&quot;Couldn&#39;t create event flag, exiting.\n&quot;</span>);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                res = 1;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="comment">/* In v1.04, PIO mode 0 was set here. In late versions, it is set in ata_init_devices(). */</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <a class="code" href="dev9_8h.html#aafb38537091e12c9e19472229bb30e6b">dev9RegisterIntrCb</a>(1, &amp;<a class="code" href="ps2atad_8c.html#af0b1d184a9a3e735ede5bd8ad5ccdc22">ata_intr_cb</a>);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <a class="code" href="dev9_8h.html#aafb38537091e12c9e19472229bb30e6b">dev9RegisterIntrCb</a>(0, &amp;<a class="code" href="ps2atad_8c.html#af0b1d184a9a3e735ede5bd8ad5ccdc22">ata_intr_cb</a>);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="preprocessor">#ifdef ATA_GAMESTAR_WORKAROUND</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keywordflow">if</span> (!ata_gamestar_workaround) {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <a class="code" href="dev9_8h.html#a85656c50e656946497d2b7f52510d4e0">dev9RegisterPreDmaCb</a>(0, &amp;<a class="code" href="ps2atad_8c.html#a80f0a9a75a37a8c73bac955b9cd39746">ata_pre_dma_cb</a>);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <a class="code" href="dev9_8h.html#a7b00533bdd49c9f7370573734bd043f7">dev9RegisterPostDmaCb</a>(0, &amp;<a class="code" href="ps2atad_8c.html#a040e68dee95540d676c13ada05a92c2d">ata_post_dma_cb</a>);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="preprocessor">#ifdef ATA_GAMESTAR_WORKAROUND</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="comment">/* Register this at the last position, as it should be the last thing done before shutdown. */</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <a class="code" href="dev9_8h.html#aa40a34bc51c8ca21b3ed48ab986a6af4">dev9RegisterShutdownCb</a>(15, &amp;<a class="code" href="ps2atad_8c.html#aae806c1f3b59570cec35c27dbdd9cfe4">ata_shutdown_cb</a>);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordflow">if</span> ((res = <a class="code" href="loadcore_8h.html#a2c521e294f194478fc1c99edc42be38c">RegisterLibraryEntries</a>(&amp;<a class="code" href="ps2atad_8c.html#a6d3162693508354859edc5d7623dc6ee">_exp_atad</a>)) != 0) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                <a class="code" href="ps2atad_8c.html#a1250382de8ce63fd75727fe97bbb8187">M_PRINTF</a>(<span class="stringliteral">&quot;Library is already registered, exiting.\n&quot;</span>);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                <span class="keywordflow">goto</span> out;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        res = 0;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <a class="code" href="ps2atad_8c.html#a1250382de8ce63fd75727fe97bbb8187">M_PRINTF</a>(<span class="stringliteral">&quot;Driver loaded.\n&quot;</span>);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;out:</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;}</div>
<div class="ttc" id="adev9_8h_html_a7b00533bdd49c9f7370573734bd043f7"><div class="ttname"><a href="dev9_8h.html#a7b00533bdd49c9f7370573734bd043f7">dev9RegisterPostDmaCb</a></div><div class="ttdeci">void dev9RegisterPostDmaCb(int ctrl, dev9_dma_cb_t cb)</div><div class="ttdef"><b>Definition:</b> <a href="ps2dev9_8c_source.html#l00258">ps2dev9.c:258</a></div></div>
<div class="ttc" id="adev9_8h_html_a85656c50e656946497d2b7f52510d4e0"><div class="ttname"><a href="dev9_8h.html#a85656c50e656946497d2b7f52510d4e0">dev9RegisterPreDmaCb</a></div><div class="ttdeci">void dev9RegisterPreDmaCb(int ctrl, dev9_dma_cb_t cb)</div><div class="ttdef"><b>Definition:</b> <a href="ps2dev9_8c_source.html#l00253">ps2dev9.c:253</a></div></div>
<div class="ttc" id="adev9_8h_html_aa40a34bc51c8ca21b3ed48ab986a6af4"><div class="ttname"><a href="dev9_8h.html#aa40a34bc51c8ca21b3ed48ab986a6af4">dev9RegisterShutdownCb</a></div><div class="ttdeci">int dev9RegisterShutdownCb(int idx, dev9_shutdown_cb_t cb)</div><div class="ttdef"><b>Definition:</b> <a href="ps2dev9_8c_source.html#l00550">ps2dev9.c:550</a></div></div>
<div class="ttc" id="adev9_8h_html_aafb38537091e12c9e19472229bb30e6b"><div class="ttname"><a href="dev9_8h.html#aafb38537091e12c9e19472229bb30e6b">dev9RegisterIntrCb</a></div><div class="ttdeci">void dev9RegisterIntrCb(int intr, dev9_intr_cb_t cb)</div><div class="ttdef"><b>Definition:</b> <a href="ps2dev9_8c_source.html#l00247">ps2dev9.c:247</a></div></div>
<div class="ttc" id="aloadcore_8h_html_a2c521e294f194478fc1c99edc42be38c"><div class="ttname"><a href="loadcore_8h.html#a2c521e294f194478fc1c99edc42be38c">RegisterLibraryEntries</a></div><div class="ttdeci">int RegisterLibraryEntries(struct irx_export_table *exports)</div></div>
<div class="ttc" id="aps2atad_8c_html_a040e68dee95540d676c13ada05a92c2d"><div class="ttname"><a href="ps2atad_8c.html#a040e68dee95540d676c13ada05a92c2d">ata_post_dma_cb</a></div><div class="ttdeci">static void ata_post_dma_cb(int bcr, int dir)</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00191">ps2atad.c:191</a></div></div>
<div class="ttc" id="aps2atad_8c_html_a1250382de8ce63fd75727fe97bbb8187"><div class="ttname"><a href="ps2atad_8c.html#a1250382de8ce63fd75727fe97bbb8187">M_PRINTF</a></div><div class="ttdeci">#define M_PRINTF(format, args...)</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00039">ps2atad.c:39</a></div></div>
<div class="ttc" id="aps2atad_8c_html_a1c6d5de492ac61ad29aec7aa9a436bbf"><div class="ttname"><a href="ps2atad_8c.html#a1c6d5de492ac61ad29aec7aa9a436bbf">VERSION</a></div><div class="ttdeci">#define VERSION</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00043">ps2atad.c:43</a></div></div>
<div class="ttc" id="aps2atad_8c_html_a20c53af141ae920d0af8d759fe48c064"><div class="ttname"><a href="ps2atad_8c.html#a20c53af141ae920d0af8d759fe48c064">ata_create_event_flag</a></div><div class="ttdeci">static int ata_create_event_flag(void)</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00198">ps2atad.c:198</a></div></div>
<div class="ttc" id="aps2atad_8c_html_a46c1fb0f4185dc45eda625530bc0fd73"><div class="ttname"><a href="ps2atad_8c.html#a46c1fb0f4185dc45eda625530bc0fd73">BANNER</a></div><div class="ttdeci">#define BANNER</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00042">ps2atad.c:42</a></div></div>
<div class="ttc" id="aps2atad_8c_html_a63343d9b3948674c9b63eb02a2848580"><div class="ttname"><a href="ps2atad_8c.html#a63343d9b3948674c9b63eb02a2848580">ata_evflg</a></div><div class="ttdeci">static int ata_evflg</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00055">ps2atad.c:55</a></div></div>
<div class="ttc" id="aps2atad_8c_html_a6d3162693508354859edc5d7623dc6ee"><div class="ttname"><a href="ps2atad_8c.html#a6d3162693508354859edc5d7623dc6ee">_exp_atad</a></div><div class="ttdeci">struct irx_export_table _exp_atad</div></div>
<div class="ttc" id="aps2atad_8c_html_a80f0a9a75a37a8c73bac955b9cd39746"><div class="ttname"><a href="ps2atad_8c.html#a80f0a9a75a37a8c73bac955b9cd39746">ata_pre_dma_cb</a></div><div class="ttdeci">static void ata_pre_dma_cb(int bcr, int dir)</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00184">ps2atad.c:184</a></div></div>
<div class="ttc" id="aps2atad_8c_html_aae806c1f3b59570cec35c27dbdd9cfe4"><div class="ttname"><a href="ps2atad_8c.html#aae806c1f3b59570cec35c27dbdd9cfe4">ata_shutdown_cb</a></div><div class="ttdeci">static void ata_shutdown_cb(void)</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l01204">ps2atad.c:1204</a></div></div>
<div class="ttc" id="aps2atad_8c_html_acd506af8f0da0f60a2b367a78964b8b2"><div class="ttname"><a href="ps2atad_8c.html#acd506af8f0da0f60a2b367a78964b8b2">ata_disable_lba48</a></div><div class="ttdeci">static u8 ata_disable_lba48</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00058">ps2atad.c:58</a></div></div>
<div class="ttc" id="aps2atad_8c_html_af0b1d184a9a3e735ede5bd8ad5ccdc22"><div class="ttname"><a href="ps2atad_8c.html#af0b1d184a9a3e735ede5bd8ad5ccdc22">ata_intr_cb</a></div><div class="ttdeci">static int ata_intr_cb(int flag)</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00278">ps2atad.c:278</a></div></div>
<div class="ttc" id="aspeedregs_8h_html_a0de0649a772d3a30be4b67b3d222d246"><div class="ttname"><a href="speedregs_8h.html#a0de0649a772d3a30be4b67b3d222d246">SPD_REG16</a></div><div class="ttdeci">#define SPD_REG16(offset)</div><div class="ttdef"><b>Definition:</b> <a href="speedregs_8h_source.html#l00030">speedregs.h:30</a></div></div>
<div class="ttc" id="aspeedregs_8h_html_a39512fc7ea6ee17f6f08c3c38b05c122"><div class="ttname"><a href="speedregs_8h.html#a39512fc7ea6ee17f6f08c3c38b05c122">SPD_CAPS_DVR</a></div><div class="ttdeci">#define SPD_CAPS_DVR</div><div class="ttdef"><b>Definition:</b> <a href="speedregs_8h_source.html#l00039">speedregs.h:39</a></div></div>
<div class="ttc" id="aspeedregs_8h_html_a4bc28405fc23722ae482b394dda4ae0a"><div class="ttname"><a href="speedregs_8h.html#a4bc28405fc23722ae482b394dda4ae0a">SPD_R_REV_8</a></div><div class="ttdeci">#define SPD_R_REV_8</div><div class="ttdef"><b>Definition:</b> <a href="speedregs_8h_source.html#l00041">speedregs.h:41</a></div></div>
<div class="ttc" id="aspeedregs_8h_html_a85eb9bfd973914dd8b7ab0f1bbc476ff"><div class="ttname"><a href="speedregs_8h.html#a85eb9bfd973914dd8b7ab0f1bbc476ff">SPD_R_REV_3</a></div><div class="ttdeci">#define SPD_R_REV_3</div><div class="ttdef"><b>Definition:</b> <a href="speedregs_8h_source.html#l00035">speedregs.h:35</a></div></div>
<div class="ttc" id="aspeedregs_8h_html_ae17edfe9beb1af5c9a18069f5346c1b5"><div class="ttname"><a href="speedregs_8h.html#ae17edfe9beb1af5c9a18069f5346c1b5">USE_SPD_REGS</a></div><div class="ttdeci">#define USE_SPD_REGS</div><div class="ttdef"><b>Definition:</b> <a href="speedregs_8h_source.html#l00027">speedregs.h:27</a></div></div>
<div class="ttc" id="aspeedregs_8h_html_afdb70bb3a0325f45d64e02c044bdb454"><div class="ttname"><a href="speedregs_8h.html#afdb70bb3a0325f45d64e02c044bdb454">SPD_CAPS_ATA</a></div><div class="ttdeci">#define SPD_CAPS_ATA</div><div class="ttdef"><b>Definition:</b> <a href="speedregs_8h_source.html#l00037">speedregs.h:37</a></div></div>
<div class="ttc" id="astdio_8h_html_a98631211a4a8aee62f572375d5b637be"><div class="ttname"><a href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a></div><div class="ttdeci">int printf(const char *format,...)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ps2atad_8c.html#a6d3162693508354859edc5d7623dc6ee">_exp_atad</a>, <a class="el" href="ps2atad_8c_source.html#l00198">ata_create_event_flag()</a>, <a class="el" href="ps2atad_8c_source.html#l00058">ata_disable_lba48</a>, <a class="el" href="ps2atad_8c_source.html#l00055">ata_evflg</a>, <a class="el" href="ps2atad_8c_source.html#l00278">ata_intr_cb()</a>, <a class="el" href="ps2atad_8c_source.html#l00191">ata_post_dma_cb()</a>, <a class="el" href="ps2atad_8c_source.html#l00184">ata_pre_dma_cb()</a>, <a class="el" href="ps2atad_8c_source.html#l01204">ata_shutdown_cb()</a>, <a class="el" href="ps2atad_8c_source.html#l00042">BANNER</a>, <a class="el" href="ps2dev9_8c_source.html#l00247">dev9RegisterIntrCb()</a>, <a class="el" href="ps2dev9_8c_source.html#l00258">dev9RegisterPostDmaCb()</a>, <a class="el" href="ps2dev9_8c_source.html#l00253">dev9RegisterPreDmaCb()</a>, <a class="el" href="ps2dev9_8c_source.html#l00550">dev9RegisterShutdownCb()</a>, <a class="el" href="ps2atad_8c_source.html#l00039">M_PRINTF</a>, <a class="el" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf()</a>, <a class="el" href="loadcore_8h.html#a2c521e294f194478fc1c99edc42be38c">RegisterLibraryEntries()</a>, <a class="el" href="speedregs_8h_source.html#l00037">SPD_CAPS_ATA</a>, <a class="el" href="speedregs_8h_source.html#l00039">SPD_CAPS_DVR</a>, <a class="el" href="speedregs_8h_source.html#l00035">SPD_R_REV_3</a>, <a class="el" href="speedregs_8h_source.html#l00041">SPD_R_REV_8</a>, <a class="el" href="speedregs_8h_source.html#l00030">SPD_REG16</a>, <a class="el" href="speedregs_8h_source.html#l00027">USE_SPD_REGS</a>, and <a class="el" href="ps2atad_8c_source.html#l00043">VERSION</a>.</p>

</div>
</div>
<a id="aa5293599bdaf7e0088900694936606ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5293599bdaf7e0088900694936606ee">&#9670;&nbsp;</a></span>ata_alarm_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static unsigned int ata_alarm_cb </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>unused</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00290">290</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;{</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        <a class="code" href="thevent_8h.html#afe53563813c02526e55496e4153441a8">iSetEventFlag</a>(<a class="code" href="ps2atad_8c.html#a63343d9b3948674c9b63eb02a2848580">ata_evflg</a>, <a class="code" href="ps2atad_8c.html#a50452dedf60a5212bb1fdc34d7bed0c5">ATA_EV_TIMEOUT</a>);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;}</div>
<div class="ttc" id="aps2atad_8c_html_a50452dedf60a5212bb1fdc34d7bed0c5"><div class="ttname"><a href="ps2atad_8c.html#a50452dedf60a5212bb1fdc34d7bed0c5">ATA_EV_TIMEOUT</a></div><div class="ttdeci">#define ATA_EV_TIMEOUT</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00051">ps2atad.c:51</a></div></div>
<div class="ttc" id="athevent_8h_html_afe53563813c02526e55496e4153441a8"><div class="ttname"><a href="thevent_8h.html#afe53563813c02526e55496e4153441a8">iSetEventFlag</a></div><div class="ttdeci">int iSetEventFlag(int ef, u32 bits)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ps2atad_8c_source.html#l00051">ATA_EV_TIMEOUT</a>, <a class="el" href="ps2atad_8c_source.html#l00055">ata_evflg</a>, and <a class="el" href="thevent_8h.html#afe53563813c02526e55496e4153441a8">iSetEventFlag()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00597">ata_io_finish()</a>, and <a class="el" href="ps2atad_8c_source.html#l00377">ata_io_start()</a>.</p>

</div>
</div>
<a id="a6bd0b23d7e3ae5bba9abb6e2852d0218"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bd0b23d7e3ae5bba9abb6e2852d0218">&#9670;&nbsp;</a></span>ata_bus_reset()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ata_bus_reset </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00668">668</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;{</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        <a class="code" href="speedregs_8h.html#ae17edfe9beb1af5c9a18069f5346c1b5">USE_SPD_REGS</a>;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <a class="code" href="speedregs_8h.html#a0de0649a772d3a30be4b67b3d222d246">SPD_REG16</a>(<a class="code" href="speedregs_8h.html#ad03f9f6f9754ce6e5698e72c631f5345">SPD_R_IF_CTRL</a>) = <a class="code" href="speedregs_8h.html#ad5775b2b522c150869f827f193f68cf8">SPD_IF_ATA_RESET</a>;</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <a class="code" href="thbase_8h.html#a9e662b5867cf57e38015ced97ae413b6">DelayThread</a>(100);</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <a class="code" href="speedregs_8h.html#a0de0649a772d3a30be4b67b3d222d246">SPD_REG16</a>(<a class="code" href="speedregs_8h.html#ad03f9f6f9754ce6e5698e72c631f5345">SPD_R_IF_CTRL</a>) = 0;   <span class="comment">//Not present in v1.04.</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <a class="code" href="speedregs_8h.html#a0de0649a772d3a30be4b67b3d222d246">SPD_REG16</a>(<a class="code" href="speedregs_8h.html#ad03f9f6f9754ce6e5698e72c631f5345">SPD_R_IF_CTRL</a>) = 0x48;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;        <a class="code" href="thbase_8h.html#a9e662b5867cf57e38015ced97ae413b6">DelayThread</a>(3000);</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="ps2atad_8c.html#ac9d4860c58b04a2ac5d3f1f003e5a8e7">ata_wait_busy</a>();</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;}</div>
<div class="ttc" id="aps2atad_8c_html_ac9d4860c58b04a2ac5d3f1f003e5a8e7"><div class="ttname"><a href="ps2atad_8c.html#ac9d4860c58b04a2ac5d3f1f003e5a8e7">ata_wait_busy</a></div><div class="ttdeci">#define ata_wait_busy()</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00306">ps2atad.c:306</a></div></div>
<div class="ttc" id="aspeedregs_8h_html_ad03f9f6f9754ce6e5698e72c631f5345"><div class="ttname"><a href="speedregs_8h.html#ad03f9f6f9754ce6e5698e72c631f5345">SPD_R_IF_CTRL</a></div><div class="ttdeci">#define SPD_R_IF_CTRL</div><div class="ttdef"><b>Definition:</b> <a href="speedregs_8h_source.html#l00069">speedregs.h:69</a></div></div>
<div class="ttc" id="aspeedregs_8h_html_ad5775b2b522c150869f827f193f68cf8"><div class="ttname"><a href="speedregs_8h.html#ad5775b2b522c150869f827f193f68cf8">SPD_IF_ATA_RESET</a></div><div class="ttdeci">#define SPD_IF_ATA_RESET</div><div class="ttdef"><b>Definition:</b> <a href="speedregs_8h_source.html#l00070">speedregs.h:70</a></div></div>
<div class="ttc" id="athbase_8h_html_a9e662b5867cf57e38015ced97ae413b6"><div class="ttname"><a href="thbase_8h.html#a9e662b5867cf57e38015ced97ae413b6">DelayThread</a></div><div class="ttdeci">int DelayThread(int usec)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ps2atad_8c_source.html#l00306">ata_wait_busy</a>, <a class="el" href="thbase_8h.html#a9e662b5867cf57e38015ced97ae413b6">DelayThread()</a>, <a class="el" href="speedregs_8h_source.html#l00070">SPD_IF_ATA_RESET</a>, <a class="el" href="speedregs_8h_source.html#l00069">SPD_R_IF_CTRL</a>, <a class="el" href="speedregs_8h_source.html#l00030">SPD_REG16</a>, and <a class="el" href="speedregs_8h_source.html#l00027">USE_SPD_REGS</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l01080">ata_get_devinfo()</a>.</p>

</div>
</div>
<a id="a20c53af141ae920d0af8d759fe48c064"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20c53af141ae920d0af8d759fe48c064">&#9670;&nbsp;</a></span>ata_create_event_flag()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ata_create_event_flag </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00198">198</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;{</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <a class="code" href="structiop__event__t.html">iop_event_t</a> event;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keyword">event</span>.<a class="code" href="structiop__event__t.html#a80c7b9199f5c6b5e3ffbab99128d798c">attr</a> = <a class="code" href="thevent_8h.html#a68413ce2f4e6e05185ec821797be1822">EA_SINGLE</a>; <span class="comment">//In v1.04, EA_MULTI was specified.</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="keyword">event</span>.bits = 0;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="thevent_8h.html#ad35020ce7ba0eb443bffe9ef85eba94a">CreateEventFlag</a>(&amp;event);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;}</div>
<div class="ttc" id="astructiop__event__t_html"><div class="ttname"><a href="structiop__event__t.html">iop_event_t</a></div><div class="ttdef"><b>Definition:</b> <a href="thevent_8h_source.html#l00033">thevent.h:33</a></div></div>
<div class="ttc" id="astructiop__event__t_html_a80c7b9199f5c6b5e3ffbab99128d798c"><div class="ttname"><a href="structiop__event__t.html#a80c7b9199f5c6b5e3ffbab99128d798c">iop_event_t::attr</a></div><div class="ttdeci">u32 attr</div><div class="ttdef"><b>Definition:</b> <a href="thevent_8h_source.html#l00034">thevent.h:34</a></div></div>
<div class="ttc" id="athevent_8h_html_a68413ce2f4e6e05185ec821797be1822"><div class="ttname"><a href="thevent_8h.html#a68413ce2f4e6e05185ec821797be1822">EA_SINGLE</a></div><div class="ttdeci">#define EA_SINGLE</div><div class="ttdef"><b>Definition:</b> <a href="thevent_8h_source.html#l00029">thevent.h:29</a></div></div>
<div class="ttc" id="athevent_8h_html_ad35020ce7ba0eb443bffe9ef85eba94a"><div class="ttname"><a href="thevent_8h.html#ad35020ce7ba0eb443bffe9ef85eba94a">CreateEventFlag</a></div><div class="ttdeci">int CreateEventFlag(iop_event_t *event)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="thevent_8h_source.html#l00034">iop_event_t::attr</a>, <a class="el" href="thevent_8h.html#ad35020ce7ba0eb443bffe9ef85eba94a">CreateEventFlag()</a>, and <a class="el" href="thevent_8h_source.html#l00029">EA_SINGLE</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00207">_start()</a>.</p>

</div>
</div>
<a id="a3829b4feb57d04814b802a1fc5b732b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3829b4feb57d04814b802a1fc5b732b5">&#9670;&nbsp;</a></span>ata_device_flush_cache()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ata_device_flush_cache </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>device</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00699">699</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;{</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <span class="keywordtype">int</span> res;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160; </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <span class="keywordflow">if</span>(!(res = <a class="code" href="ps2atad_8c.html#a072b372a9a27da323409e0d693ab92b8">ata_io_start</a>(<a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 1, 0, 0, 0, 0, 0, (device &lt;&lt; 4) &amp; 0xffff, <a class="code" href="ps2atad_8c.html#ac2dd933f6c797949159ee6ab90e86f53">atad_devinfo</a>[device].lba48?<a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca34d3a17aa19c1617fe1c766979d16ae5">ATA_C_FLUSH_CACHE_EXT</a>:<a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1caa7ad61ff9b0ad4355e964fd8c117cd33">ATA_C_FLUSH_CACHE</a>))) res=<a class="code" href="ps2atad_8c.html#a7d648ea6a0eeb70159b54f0cba6602d9">ata_io_finish</a>();</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;}</div>
<div class="ttc" id="aatahw_8h_html_a414747b879d890c1df55ccbd4208cf1ca34d3a17aa19c1617fe1c766979d16ae5"><div class="ttname"><a href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca34d3a17aa19c1617fe1c766979d16ae5">ATA_C_FLUSH_CACHE_EXT</a></div><div class="ttdeci">@ ATA_C_FLUSH_CACHE_EXT</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00118">atahw.h:118</a></div></div>
<div class="ttc" id="aatahw_8h_html_a414747b879d890c1df55ccbd4208cf1caa7ad61ff9b0ad4355e964fd8c117cd33"><div class="ttname"><a href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1caa7ad61ff9b0ad4355e964fd8c117cd33">ATA_C_FLUSH_CACHE</a></div><div class="ttdeci">@ ATA_C_FLUSH_CACHE</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00116">atahw.h:116</a></div></div>
<div class="ttc" id="adefs_8h_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="defs_8h_source.html#l00022">defs.h:22</a></div></div>
<div class="ttc" id="aps2atad_8c_html_a072b372a9a27da323409e0d693ab92b8"><div class="ttname"><a href="ps2atad_8c.html#a072b372a9a27da323409e0d693ab92b8">ata_io_start</a></div><div class="ttdeci">int ata_io_start(void *buf, u32 blkcount, u16 feature, u16 nsector, u16 sector, u16 lcyl, u16 hcyl, u16 select, u16 command)</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00377">ps2atad.c:377</a></div></div>
<div class="ttc" id="aps2atad_8c_html_a7d648ea6a0eeb70159b54f0cba6602d9"><div class="ttname"><a href="ps2atad_8c.html#a7d648ea6a0eeb70159b54f0cba6602d9">ata_io_finish</a></div><div class="ttdeci">int ata_io_finish(void)</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00597">ps2atad.c:597</a></div></div>
<div class="ttc" id="aps2atad_8c_html_ac2dd933f6c797949159ee6ab90e86f53"><div class="ttname"><a href="ps2atad_8c.html#ac2dd933f6c797949159ee6ab90e86f53">atad_devinfo</a></div><div class="ttdeci">static ata_devinfo_t atad_devinfo[2]</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00064">ps2atad.c:64</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a74641792cccc14f3a6c8676374c414cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74641792cccc14f3a6c8676374c414cd">&#9670;&nbsp;</a></span>ata_device_identify()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ata_device_identify </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00718">718</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;{</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        <span class="keywordtype">int</span> res;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="keywordflow">if</span>(!(res = <a class="code" href="ps2atad_8c.html#a072b372a9a27da323409e0d693ab92b8">ata_io_start</a>(<a class="code" href="structinfo.html">info</a>, 1, 0, 0, 0, 0, 0, (device &lt;&lt; 4) &amp; 0xffff, <a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca3861ececdf1c245b7516916699c3db16">ATA_C_IDENTIFY_DEVICE</a>))) res=<a class="code" href="ps2atad_8c.html#a7d648ea6a0eeb70159b54f0cba6602d9">ata_io_finish</a>();</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160; </div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;}</div>
<div class="ttc" id="aatahw_8h_html_a414747b879d890c1df55ccbd4208cf1ca3861ececdf1c245b7516916699c3db16"><div class="ttname"><a href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca3861ececdf1c245b7516916699c3db16">ATA_C_IDENTIFY_DEVICE</a></div><div class="ttdeci">@ ATA_C_IDENTIFY_DEVICE</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00119">atahw.h:119</a></div></div>
<div class="ttc" id="astructinfo_html"><div class="ttname"><a href="structinfo.html">info</a></div><div class="ttdef"><b>Definition:</b> <a href="xprintf_8c_source.html#l00078">xprintf.c:78</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="atahw_8h_source.html#l00119">ATA_C_IDENTIFY_DEVICE</a>, <a class="el" href="ps2atad_8c_source.html#l00597">ata_io_finish()</a>, and <a class="el" href="ps2atad_8c_source.html#l00377">ata_io_start()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00885">ata_get_security_status()</a>, and <a class="el" href="ps2atad_8c_source.html#l00995">ata_init_devices()</a>.</p>

</div>
</div>
<a id="ad5fe2ce0f6c8ff1c2af5faaac8bc20a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5fe2ce0f6c8ff1c2af5faaac8bc20a9">&#9670;&nbsp;</a></span>ata_device_idle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ata_device_idle </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>period</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00709">709</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;{</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <span class="keywordtype">int</span> res;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160; </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        <span class="keywordflow">if</span>(!(res = <a class="code" href="ps2atad_8c.html#a072b372a9a27da323409e0d693ab92b8">ata_io_start</a>(<a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 1, 0, period &amp; 0xff, 0, 0, 0, (device &lt;&lt; 4) &amp; 0xffff, <a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca381c80ee1d308a7fc86a54f067f40c49">ATA_C_IDLE</a>))) res=<a class="code" href="ps2atad_8c.html#a7d648ea6a0eeb70159b54f0cba6602d9">ata_io_finish</a>();</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160; </div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;}</div>
<div class="ttc" id="aatahw_8h_html_a414747b879d890c1df55ccbd4208cf1ca381c80ee1d308a7fc86a54f067f40c49"><div class="ttname"><a href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca381c80ee1d308a7fc86a54f067f40c49">ATA_C_IDLE</a></div><div class="ttdeci">@ ATA_C_IDLE</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00112">atahw.h:112</a></div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00995">ata_init_devices()</a>.</p>

</div>
</div>
<a id="a5802aa7f4eea2a97d250d6241defa966"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5802aa7f4eea2a97d250d6241defa966">&#9670;&nbsp;</a></span>ata_device_idle_immediate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ata_device_idle_immediate </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>device</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l01186">1186</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;{</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        <span class="keywordtype">int</span> res;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160; </div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;        <span class="keywordflow">if</span> (!(res = <a class="code" href="ps2atad_8c.html#a072b372a9a27da323409e0d693ab92b8">ata_io_start</a>(<a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 1, 0, 0, 0, 0, 0, (device &lt;&lt; 4)&amp;0xFFFF, <a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca4b3b47f8840dfb09af7416fd53ffb3ca">ATA_C_IDLE_IMMEDIATE</a>))) res = <a class="code" href="ps2atad_8c.html#a7d648ea6a0eeb70159b54f0cba6602d9">ata_io_finish</a>();</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160; </div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;        <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;}</div>
<div class="ttc" id="aatahw_8h_html_a414747b879d890c1df55ccbd4208cf1ca4b3b47f8840dfb09af7416fd53ffb3ca"><div class="ttname"><a href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca4b3b47f8840dfb09af7416fd53ffb3ca">ATA_C_IDLE_IMMEDIATE</a></div><div class="ttdeci">@ ATA_C_IDLE_IMMEDIATE</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00110">atahw.h:110</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="atahw_8h_source.html#l00110">ATA_C_IDLE_IMMEDIATE</a>, <a class="el" href="ps2atad_8c_source.html#l00597">ata_io_finish()</a>, <a class="el" href="ps2atad_8c_source.html#l00377">ata_io_start()</a>, and <a class="el" href="defs_8h_source.html#l00022">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="hdd__fio_8c_source.html#l00935">hddDevctl()</a>.</p>

</div>
</div>
<a id="a5b3ec1d0aeda2b32dc5dd7635cecf77b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b3ec1d0aeda2b32dc5dd7635cecf77b">&#9670;&nbsp;</a></span>ata_device_pkt_identify()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ata_device_pkt_identify </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00727">727</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;{</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        <span class="keywordtype">int</span> res;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        res = <a class="code" href="ps2atad_8c.html#a072b372a9a27da323409e0d693ab92b8">ata_io_start</a>(<a class="code" href="structinfo.html">info</a>, 1, 0, 0, 0, 0, 0, (device &lt;&lt; 4) &amp; 0xffff, <a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1caf51f406b4db0dd6b7edec5d923833126">ATA_C_IDENTIFY_PACKET_DEVICE</a>);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <span class="keywordflow">if</span> (!res)</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="ps2atad_8c.html#a7d648ea6a0eeb70159b54f0cba6602d9">ata_io_finish</a>();</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;}</div>
<div class="ttc" id="aatahw_8h_html_a414747b879d890c1df55ccbd4208cf1caf51f406b4db0dd6b7edec5d923833126"><div class="ttname"><a href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1caf51f406b4db0dd6b7edec5d923833126">ATA_C_IDENTIFY_PACKET_DEVICE</a></div><div class="ttdeci">@ ATA_C_IDENTIFY_PACKET_DEVICE</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00094">atahw.h:94</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="atahw_8h_source.html#l00094">ATA_C_IDENTIFY_PACKET_DEVICE</a>, <a class="el" href="ps2atad_8c_source.html#l00597">ata_io_finish()</a>, and <a class="el" href="ps2atad_8c_source.html#l00377">ata_io_start()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00995">ata_init_devices()</a>.</p>

</div>
</div>
<a id="a7219d59eb0dda86631c77e5b13eee187"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7219d59eb0dda86631c77e5b13eee187">&#9670;&nbsp;</a></span>ata_device_probe()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ata_device_probe </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structata__devinfo__t.html">ata_devinfo_t</a> *&#160;</td>
          <td class="paramname"><em>devinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00958">958</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;{</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        <a class="code" href="atahw_8h.html#ab4f7d3947f74abdfbc8b1966edd9c09a">USE_ATA_REGS</a>;</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        <a class="code" href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a> nsector, sector, lcyl, hcyl, <a class="code" href="ps2ip_8h.html#a2b406456012f9f74aeb33de6f3df053c">select</a>;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160; </div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        devinfo-&gt;<a class="code" href="structata__devinfo__t.html#a24e2e6b5ba4ac8e8bf7e1adfb04e3c2a">exists</a> = 0;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        devinfo-&gt;<a class="code" href="structata__devinfo__t.html#a40fa572b16def3fc0b7b008da4ca41d4">has_packet</a> = 2;</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160; </div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        <span class="keywordflow">if</span> (ata_hwport-&gt;r_control &amp; 0x88)</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160; </div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        nsector = ata_hwport-&gt;r_nsector &amp; 0xff;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        sector = ata_hwport-&gt;r_sector &amp; 0xff;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        lcyl = ata_hwport-&gt;r_lcyl &amp; 0xff;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        hcyl = ata_hwport-&gt;r_hcyl &amp; 0xff;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        <a class="code" href="ps2ip_8h.html#a2b406456012f9f74aeb33de6f3df053c">select</a> = ata_hwport-&gt;r_select;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160; </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <span class="keywordflow">if</span> ((nsector != 1) || (sector != 1))</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        devinfo-&gt;<a class="code" href="structata__devinfo__t.html#a24e2e6b5ba4ac8e8bf7e1adfb04e3c2a">exists</a> = 1;</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160; </div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        <span class="keywordflow">if</span> ((lcyl == 0x00) &amp;&amp; (hcyl == 0x00))</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                devinfo-&gt;<a class="code" href="structata__devinfo__t.html#a40fa572b16def3fc0b7b008da4ca41d4">has_packet</a> = 0;</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((lcyl == 0x14) &amp;&amp; (hcyl == 0xeb))</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                devinfo-&gt;<a class="code" href="structata__devinfo__t.html#a40fa572b16def3fc0b7b008da4ca41d4">has_packet</a> = 1;</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160; </div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        <span class="comment">/* Seems to be for ensuring that there is a device connected.</span></div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="comment">                Not sure why this has to be done, but is present in v2.4.  */</span></div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;        ata_hwport-&gt;r_lcyl = 0x55;</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;        ata_hwport-&gt;r_hcyl = 0xaa;</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        lcyl = ata_hwport-&gt;r_lcyl &amp; 0xff;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        hcyl = ata_hwport-&gt;r_hcyl &amp; 0xff;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160; </div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        <span class="keywordflow">if</span>((lcyl != 0x55) || (hcyl != 0xaa))</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                devinfo-&gt;<a class="code" href="structata__devinfo__t.html#a24e2e6b5ba4ac8e8bf7e1adfb04e3c2a">exists</a> = 0;</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;}</div>
<div class="ttc" id="aatahw_8h_html_ab4f7d3947f74abdfbc8b1966edd9c09a"><div class="ttname"><a href="atahw_8h.html#ab4f7d3947f74abdfbc8b1966edd9c09a">USE_ATA_REGS</a></div><div class="ttdeci">#define USE_ATA_REGS</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00043">atahw.h:43</a></div></div>
<div class="ttc" id="aps2ip_8h_html_a2b406456012f9f74aeb33de6f3df053c"><div class="ttname"><a href="ps2ip_8h.html#a2b406456012f9f74aeb33de6f3df053c">select</a></div><div class="ttdeci">#define select</div><div class="ttdef"><b>Definition:</b> <a href="ps2ip_8h_source.html#l00149">ps2ip.h:149</a></div></div>
<div class="ttc" id="astructata__devinfo__t_html_a24e2e6b5ba4ac8e8bf7e1adfb04e3c2a"><div class="ttname"><a href="structata__devinfo__t.html#a24e2e6b5ba4ac8e8bf7e1adfb04e3c2a">ata_devinfo_t::exists</a></div><div class="ttdeci">s32 exists</div><div class="ttdef"><b>Definition:</b> <a href="atad_8h_source.html#l00028">atad.h:28</a></div></div>
<div class="ttc" id="astructata__devinfo__t_html_a40fa572b16def3fc0b7b008da4ca41d4"><div class="ttname"><a href="structata__devinfo__t.html#a40fa572b16def3fc0b7b008da4ca41d4">ata_devinfo_t::has_packet</a></div><div class="ttdeci">s32 has_packet</div><div class="ttdef"><b>Definition:</b> <a href="atad_8h_source.html#l00030">atad.h:30</a></div></div>
<div class="ttc" id="atamtypes_8h_html_a9e6c91d77e24643b888dbd1a1a590054"><div class="ttname"><a href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a></div><div class="ttdeci">unsigned short u16</div><div class="ttdef"><b>Definition:</b> <a href="tamtypes_8h_source.html#l00024">tamtypes.h:24</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="atad_8h_source.html#l00028">ata_devinfo_t::exists</a>, <a class="el" href="atad_8h_source.html#l00030">ata_devinfo_t::has_packet</a>, <a class="el" href="ps2ip_8h_source.html#l00149">select</a>, and <a class="el" href="atahw_8h_source.html#l00043">USE_ATA_REGS</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00995">ata_init_devices()</a>.</p>

</div>
</div>
<a id="aa14172e73d2398ff898353839aef7d21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa14172e73d2398ff898353839aef7d21">&#9670;&nbsp;</a></span>ata_device_sce_identify_drive()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ata_device_sce_identify_drive </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00738">738</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;{</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        <span class="keywordtype">int</span> res;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160; </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        <span class="keywordflow">if</span>(!(res = <a class="code" href="ps2atad_8c.html#a072b372a9a27da323409e0d693ab92b8">ata_io_start</a>(data, 1, <a class="code" href="atahw_8h.html#a4b112c014d1917234e33ec5dca4c2847a9433ff34e77c159c74e6e8799478e599">ATA_SCE_IDENTIFY_DRIVE</a>, 0, 0, 0, 0, (device &lt;&lt; 4) &amp; 0xffff, <a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca636c7fa5a858d8799484a1650fb410b7">ATA_C_SCE_SECURITY_CONTROL</a>))) res=<a class="code" href="ps2atad_8c.html#a7d648ea6a0eeb70159b54f0cba6602d9">ata_io_finish</a>();</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160; </div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;}</div>
<div class="ttc" id="aatahw_8h_html_a414747b879d890c1df55ccbd4208cf1ca636c7fa5a858d8799484a1650fb410b7"><div class="ttname"><a href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca636c7fa5a858d8799484a1650fb410b7">ATA_C_SCE_SECURITY_CONTROL</a></div><div class="ttdeci">@ ATA_C_SCE_SECURITY_CONTROL</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00089">atahw.h:89</a></div></div>
<div class="ttc" id="aatahw_8h_html_a4b112c014d1917234e33ec5dca4c2847a9433ff34e77c159c74e6e8799478e599"><div class="ttname"><a href="atahw_8h.html#a4b112c014d1917234e33ec5dca4c2847a9433ff34e77c159c74e6e8799478e599">ATA_SCE_IDENTIFY_DRIVE</a></div><div class="ttdeci">@ ATA_SCE_IDENTIFY_DRIVE</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00136">atahw.h:136</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="atahw_8h_source.html#l00089">ATA_C_SCE_SECURITY_CONTROL</a>, <a class="el" href="ps2atad_8c_source.html#l00597">ata_io_finish()</a>, <a class="el" href="ps2atad_8c_source.html#l00377">ata_io_start()</a>, and <a class="el" href="atahw_8h_source.html#l00136">ATA_SCE_IDENTIFY_DRIVE</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00995">ata_init_devices()</a>, and <a class="el" href="hdd__fio_8c_source.html#l00935">hddDevctl()</a>.</p>

</div>
</div>
<a id="a971e6935f9ebcbe8178ada833665d56e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a971e6935f9ebcbe8178ada833665d56e">&#9670;&nbsp;</a></span>ata_device_sce_sec_erase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ata_device_sce_sec_erase </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>device</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00937">937</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;{</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        <a class="code" href="structata__devinfo__t.html">ata_devinfo_t</a> *devinfo = <a class="code" href="ps2atad_8c.html#ac2dd933f6c797949159ee6ab90e86f53">atad_devinfo</a>;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        <span class="keywordtype">int</span> res;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160; </div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;        <span class="keywordflow">if</span> (!(devinfo[device].security_status &amp; <a class="code" href="atahw_8h.html#aa0a20ab5fb0cf09eeb556b7968c66eca">ATA_F_SEC_ENABLED</a>) || !(devinfo[device].security_status &amp; <a class="code" href="atahw_8h.html#a7045dc6494c748df270cab92019ee954">ATA_F_SEC_LOCKED</a>)) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        <span class="comment">/* First send the mandatory ERASE PREPARE command.  */</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        <span class="keywordflow">if</span> ((res = <a class="code" href="ps2atad_8c.html#a072b372a9a27da323409e0d693ab92b8">ata_io_start</a>(<a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 1, <a class="code" href="atahw_8h.html#a4b112c014d1917234e33ec5dca4c2847ab26408b75ac253276b7a3fd8343190fc">ATA_SCE_SECURITY_ERASE_PREPARE</a>, 0, 0, 0, 0, (device &lt;&lt; 4) &amp; 0xffff, <a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca636c7fa5a858d8799484a1650fb410b7">ATA_C_SCE_SECURITY_CONTROL</a>)) != 0)</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                <span class="keywordflow">goto</span> finish;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        <span class="keywordflow">if</span> ((res = <a class="code" href="ps2atad_8c.html#a7d648ea6a0eeb70159b54f0cba6602d9">ata_io_finish</a>()) != 0)</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                <span class="keywordflow">goto</span> finish;</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160; </div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        <span class="keywordflow">if</span> ((res = <a class="code" href="ps2atad_8c.html#a072b372a9a27da323409e0d693ab92b8">ata_io_start</a>(<a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 1, <a class="code" href="atahw_8h.html#a4b112c014d1917234e33ec5dca4c2847a99e4bee4d5ac488b43b9a108a6e32df2">ATA_SCE_SECURITY_ERASE_UNIT</a>, 0, 0, 0, 0, (device &lt;&lt; 4) &amp; 0xffff, <a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca636c7fa5a858d8799484a1650fb410b7">ATA_C_SCE_SECURITY_CONTROL</a>)) == 0)</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;                res = <a class="code" href="ps2atad_8c.html#a7d648ea6a0eeb70159b54f0cba6602d9">ata_io_finish</a>();</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160; </div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;finish:</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;        <a class="code" href="ps2atad_8c.html#a048c448fc8c924064d004dc320230780">ata_get_security_status</a>(device, devinfo, <a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;}</div>
<div class="ttc" id="aatahw_8h_html_a4b112c014d1917234e33ec5dca4c2847a99e4bee4d5ac488b43b9a108a6e32df2"><div class="ttname"><a href="atahw_8h.html#a4b112c014d1917234e33ec5dca4c2847a99e4bee4d5ac488b43b9a108a6e32df2">ATA_SCE_SECURITY_ERASE_UNIT</a></div><div class="ttdeci">@ ATA_SCE_SECURITY_ERASE_UNIT</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00141">atahw.h:141</a></div></div>
<div class="ttc" id="aatahw_8h_html_a4b112c014d1917234e33ec5dca4c2847ab26408b75ac253276b7a3fd8343190fc"><div class="ttname"><a href="atahw_8h.html#a4b112c014d1917234e33ec5dca4c2847ab26408b75ac253276b7a3fd8343190fc">ATA_SCE_SECURITY_ERASE_PREPARE</a></div><div class="ttdeci">@ ATA_SCE_SECURITY_ERASE_PREPARE</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00140">atahw.h:140</a></div></div>
<div class="ttc" id="aatahw_8h_html_a7045dc6494c748df270cab92019ee954"><div class="ttname"><a href="atahw_8h.html#a7045dc6494c748df270cab92019ee954">ATA_F_SEC_LOCKED</a></div><div class="ttdeci">#define ATA_F_SEC_LOCKED</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00169">atahw.h:169</a></div></div>
<div class="ttc" id="aatahw_8h_html_aa0a20ab5fb0cf09eeb556b7968c66eca"><div class="ttname"><a href="atahw_8h.html#aa0a20ab5fb0cf09eeb556b7968c66eca">ATA_F_SEC_ENABLED</a></div><div class="ttdeci">#define ATA_F_SEC_ENABLED</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00168">atahw.h:168</a></div></div>
<div class="ttc" id="aps2atad_8c_html_a048c448fc8c924064d004dc320230780"><div class="ttname"><a href="ps2atad_8c.html#a048c448fc8c924064d004dc320230780">ata_get_security_status</a></div><div class="ttdeci">static void ata_get_security_status(int device, ata_devinfo_t *devinfo, u16 *param)</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00885">ps2atad.c:885</a></div></div>
<div class="ttc" id="astructata__devinfo__t_html"><div class="ttname"><a href="structata__devinfo__t.html">ata_devinfo_t</a></div><div class="ttdef"><b>Definition:</b> <a href="atad_8h_source.html#l00026">atad.h:26</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="atahw_8h_source.html#l00089">ATA_C_SCE_SECURITY_CONTROL</a>, <a class="el" href="atahw_8h_source.html#l00168">ATA_F_SEC_ENABLED</a>, <a class="el" href="atahw_8h_source.html#l00169">ATA_F_SEC_LOCKED</a>, <a class="el" href="ps2atad_8c_source.html#l00885">ata_get_security_status()</a>, <a class="el" href="ps2atad_8c_source.html#l00597">ata_io_finish()</a>, <a class="el" href="ps2atad_8c_source.html#l00377">ata_io_start()</a>, <a class="el" href="atahw_8h_source.html#l00140">ATA_SCE_SECURITY_ERASE_PREPARE</a>, <a class="el" href="atahw_8h_source.html#l00141">ATA_SCE_SECURITY_ERASE_UNIT</a>, <a class="el" href="ps2atad_8c_source.html#l00064">atad_devinfo</a>, and <a class="el" href="defs_8h_source.html#l00022">NULL</a>.</p>

</div>
</div>
<a id="acd72dceef811b7b8b5a209c9f570e2d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd72dceef811b7b8b5a209c9f570e2d8">&#9670;&nbsp;</a></span>ata_device_sce_sec_set_password()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ata_device_sce_sec_set_password </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00892">892</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;{</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <a class="code" href="structata__devinfo__t.html">ata_devinfo_t</a> *devinfo = <a class="code" href="ps2atad_8c.html#ac2dd933f6c797949159ee6ab90e86f53">atad_devinfo</a>;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        <a class="code" href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a> *param = <a class="code" href="ps2atad_8c.html#ad7e4a242bab16217e288f17efa109daf">ata_param</a>;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        <span class="keywordtype">int</span> res;</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160; </div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        <span class="keywordflow">if</span> (devinfo[device].security_status &amp; <a class="code" href="atahw_8h.html#aa0a20ab5fb0cf09eeb556b7968c66eca">ATA_F_SEC_ENABLED</a>) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160; </div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        <a class="code" href="sysclib_8h.html#ab8dce9c192324f0fd191fd5b85c7bb60">memset</a>(param, 0, 512);</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        <a class="code" href="sysclib_8h.html#ad1b7311b48288a0d08172f26ff64dd67">memcpy</a>(param + 1, password, 32);</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160; </div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        res = <a class="code" href="ps2atad_8c.html#a072b372a9a27da323409e0d693ab92b8">ata_io_start</a>(param, 1, <a class="code" href="atahw_8h.html#a4b112c014d1917234e33ec5dca4c2847ae86129a74686a6bb1f2d5f00249231e3">ATA_SCE_SECURITY_SET_PASSWORD</a>, 0, 0, 0, 0, (device &lt;&lt; 4) &amp; 0xffff, <a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca636c7fa5a858d8799484a1650fb410b7">ATA_C_SCE_SECURITY_CONTROL</a>);</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        <span class="keywordflow">if</span> (res == 0)</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                res = <a class="code" href="ps2atad_8c.html#a7d648ea6a0eeb70159b54f0cba6602d9">ata_io_finish</a>();</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        <a class="code" href="ps2atad_8c.html#a048c448fc8c924064d004dc320230780">ata_get_security_status</a>(device, devinfo, param);</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;}</div>
<div class="ttc" id="aatahw_8h_html_a4b112c014d1917234e33ec5dca4c2847ae86129a74686a6bb1f2d5f00249231e3"><div class="ttname"><a href="atahw_8h.html#a4b112c014d1917234e33ec5dca4c2847ae86129a74686a6bb1f2d5f00249231e3">ATA_SCE_SECURITY_SET_PASSWORD</a></div><div class="ttdeci">@ ATA_SCE_SECURITY_SET_PASSWORD</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00138">atahw.h:138</a></div></div>
<div class="ttc" id="aps2atad_8c_html_ad7e4a242bab16217e288f17efa109daf"><div class="ttname"><a href="ps2atad_8c.html#ad7e4a242bab16217e288f17efa109daf">ata_param</a></div><div class="ttdeci">static u16 ata_param[256]</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00068">ps2atad.c:68</a></div></div>
<div class="ttc" id="asysclib_8h_html_ab8dce9c192324f0fd191fd5b85c7bb60"><div class="ttname"><a href="sysclib_8h.html#ab8dce9c192324f0fd191fd5b85c7bb60">memset</a></div><div class="ttdeci">void * memset(void *ptr, int c, size_t size)</div></div>
<div class="ttc" id="asysclib_8h_html_ad1b7311b48288a0d08172f26ff64dd67"><div class="ttname"><a href="sysclib_8h.html#ad1b7311b48288a0d08172f26ff64dd67">memcpy</a></div><div class="ttdeci">void * memcpy(void *dest, const void *src, size_t size)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="atahw_8h_source.html#l00089">ATA_C_SCE_SECURITY_CONTROL</a>, <a class="el" href="atahw_8h_source.html#l00168">ATA_F_SEC_ENABLED</a>, <a class="el" href="ps2atad_8c_source.html#l00885">ata_get_security_status()</a>, <a class="el" href="ps2atad_8c_source.html#l00597">ata_io_finish()</a>, <a class="el" href="ps2atad_8c_source.html#l00377">ata_io_start()</a>, <a class="el" href="ps2atad_8c_source.html#l00068">ata_param</a>, <a class="el" href="atahw_8h_source.html#l00138">ATA_SCE_SECURITY_SET_PASSWORD</a>, <a class="el" href="ps2atad_8c_source.html#l00064">atad_devinfo</a>, <a class="el" href="sysclib_8h.html#ad1b7311b48288a0d08172f26ff64dd67">memcpy()</a>, and <a class="el" href="sysclib_8h.html#ab8dce9c192324f0fd191fd5b85c7bb60">memset()</a>.</p>

</div>
</div>
<a id="a8bad5776d75e69c005ffa7dadd50d550"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bad5776d75e69c005ffa7dadd50d550">&#9670;&nbsp;</a></span>ata_device_sce_sec_unlock()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ata_device_sce_sec_unlock </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00912">912</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;{</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        <a class="code" href="structata__devinfo__t.html">ata_devinfo_t</a> *devinfo = <a class="code" href="ps2atad_8c.html#ac2dd933f6c797949159ee6ab90e86f53">atad_devinfo</a>;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        <a class="code" href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a> *param = <a class="code" href="ps2atad_8c.html#ad7e4a242bab16217e288f17efa109daf">ata_param</a>;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        <span class="keywordtype">int</span> res;</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160; </div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        <span class="keywordflow">if</span> (!(devinfo[device].security_status &amp; <a class="code" href="atahw_8h.html#a7045dc6494c748df270cab92019ee954">ATA_F_SEC_LOCKED</a>)) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        <a class="code" href="sysclib_8h.html#ab8dce9c192324f0fd191fd5b85c7bb60">memset</a>(param, 0, 512);</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        <a class="code" href="sysclib_8h.html#ad1b7311b48288a0d08172f26ff64dd67">memcpy</a>(param + 1, password, 32);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160; </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        <span class="keywordflow">if</span> ((res = <a class="code" href="ps2atad_8c.html#a072b372a9a27da323409e0d693ab92b8">ata_io_start</a>(param, 1, <a class="code" href="atahw_8h.html#a4b112c014d1917234e33ec5dca4c2847ab370cf0ba472a39c7096e487eafdad5f">ATA_SCE_SECURITY_UNLOCK</a>, 0, 0, 0, 0, (device &lt;&lt; 4) &amp; 0xffff, <a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca636c7fa5a858d8799484a1650fb410b7">ATA_C_SCE_SECURITY_CONTROL</a>)) != 0)</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        <span class="keywordflow">if</span> ((res = <a class="code" href="ps2atad_8c.html#a7d648ea6a0eeb70159b54f0cba6602d9">ata_io_finish</a>()) != 0)</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160; </div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        <span class="comment">/* Check to see if the drive was actually unlocked.  */</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <a class="code" href="ps2atad_8c.html#a048c448fc8c924064d004dc320230780">ata_get_security_status</a>(device, devinfo, param);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        <span class="keywordflow">if</span> (devinfo[device].security_status &amp; <a class="code" href="atahw_8h.html#a7045dc6494c748df270cab92019ee954">ATA_F_SEC_LOCKED</a>)</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="atad_8h.html#a1ea58c09f8952bf348e92406c0d394f0">ATA_RES_ERR_LOCKED</a>;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160; </div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;}</div>
<div class="ttc" id="aatad_8h_html_a1ea58c09f8952bf348e92406c0d394f0"><div class="ttname"><a href="atad_8h.html#a1ea58c09f8952bf348e92406c0d394f0">ATA_RES_ERR_LOCKED</a></div><div class="ttdeci">#define ATA_RES_ERR_LOCKED</div><div class="ttdef"><b>Definition:</b> <a href="atad_8h_source.html#l00046">atad.h:46</a></div></div>
<div class="ttc" id="aatahw_8h_html_a4b112c014d1917234e33ec5dca4c2847ab370cf0ba472a39c7096e487eafdad5f"><div class="ttname"><a href="atahw_8h.html#a4b112c014d1917234e33ec5dca4c2847ab370cf0ba472a39c7096e487eafdad5f">ATA_SCE_SECURITY_UNLOCK</a></div><div class="ttdeci">@ ATA_SCE_SECURITY_UNLOCK</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00139">atahw.h:139</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8e81d9acd6155b847e9f228c0e0a1df8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e81d9acd6155b847e9f228c0e0a1df8">&#9670;&nbsp;</a></span>ata_device_sector_io()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ata_device_sector_io </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tamtypes_8h.html#a2caf5cd7bcdbe1eefa727f44ffb10bac">u32</a>&#160;</td>
          <td class="paramname"><em>lba</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tamtypes_8h.html#a2caf5cd7bcdbe1eefa727f44ffb10bac">u32</a>&#160;</td>
          <td class="paramname"><em>nsectors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00821">821</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;{</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        <a class="code" href="speedregs_8h.html#ae17edfe9beb1af5c9a18069f5346c1b5">USE_SPD_REGS</a>;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        <span class="keywordtype">int</span> res = 0, retries;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        <a class="code" href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a> sector, lcyl, hcyl, <a class="code" href="ps2ip_8h.html#a2b406456012f9f74aeb33de6f3df053c">select</a>, command, len;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160; </div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        <span class="keywordflow">while</span> (res == 0 &amp;&amp; nsectors &gt; 0) {</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                <span class="comment">/* Variable lba is only 32 bits so no change for lcyl and hcyl.  */</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                lcyl = (lba &gt;&gt; 8) &amp; 0xff;</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                hcyl = (lba &gt;&gt; 16) &amp; 0xff;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160; </div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="ps2atad_8c.html#ac2dd933f6c797949159ee6ab90e86f53">atad_devinfo</a>[device].lba48) {</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                        <span class="comment">/* Setup for 48-bit LBA.  */</span></div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                        len = (nsectors &gt; 65536) ? 65536 : nsectors;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160; </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                        <span class="comment">/* Combine bits 24-31 and bits 0-7 of lba into sector.  */</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                        sector = ((lba &gt;&gt; 16) &amp; 0xff00) | (lba &amp; 0xff);</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                        <span class="comment">/* In v1.04, LBA was enabled here.  */</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                        <a class="code" href="ps2ip_8h.html#a2b406456012f9f74aeb33de6f3df053c">select</a> = (device &lt;&lt; 4) &amp; 0xffff;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                        command = (dir == 1) ? <a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca1c561d573050b2cc430620ed181563ac">ATA_C_WRITE_DMA_EXT</a> : <a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca829d6f30a4eb1e462e302b054a8107fe">ATA_C_READ_DMA_EXT</a>;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                        <span class="comment">/* Setup for 28-bit LBA.  */</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                        len = (nsectors &gt; 256) ? 256 : nsectors;</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                        sector = lba &amp; 0xff;</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                        <span class="comment">/* In v1.04, LBA was enabled here.  */</span></div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                        <a class="code" href="ps2ip_8h.html#a2b406456012f9f74aeb33de6f3df053c">select</a> = ((device &lt;&lt; 4) | ((lba &gt;&gt; 24) &amp; 0xf)) &amp; 0xffff;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                        command = (dir == 1) ? <a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca7f4ab2d9bfd8e0b6ddb39ed4d42c142e">ATA_C_WRITE_DMA</a> : <a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca8528cbf02928a3d56063941d7c0f4fdb">ATA_C_READ_DMA</a>;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                }</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160; </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                <span class="keywordflow">for</span>(retries = 3; retries &gt; 0; retries--) {</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="preprocessor">#ifdef ATA_GAMESTAR_WORKAROUND</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                        <span class="comment">/* Due to the retry loop, put this call (for the GameStar workaround) here instead of the old location. */</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                        <span class="keywordflow">if</span> (ata_gamestar_workaround)</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                                <a class="code" href="ps2atad_8c.html#a2908a76726fc3566bbdf7a9394d10da4">ata_set_dir</a>(dir);</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160; </div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                        <span class="keywordflow">if</span> ((res = <a class="code" href="ps2atad_8c.html#a072b372a9a27da323409e0d693ab92b8">ata_io_start</a>(buf, len, 0, len, sector, lcyl, hcyl, <a class="code" href="ps2ip_8h.html#a2b406456012f9f74aeb33de6f3df053c">select</a>, command)) != 0)</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="preprocessor">#ifdef ATA_GAMESTAR_WORKAROUND</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                        <span class="keywordflow">if</span> (!ata_gamestar_workaround)</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                                <a class="code" href="ps2atad_8c.html#a2908a76726fc3566bbdf7a9394d10da4">ata_set_dir</a>(dir);</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                        <span class="comment">/* Set up (part of) the transfer here. In v1.04, this was called at the top of the outer loop. */</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                        <a class="code" href="ps2atad_8c.html#a2908a76726fc3566bbdf7a9394d10da4">ata_set_dir</a>(dir);</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160; </div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                        res = <a class="code" href="ps2atad_8c.html#a7d648ea6a0eeb70159b54f0cba6602d9">ata_io_finish</a>();</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160; </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                        <span class="comment">/* In v1.04, this was not done. Neither was there a mechanism to retry if a non-permanent error occurs. */</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                        <a class="code" href="speedregs_8h.html#a0de0649a772d3a30be4b67b3d222d246">SPD_REG16</a>(<a class="code" href="speedregs_8h.html#ad03f9f6f9754ce6e5698e72c631f5345">SPD_R_IF_CTRL</a>) &amp;= ~<a class="code" href="speedregs_8h.html#a38701908516c92dc682053ff06adb73d">SPD_IF_DMA_ENABLE</a>;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160; </div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;                        <span class="keywordflow">if</span>(res != <a class="code" href="atad_8h.html#a635f0bfa6a11e9e69a9f3a57f6f603c6">ATA_RES_ERR_ICRC</a>)</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                }</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160; </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;                buf = (<span class="keywordtype">void</span>*)((<a class="code" href="tamtypes_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> *)buf + len * 512);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                lba += len;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                nsectors -= len;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        }</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160; </div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;}</div>
<div class="ttc" id="aatad_8h_html_a635f0bfa6a11e9e69a9f3a57f6f603c6"><div class="ttname"><a href="atad_8h.html#a635f0bfa6a11e9e69a9f3a57f6f603c6">ATA_RES_ERR_ICRC</a></div><div class="ttdeci">#define ATA_RES_ERR_ICRC</div><div class="ttdef"><b>Definition:</b> <a href="atad_8h_source.html#l00047">atad.h:47</a></div></div>
<div class="ttc" id="aatahw_8h_html_a414747b879d890c1df55ccbd4208cf1ca1c561d573050b2cc430620ed181563ac"><div class="ttname"><a href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca1c561d573050b2cc430620ed181563ac">ATA_C_WRITE_DMA_EXT</a></div><div class="ttdeci">@ ATA_C_WRITE_DMA_EXT</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00083">atahw.h:83</a></div></div>
<div class="ttc" id="aatahw_8h_html_a414747b879d890c1df55ccbd4208cf1ca7f4ab2d9bfd8e0b6ddb39ed4d42c142e"><div class="ttname"><a href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca7f4ab2d9bfd8e0b6ddb39ed4d42c142e">ATA_C_WRITE_DMA</a></div><div class="ttdeci">@ ATA_C_WRITE_DMA</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00103">atahw.h:103</a></div></div>
<div class="ttc" id="aatahw_8h_html_a414747b879d890c1df55ccbd4208cf1ca829d6f30a4eb1e462e302b054a8107fe"><div class="ttname"><a href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca829d6f30a4eb1e462e302b054a8107fe">ATA_C_READ_DMA_EXT</a></div><div class="ttdeci">@ ATA_C_READ_DMA_EXT</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00079">atahw.h:79</a></div></div>
<div class="ttc" id="aatahw_8h_html_a414747b879d890c1df55ccbd4208cf1ca8528cbf02928a3d56063941d7c0f4fdb"><div class="ttname"><a href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca8528cbf02928a3d56063941d7c0f4fdb">ATA_C_READ_DMA</a></div><div class="ttdeci">@ ATA_C_READ_DMA</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00102">atahw.h:102</a></div></div>
<div class="ttc" id="aps2atad_8c_html_a2908a76726fc3566bbdf7a9394d10da4"><div class="ttname"><a href="ps2atad_8c.html#a2908a76726fc3566bbdf7a9394d10da4">ata_set_dir</a></div><div class="ttdeci">static void ata_set_dir(int dir)</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l01090">ps2atad.c:1090</a></div></div>
<div class="ttc" id="aspeedregs_8h_html_a38701908516c92dc682053ff06adb73d"><div class="ttname"><a href="speedregs_8h.html#a38701908516c92dc682053ff06adb73d">SPD_IF_DMA_ENABLE</a></div><div class="ttdeci">#define SPD_IF_DMA_ENABLE</div><div class="ttdef"><b>Definition:</b> <a href="speedregs_8h_source.html#l00071">speedregs.h:71</a></div></div>
<div class="ttc" id="atamtypes_8h_html_aed742c436da53c1080638ce6ef7d13de"><div class="ttname"><a href="tamtypes_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a></div><div class="ttdeci">unsigned char u8</div><div class="ttdef"><b>Definition:</b> <a href="tamtypes_8h_source.html#l00023">tamtypes.h:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afa869626ecb5359525c66f68b8fd44f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa869626ecb5359525c66f68b8fd44f3">&#9670;&nbsp;</a></span>ata_device_select()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ata_device_select </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>device</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00347">347</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;{</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <a class="code" href="atahw_8h.html#ab4f7d3947f74abdfbc8b1966edd9c09a">USE_ATA_REGS</a>;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="keywordtype">int</span> res;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="keywordflow">if</span> ((res = <a class="code" href="ps2atad_8c.html#a47d0aa3b3027856f7af6c5b0496ecc8e">ata_wait_bus_busy</a>()) &lt; 0)</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="comment">/* If the device was already selected, nothing to do.  */</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="keywordflow">if</span> (((ata_hwport-&gt;r_select &gt;&gt; 4) &amp; 1) == device)</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="comment">/* Select the device.  */</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        ata_hwport-&gt;r_select = (device &amp; 1) &lt;&lt; 4;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        res = ata_hwport-&gt;r_control;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        res = ata_hwport-&gt;r_control;    <span class="comment">//Only done once in v1.04.</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="ps2atad_8c.html#a47d0aa3b3027856f7af6c5b0496ecc8e">ata_wait_bus_busy</a>();</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;}</div>
<div class="ttc" id="aps2atad_8c_html_a47d0aa3b3027856f7af6c5b0496ecc8e"><div class="ttname"><a href="ps2atad_8c.html#a47d0aa3b3027856f7af6c5b0496ecc8e">ata_wait_bus_busy</a></div><div class="ttdeci">#define ata_wait_bus_busy()</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00307">ps2atad.c:307</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ps2atad_8c_source.html#l00307">ata_wait_bus_busy</a>, and <a class="el" href="atahw_8h_source.html#l00043">USE_ATA_REGS</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00995">ata_init_devices()</a>, and <a class="el" href="ps2atad_8c_source.html#l00377">ata_io_start()</a>.</p>

</div>
</div>
<a id="a1834dc226e9b1f884dc42d1a51dc6fc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1834dc226e9b1f884dc42d1a51dc6fc1">&#9670;&nbsp;</a></span>ata_device_set_transfer_mode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ata_device_set_transfer_mode </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00790">790</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;{</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        <span class="keywordtype">int</span> res;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160; </div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        res = <a class="code" href="ps2atad_8c.html#a072b372a9a27da323409e0d693ab92b8">ata_io_start</a>(<a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 1, 3, (type|mode) &amp; 0xff, 0, 0, 0, (device &lt;&lt; 4) &amp; 0xffff, <a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca6c58d4f4bf00960e18f11f578b4b1112">ATA_C_SET_FEATURES</a>);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <span class="keywordflow">if</span> (res)</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;        res = <a class="code" href="ps2atad_8c.html#a7d648ea6a0eeb70159b54f0cba6602d9">ata_io_finish</a>();</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        <span class="keywordflow">if</span> (res)</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160; </div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        <span class="keywordflow">switch</span>(type){</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="preprocessor">#ifdef ATA_MWDMA_MODES</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                <span class="keywordflow">case</span> ATA_XFER_MODE_MDMA:</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                        ata_multiword_dma_mode(mode);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="ps2atad_8c.html#a14fe84248abb890fc60fe8f15a1b4a81">ATA_XFER_MODE_UDMA</a>:</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;                        <a class="code" href="ps2atad_8c.html#a077ecda08e27dfa44cadda1e1c8b18b8">ata_ultra_dma_mode</a>(mode);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                <span class="keywordflow">case</span> <a class="code" href="ps2atad_8c.html#a0501ebf99d49abd4da7c617069a3d0d3">ATA_XFER_MODE_PIO</a>:</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                        <a class="code" href="ps2atad_8c.html#a9a34bad4a0850d3cf877949bdaf78218">ata_pio_mode</a>(mode);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        }</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160; </div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;}</div>
<div class="ttc" id="aatahw_8h_html_a414747b879d890c1df55ccbd4208cf1ca6c58d4f4bf00960e18f11f578b4b1112"><div class="ttname"><a href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca6c58d4f4bf00960e18f11f578b4b1112">ATA_C_SET_FEATURES</a></div><div class="ttdeci">@ ATA_C_SET_FEATURES</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00122">atahw.h:122</a></div></div>
<div class="ttc" id="aps2atad_8c_html_a0501ebf99d49abd4da7c617069a3d0d3"><div class="ttname"><a href="ps2atad_8c.html#a0501ebf99d49abd4da7c617069a3d0d3">ATA_XFER_MODE_PIO</a></div><div class="ttdeci">#define ATA_XFER_MODE_PIO</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00045">ps2atad.c:45</a></div></div>
<div class="ttc" id="aps2atad_8c_html_a077ecda08e27dfa44cadda1e1c8b18b8"><div class="ttname"><a href="ps2atad_8c.html#a077ecda08e27dfa44cadda1e1c8b18b8">ata_ultra_dma_mode</a></div><div class="ttdeci">static void ata_ultra_dma_mode(int mode)</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l01158">ps2atad.c:1158</a></div></div>
<div class="ttc" id="aps2atad_8c_html_a14fe84248abb890fc60fe8f15a1b4a81"><div class="ttname"><a href="ps2atad_8c.html#a14fe84248abb890fc60fe8f15a1b4a81">ATA_XFER_MODE_UDMA</a></div><div class="ttdeci">#define ATA_XFER_MODE_UDMA</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00049">ps2atad.c:49</a></div></div>
<div class="ttc" id="aps2atad_8c_html_a9a34bad4a0850d3cf877949bdaf78218"><div class="ttname"><a href="ps2atad_8c.html#a9a34bad4a0850d3cf877949bdaf78218">ata_pio_mode</a></div><div class="ttdeci">static void ata_pio_mode(int mode)</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l01106">ps2atad.c:1106</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="atahw_8h_source.html#l00122">ATA_C_SET_FEATURES</a>, <a class="el" href="ps2atad_8c_source.html#l00597">ata_io_finish()</a>, <a class="el" href="ps2atad_8c_source.html#l00377">ata_io_start()</a>, <a class="el" href="ps2atad_8c_source.html#l01106">ata_pio_mode()</a>, <a class="el" href="ps2atad_8c_source.html#l01158">ata_ultra_dma_mode()</a>, <a class="el" href="ps2atad_8c_source.html#l00045">ATA_XFER_MODE_PIO</a>, <a class="el" href="ps2atad_8c_source.html#l00049">ATA_XFER_MODE_UDMA</a>, <a class="el" href="irx_8h_source.html#l00089">irx_export_table::mode</a>, and <a class="el" href="defs_8h_source.html#l00022">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00995">ata_init_devices()</a>.</p>

</div>
</div>
<a id="a11c2db58d257d48f25a26a963e8bc698"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11c2db58d257d48f25a26a963e8bc698">&#9670;&nbsp;</a></span>ata_device_smart_enable()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ata_device_smart_enable </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>device</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00747">747</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;{</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        <span class="keywordtype">int</span> res;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        <span class="keywordflow">if</span>(!(res = <a class="code" href="ps2atad_8c.html#a072b372a9a27da323409e0d693ab92b8">ata_io_start</a>(<a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 1, <a class="code" href="atahw_8h.html#ac3fe83b43eefb25639ccd0d41935e6f0a3f480513f134e7e2a410542aabbde6cd">ATA_S_SMART_ENABLE_OPERATIONS</a>, 0, 0, 0x4f, 0xc2, (device &lt;&lt; 4) &amp; 0xffff, <a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca0f23e95ceda82aee30c00f03f0512c29">ATA_C_SMART</a>))) res=<a class="code" href="ps2atad_8c.html#a7d648ea6a0eeb70159b54f0cba6602d9">ata_io_finish</a>();</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;}</div>
<div class="ttc" id="aatahw_8h_html_a414747b879d890c1df55ccbd4208cf1ca0f23e95ceda82aee30c00f03f0512c29"><div class="ttname"><a href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca0f23e95ceda82aee30c00f03f0512c29">ATA_C_SMART</a></div><div class="ttdeci">@ ATA_C_SMART</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00096">atahw.h:96</a></div></div>
<div class="ttc" id="aatahw_8h_html_ac3fe83b43eefb25639ccd0d41935e6f0a3f480513f134e7e2a410542aabbde6cd"><div class="ttname"><a href="atahw_8h.html#ac3fe83b43eefb25639ccd0d41935e6f0a3f480513f134e7e2a410542aabbde6cd">ATA_S_SMART_ENABLE_OPERATIONS</a></div><div class="ttdeci">@ ATA_S_SMART_ENABLE_OPERATIONS</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00154">atahw.h:154</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="atahw_8h_source.html#l00096">ATA_C_SMART</a>, <a class="el" href="ps2atad_8c_source.html#l00597">ata_io_finish()</a>, <a class="el" href="ps2atad_8c_source.html#l00377">ata_io_start()</a>, <a class="el" href="atahw_8h_source.html#l00154">ATA_S_SMART_ENABLE_OPERATIONS</a>, and <a class="el" href="defs_8h_source.html#l00022">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00995">ata_init_devices()</a>.</p>

</div>
</div>
<a id="a22e8d778ec05b07d112e1a1256bc421a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22e8d778ec05b07d112e1a1256bc421a">&#9670;&nbsp;</a></span>ata_device_smart_get_status()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ata_device_smart_get_status </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>device</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00767">767</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;{</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        <a class="code" href="atahw_8h.html#ab4f7d3947f74abdfbc8b1966edd9c09a">USE_ATA_REGS</a>;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        <span class="keywordtype">int</span> res;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        res = <a class="code" href="ps2atad_8c.html#a072b372a9a27da323409e0d693ab92b8">ata_io_start</a>(<a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 1, <a class="code" href="atahw_8h.html#ac3fe83b43eefb25639ccd0d41935e6f0accf0a7832ee3df9bea4ce618b807d5d7">ATA_S_SMART_RETURN_STATUS</a>, 0, 0, 0x4f, 0xc2, (device &lt;&lt; 4) &amp; 0xffff, <a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca0f23e95ceda82aee30c00f03f0512c29">ATA_C_SMART</a>);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        <span class="keywordflow">if</span> (res)</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        res = <a class="code" href="ps2atad_8c.html#a7d648ea6a0eeb70159b54f0cba6602d9">ata_io_finish</a>();</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        <span class="keywordflow">if</span> (res)</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160; </div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        <span class="comment">/* Check to see if the report exceeded the threshold.  */</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        <span class="keywordflow">if</span> (((ata_hwport-&gt;r_lcyl&amp;0xFF) != 0x4f) || ((ata_hwport-&gt;r_hcyl&amp;0xFF) != 0xc2)) {</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                <a class="code" href="ps2atad_8c.html#a1250382de8ce63fd75727fe97bbb8187">M_PRINTF</a>(<span class="stringliteral">&quot;Error: SMART report exceeded threshold.\n&quot;</span>);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        }</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;}</div>
<div class="ttc" id="aatahw_8h_html_ac3fe83b43eefb25639ccd0d41935e6f0accf0a7832ee3df9bea4ce618b807d5d7"><div class="ttname"><a href="atahw_8h.html#ac3fe83b43eefb25639ccd0d41935e6f0accf0a7832ee3df9bea4ce618b807d5d7">ATA_S_SMART_RETURN_STATUS</a></div><div class="ttdeci">@ ATA_S_SMART_RETURN_STATUS</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00157">atahw.h:156</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="atahw_8h_source.html#l00096">ATA_C_SMART</a>, <a class="el" href="ps2atad_8c_source.html#l00597">ata_io_finish()</a>, <a class="el" href="ps2atad_8c_source.html#l00377">ata_io_start()</a>, <a class="el" href="atahw_8h_source.html#l00156">ATA_S_SMART_RETURN_STATUS</a>, <a class="el" href="ps2atad_8c_source.html#l00039">M_PRINTF</a>, <a class="el" href="defs_8h_source.html#l00022">NULL</a>, and <a class="el" href="atahw_8h_source.html#l00043">USE_ATA_REGS</a>.</p>

<p class="reference">Referenced by <a class="el" href="hdd__fio_8c_source.html#l00935">hddDevctl()</a>.</p>

</div>
</div>
<a id="a3d4aae34d39b741895c17cace6f05b3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d4aae34d39b741895c17cace6f05b3e">&#9670;&nbsp;</a></span>ata_device_smart_save_attr()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ata_device_smart_save_attr </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>device</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00757">757</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;{</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <span class="keywordtype">int</span> res;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; </div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <span class="keywordflow">if</span>(!(res = <a class="code" href="ps2atad_8c.html#a072b372a9a27da323409e0d693ab92b8">ata_io_start</a>(<a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 1, <a class="code" href="atahw_8h.html#ac3fe83b43eefb25639ccd0d41935e6f0a259d021f1364bf8602f4307ba0d55338">ATA_S_SMART_SAVE_ATTRIBUTE_VALUES</a>, 0, 0, 0x4f, 0xc2, (device &lt;&lt; 4) &amp; 0xffff, <a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca0f23e95ceda82aee30c00f03f0512c29">ATA_C_SMART</a>))) res=<a class="code" href="ps2atad_8c.html#a7d648ea6a0eeb70159b54f0cba6602d9">ata_io_finish</a>();</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160; </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;}</div>
<div class="ttc" id="aatahw_8h_html_ac3fe83b43eefb25639ccd0d41935e6f0a259d021f1364bf8602f4307ba0d55338"><div class="ttname"><a href="atahw_8h.html#ac3fe83b43eefb25639ccd0d41935e6f0a259d021f1364bf8602f4307ba0d55338">ATA_S_SMART_SAVE_ATTRIBUTE_VALUES</a></div><div class="ttdeci">@ ATA_S_SMART_SAVE_ATTRIBUTE_VALUES</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00150">atahw.h:150</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="atahw_8h_source.html#l00096">ATA_C_SMART</a>, <a class="el" href="ps2atad_8c_source.html#l00597">ata_io_finish()</a>, <a class="el" href="ps2atad_8c_source.html#l00377">ata_io_start()</a>, <a class="el" href="atahw_8h_source.html#l00150">ATA_S_SMART_SAVE_ATTRIBUTE_VALUES</a>, and <a class="el" href="defs_8h_source.html#l00022">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="hdd_8c_source.html#l00310">hddShutdownCb()</a>.</p>

</div>
</div>
<a id="a2858d85ffb9fcd6a6e30d268d134fe3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2858d85ffb9fcd6a6e30d268d134fe3c">&#9670;&nbsp;</a></span>ata_device_standby_immediate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ata_device_standby_immediate </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>device</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l01195">1195</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;{</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;        <span class="keywordtype">int</span> res;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160; </div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        <span class="keywordflow">if</span> (!(res = <a class="code" href="ps2atad_8c.html#a072b372a9a27da323409e0d693ab92b8">ata_io_start</a>(<a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 1, 0, 0, 0, 0, 0, (device &lt;&lt; 4)&amp;0xFFFF, <a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca45418419e19eb67ee21985f2c75934ff">ATA_C_STANDBY_IMMEDIATE</a>))) res = <a class="code" href="ps2atad_8c.html#a7d648ea6a0eeb70159b54f0cba6602d9">ata_io_finish</a>();</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160; </div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;}</div>
<div class="ttc" id="aatahw_8h_html_a414747b879d890c1df55ccbd4208cf1ca45418419e19eb67ee21985f2c75934ff"><div class="ttname"><a href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca45418419e19eb67ee21985f2c75934ff">ATA_C_STANDBY_IMMEDIATE</a></div><div class="ttdeci">@ ATA_C_STANDBY_IMMEDIATE</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00109">atahw.h:109</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="atahw_8h_source.html#l00109">ATA_C_STANDBY_IMMEDIATE</a>, <a class="el" href="ps2atad_8c_source.html#l00597">ata_io_finish()</a>, <a class="el" href="ps2atad_8c_source.html#l00377">ata_io_start()</a>, and <a class="el" href="defs_8h_source.html#l00022">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l01204">ata_shutdown_cb()</a>.</p>

</div>
</div>
<a id="a57905ac2753d3af573cda8f88ac0539a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57905ac2753d3af573cda8f88ac0539a">&#9670;&nbsp;</a></span>ata_dma_complete()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ata_dma_complete </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tamtypes_8h.html#a2caf5cd7bcdbe1eefa727f44ffb10bac">u32</a>&#160;</td>
          <td class="paramname"><em>blkcount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00544">544</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;{</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <a class="code" href="atahw_8h.html#ab4f7d3947f74abdfbc8b1966edd9c09a">USE_ATA_REGS</a>;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        <a class="code" href="speedregs_8h.html#ae17edfe9beb1af5c9a18069f5346c1b5">USE_SPD_REGS</a>;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        <a class="code" href="tamtypes_8h.html#a2caf5cd7bcdbe1eefa727f44ffb10bac">u32</a> bits, count, nbytes;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        <span class="keywordtype">int</span> i, res;</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <a class="code" href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a> dma_stat;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160; </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        <span class="keywordflow">while</span> (blkcount) {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                <span class="keywordflow">for</span> (i = 0; i &lt; 20; i++)</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                        <span class="keywordflow">if</span> ((dma_stat = <a class="code" href="speedregs_8h.html#a0de0649a772d3a30be4b67b3d222d246">SPD_REG16</a>(0x38) &amp; 0x1f))</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                                <span class="keywordflow">goto</span> next_transfer;</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                <span class="keywordflow">if</span> (dma_stat)</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                        <span class="keywordflow">goto</span> next_transfer;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                <a class="code" href="dev9_8h.html#ad1c8de3a28913ff71b21e007c56f4fe5">dev9IntrEnable</a>(<a class="code" href="speedregs_8h.html#a853892c7a8615923eb381fc48e09c66e">SPD_INTR_ATA</a>);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                <span class="comment">/* Wait for the previous transfer to complete or a timeout.  */</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                <a class="code" href="thevent_8h.html#af02e7c7b01bc0632a2d6dd2c97e66dd0">WaitEventFlag</a>(<a class="code" href="ps2atad_8c.html#a63343d9b3948674c9b63eb02a2848580">ata_evflg</a>, <a class="code" href="ps2atad_8c.html#a50452dedf60a5212bb1fdc34d7bed0c5">ATA_EV_TIMEOUT</a>|<a class="code" href="ps2atad_8c.html#a95a26f0483406276dbed0c5773f71428">ATA_EV_COMPLETE</a>, <a class="code" href="thevent_8h.html#a873b52fb6fbd9fd9f4ac161e00982133">WEF_CLEAR</a>|<a class="code" href="thevent_8h.html#aedd147a4c17e7a6d849f6f4205792a53">WEF_OR</a>, &amp;bits);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                <span class="keywordflow">if</span> (bits &amp; <a class="code" href="ps2atad_8c.html#a50452dedf60a5212bb1fdc34d7bed0c5">ATA_EV_TIMEOUT</a>) {    <span class="comment">/* Timeout.  */</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                        <a class="code" href="ps2atad_8c.html#a1250382de8ce63fd75727fe97bbb8187">M_PRINTF</a>(<span class="stringliteral">&quot;Error: DMA timeout.\n&quot;</span>);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="atad_8h.html#ab61e20397c66cf36c27afaadf2a2d08e">ATA_RES_ERR_TIMEOUT</a>;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                }</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                <span class="comment">/* No DMA completion bit? Spurious interrupt.  */</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                <span class="keywordflow">if</span> (!(<a class="code" href="speedregs_8h.html#a0de0649a772d3a30be4b67b3d222d246">SPD_REG16</a>(<a class="code" href="speedregs_8h.html#a53c267c60f8653ae945a10d4b45e03e6">SPD_R_INTR_STAT</a>) &amp; 0x02)) {</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                        <span class="keywordflow">if</span> (ata_hwport-&gt;r_control &amp; 0x01) {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                                <a class="code" href="ps2atad_8c.html#a1250382de8ce63fd75727fe97bbb8187">M_PRINTF</a>(<span class="stringliteral">&quot;Error: Command error while doing DMA.\n&quot;</span>);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                                <a class="code" href="ps2atad_8c.html#a1250382de8ce63fd75727fe97bbb8187">M_PRINTF</a>(<span class="stringliteral">&quot;Error: Command error status 0x%02x, error 0x%02x.\n&quot;</span>, ata_hwport-&gt;r_status, <a class="code" href="ps2atad_8c.html#abd06b5df0dc5102851a9f035b4397725">ata_get_error</a>());</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                                <span class="comment">/* In v1.04, there was no check for ICRC. */</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                                <span class="keywordflow">return</span>((<a class="code" href="ps2atad_8c.html#abd06b5df0dc5102851a9f035b4397725">ata_get_error</a>() &amp; <a class="code" href="atahw_8h.html#a7181f2d5506b2600a143d509e50d8ca8">ATA_ERR_ICRC</a>) ? <a class="code" href="atad_8h.html#a635f0bfa6a11e9e69a9f3a57f6f603c6">ATA_RES_ERR_ICRC</a> : <a class="code" href="atad_8h.html#a937c8fdec578f257bf7e9cda32d9373e">ATA_RES_ERR_IO</a>);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                                <a class="code" href="ps2atad_8c.html#a1250382de8ce63fd75727fe97bbb8187">M_PRINTF</a>(<span class="stringliteral">&quot;Warning: Got command interrupt, but not an error.\n&quot;</span>);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                        }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                }</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                dma_stat = <a class="code" href="speedregs_8h.html#a0de0649a772d3a30be4b67b3d222d246">SPD_REG16</a>(0x38) &amp; 0x1f;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;next_transfer:</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                count = (blkcount &lt; dma_stat) ? blkcount : dma_stat;</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                nbytes = count * 512;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                <span class="keywordflow">if</span> ((res = <a class="code" href="dev9_8h.html#a2ff5b3f215b8fe11b33ef02580668c41">dev9DmaTransfer</a>(0, buf, (nbytes &lt;&lt; 9)|32, dir)) &lt; 0)</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                        <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                buf = (<span class="keywordtype">void</span>*)((<a class="code" href="tamtypes_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> *)buf + nbytes);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                blkcount -= count;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        }</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;}</div>
<div class="ttc" id="aatad_8h_html_a937c8fdec578f257bf7e9cda32d9373e"><div class="ttname"><a href="atad_8h.html#a937c8fdec578f257bf7e9cda32d9373e">ATA_RES_ERR_IO</a></div><div class="ttdeci">#define ATA_RES_ERR_IO</div><div class="ttdef"><b>Definition:</b> <a href="atad_8h_source.html#l00042">atad.h:42</a></div></div>
<div class="ttc" id="aatad_8h_html_ab61e20397c66cf36c27afaadf2a2d08e"><div class="ttname"><a href="atad_8h.html#ab61e20397c66cf36c27afaadf2a2d08e">ATA_RES_ERR_TIMEOUT</a></div><div class="ttdeci">#define ATA_RES_ERR_TIMEOUT</div><div class="ttdef"><b>Definition:</b> <a href="atad_8h_source.html#l00041">atad.h:41</a></div></div>
<div class="ttc" id="aatahw_8h_html_a7181f2d5506b2600a143d509e50d8ca8"><div class="ttname"><a href="atahw_8h.html#a7181f2d5506b2600a143d509e50d8ca8">ATA_ERR_ICRC</a></div><div class="ttdeci">#define ATA_ERR_ICRC</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00057">atahw.h:57</a></div></div>
<div class="ttc" id="adev9_8h_html_a2ff5b3f215b8fe11b33ef02580668c41"><div class="ttname"><a href="dev9_8h.html#a2ff5b3f215b8fe11b33ef02580668c41">dev9DmaTransfer</a></div><div class="ttdeci">int dev9DmaTransfer(int ctrl, void *buf, int bcr, int dir)</div><div class="ttdef"><b>Definition:</b> <a href="ps2dev9_8c_source.html#l00394">ps2dev9.c:394</a></div></div>
<div class="ttc" id="adev9_8h_html_ad1c8de3a28913ff71b21e007c56f4fe5"><div class="ttname"><a href="dev9_8h.html#ad1c8de3a28913ff71b21e007c56f4fe5">dev9IntrEnable</a></div><div class="ttdeci">void dev9IntrEnable(int mask)</div><div class="ttdef"><b>Definition:</b> <a href="ps2dev9_8c_source.html#l00372">ps2dev9.c:372</a></div></div>
<div class="ttc" id="aps2atad_8c_html_a95a26f0483406276dbed0c5773f71428"><div class="ttname"><a href="ps2atad_8c.html#a95a26f0483406276dbed0c5773f71428">ATA_EV_COMPLETE</a></div><div class="ttdeci">#define ATA_EV_COMPLETE</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00052">ps2atad.c:52</a></div></div>
<div class="ttc" id="aps2atad_8c_html_abd06b5df0dc5102851a9f035b4397725"><div class="ttname"><a href="ps2atad_8c.html#abd06b5df0dc5102851a9f035b4397725">ata_get_error</a></div><div class="ttdeci">int ata_get_error(void)</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00297">ps2atad.c:297</a></div></div>
<div class="ttc" id="aspeedregs_8h_html_a53c267c60f8653ae945a10d4b45e03e6"><div class="ttname"><a href="speedregs_8h.html#a53c267c60f8653ae945a10d4b45e03e6">SPD_R_INTR_STAT</a></div><div class="ttdeci">#define SPD_R_INTR_STAT</div><div class="ttdef"><b>Definition:</b> <a href="speedregs_8h_source.html#l00044">speedregs.h:44</a></div></div>
<div class="ttc" id="aspeedregs_8h_html_a853892c7a8615923eb381fc48e09c66e"><div class="ttname"><a href="speedregs_8h.html#a853892c7a8615923eb381fc48e09c66e">SPD_INTR_ATA</a></div><div class="ttdeci">#define SPD_INTR_ATA</div><div class="ttdef"><b>Definition:</b> <a href="speedregs_8h_source.html#l00048">speedregs.h:48</a></div></div>
<div class="ttc" id="atamtypes_8h_html_a2caf5cd7bcdbe1eefa727f44ffb10bac"><div class="ttname"><a href="tamtypes_8h.html#a2caf5cd7bcdbe1eefa727f44ffb10bac">u32</a></div><div class="ttdeci">unsigned long u32</div><div class="ttdef"><b>Definition:</b> <a href="tamtypes_8h_source.html#l00044">tamtypes.h:44</a></div></div>
<div class="ttc" id="athevent_8h_html_a873b52fb6fbd9fd9f4ac161e00982133"><div class="ttname"><a href="thevent_8h.html#a873b52fb6fbd9fd9f4ac161e00982133">WEF_CLEAR</a></div><div class="ttdeci">#define WEF_CLEAR</div><div class="ttdef"><b>Definition:</b> <a href="thevent_8h_source.html#l00025">thevent.h:25</a></div></div>
<div class="ttc" id="athevent_8h_html_aedd147a4c17e7a6d849f6f4205792a53"><div class="ttname"><a href="thevent_8h.html#aedd147a4c17e7a6d849f6f4205792a53">WEF_OR</a></div><div class="ttdeci">#define WEF_OR</div><div class="ttdef"><b>Definition:</b> <a href="thevent_8h_source.html#l00024">thevent.h:24</a></div></div>
<div class="ttc" id="athevent_8h_html_af02e7c7b01bc0632a2d6dd2c97e66dd0"><div class="ttname"><a href="thevent_8h.html#af02e7c7b01bc0632a2d6dd2c97e66dd0">WaitEventFlag</a></div><div class="ttdeci">int WaitEventFlag(int ef, u32 bits, int mode, u32 *resbits)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="atahw_8h_source.html#l00057">ATA_ERR_ICRC</a>, <a class="el" href="ps2atad_8c_source.html#l00052">ATA_EV_COMPLETE</a>, <a class="el" href="ps2atad_8c_source.html#l00051">ATA_EV_TIMEOUT</a>, <a class="el" href="ps2atad_8c_source.html#l00055">ata_evflg</a>, <a class="el" href="ps2atad_8c_source.html#l00297">ata_get_error()</a>, <a class="el" href="atad_8h_source.html#l00047">ATA_RES_ERR_ICRC</a>, <a class="el" href="atad_8h_source.html#l00042">ATA_RES_ERR_IO</a>, <a class="el" href="atad_8h_source.html#l00041">ATA_RES_ERR_TIMEOUT</a>, <a class="el" href="ps2dev9_8c_source.html#l00394">dev9DmaTransfer()</a>, <a class="el" href="ps2dev9_8c_source.html#l00372">dev9IntrEnable()</a>, <a class="el" href="ps2atad_8c_source.html#l00039">M_PRINTF</a>, <a class="el" href="speedregs_8h_source.html#l00048">SPD_INTR_ATA</a>, <a class="el" href="speedregs_8h_source.html#l00044">SPD_R_INTR_STAT</a>, <a class="el" href="speedregs_8h_source.html#l00030">SPD_REG16</a>, <a class="el" href="atahw_8h_source.html#l00043">USE_ATA_REGS</a>, <a class="el" href="speedregs_8h_source.html#l00027">USE_SPD_REGS</a>, <a class="el" href="thevent_8h.html#af02e7c7b01bc0632a2d6dd2c97e66dd0">WaitEventFlag()</a>, <a class="el" href="thevent_8h_source.html#l00025">WEF_CLEAR</a>, and <a class="el" href="thevent_8h_source.html#l00024">WEF_OR</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00597">ata_io_finish()</a>.</p>

</div>
</div>
<a id="a2f939bc4c7eb60ded290e298dea8a835"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f939bc4c7eb60ded290e298dea8a835">&#9670;&nbsp;</a></span>ata_get_devinfo()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structata__devinfo__t.html">ata_devinfo_t</a>* ata_get_devinfo </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>device</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l01080">1080</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;{</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        <span class="keywordflow">if</span>(!<a class="code" href="ps2atad_8c.html#a36d5160a12b758a05b46552665fa0420">ata_devinfo_init</a>){</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                <a class="code" href="ps2atad_8c.html#a36d5160a12b758a05b46552665fa0420">ata_devinfo_init</a> = 1;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="ps2atad_8c.html#a6bd0b23d7e3ae5bba9abb6e2852d0218">ata_bus_reset</a>() || <a class="code" href="ps2atad_8c.html#a4a2d7a85814d91e05d924243b95bb68a">ata_init_devices</a>(<a class="code" href="ps2atad_8c.html#ac2dd933f6c797949159ee6ab90e86f53">atad_devinfo</a>)) <span class="keywordflow">return</span> <a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        }</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160; </div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        <span class="keywordflow">return</span> &amp;<a class="code" href="ps2atad_8c.html#ac2dd933f6c797949159ee6ab90e86f53">atad_devinfo</a>[device];</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;}</div>
<div class="ttc" id="aps2atad_8c_html_a36d5160a12b758a05b46552665fa0420"><div class="ttname"><a href="ps2atad_8c.html#a36d5160a12b758a05b46552665fa0420">ata_devinfo_init</a></div><div class="ttdeci">static int ata_devinfo_init</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00054">ps2atad.c:54</a></div></div>
<div class="ttc" id="aps2atad_8c_html_a4a2d7a85814d91e05d924243b95bb68a"><div class="ttname"><a href="ps2atad_8c.html#a4a2d7a85814d91e05d924243b95bb68a">ata_init_devices</a></div><div class="ttdeci">static int ata_init_devices(ata_devinfo_t *devinfo)</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00995">ps2atad.c:995</a></div></div>
<div class="ttc" id="aps2atad_8c_html_a6bd0b23d7e3ae5bba9abb6e2852d0218"><div class="ttname"><a href="ps2atad_8c.html#a6bd0b23d7e3ae5bba9abb6e2852d0218">ata_bus_reset</a></div><div class="ttdeci">static int ata_bus_reset(void)</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00668">ps2atad.c:668</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abd06b5df0dc5102851a9f035b4397725"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abd06b5df0dc5102851a9f035b4397725">&#9670;&nbsp;</a></span>ata_get_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ata_get_error </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00297">297</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;{</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <a class="code" href="atahw_8h.html#ab4f7d3947f74abdfbc8b1966edd9c09a">USE_ATA_REGS</a>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordflow">return</span> ata_hwport-&gt;r_error &amp; 0xff;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00544">ata_dma_complete()</a>, <a class="el" href="ps2atad_8c_source.html#l00597">ata_io_finish()</a>, and <a class="el" href="ps2atad_8c_source.html#l00498">ata_pio_transfer()</a>.</p>

</div>
</div>
<a id="a048c448fc8c924064d004dc320230780"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a048c448fc8c924064d004dc320230780">&#9670;&nbsp;</a></span>ata_get_security_status()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ata_get_security_status </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>device</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structata__devinfo__t.html">ata_devinfo_t</a> *&#160;</td>
          <td class="paramname"><em>devinfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a> *&#160;</td>
          <td class="paramname"><em>param</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00885">885</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;{</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="ps2atad_8c.html#a74641792cccc14f3a6c8676374c414cd">ata_device_identify</a>(device, param) == 0)</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                devinfo[device].<a class="code" href="structata__devinfo__t.html#a1770da52385978a37854b21288e5761f">security_status</a> = param[<a class="code" href="atahw_8h.html#ac8459f2d6b479b57eb1e4ae21139fac9aaa7eff99416c111ddb58d621c335d908">ATA_ID_SECURITY_STATUS</a>];</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;}</div>
<div class="ttc" id="aatahw_8h_html_ac8459f2d6b479b57eb1e4ae21139fac9aaa7eff99416c111ddb58d621c335d908"><div class="ttname"><a href="atahw_8h.html#ac8459f2d6b479b57eb1e4ae21139fac9aaa7eff99416c111ddb58d621c335d908">ATA_ID_SECURITY_STATUS</a></div><div class="ttdeci">@ ATA_ID_SECURITY_STATUS</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00165">atahw.h:164</a></div></div>
<div class="ttc" id="aps2atad_8c_html_a74641792cccc14f3a6c8676374c414cd"><div class="ttname"><a href="ps2atad_8c.html#a74641792cccc14f3a6c8676374c414cd">ata_device_identify</a></div><div class="ttdeci">static int ata_device_identify(int device, void *info)</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00718">ps2atad.c:718</a></div></div>
<div class="ttc" id="astructata__devinfo__t_html_a1770da52385978a37854b21288e5761f"><div class="ttname"><a href="structata__devinfo__t.html#a1770da52385978a37854b21288e5761f">ata_devinfo_t::security_status</a></div><div class="ttdeci">u32 security_status</div><div class="ttdef"><b>Definition:</b> <a href="atad_8h_source.html#l00034">atad.h:34</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ps2atad_8c_source.html#l00718">ata_device_identify()</a>, <a class="el" href="atahw_8h_source.html#l00164">ATA_ID_SECURITY_STATUS</a>, and <a class="el" href="atad_8h_source.html#l00034">ata_devinfo_t::security_status</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00937">ata_device_sce_sec_erase()</a>, <a class="el" href="ps2atad_8c_source.html#l00892">ata_device_sce_sec_set_password()</a>, and <a class="el" href="ps2atad_8c_source.html#l00912">ata_device_sce_sec_unlock()</a>.</p>

</div>
</div>
<a id="a4a2d7a85814d91e05d924243b95bb68a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a2d7a85814d91e05d924243b95bb68a">&#9670;&nbsp;</a></span>ata_init_devices()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ata_init_devices </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structata__devinfo__t.html">ata_devinfo_t</a> *&#160;</td>
          <td class="paramname"><em>devinfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00995">995</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;{</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;        <a class="code" href="atahw_8h.html#ab4f7d3947f74abdfbc8b1966edd9c09a">USE_ATA_REGS</a>;</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        <span class="keywordtype">int</span> i, res;</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160; </div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        <span class="keywordflow">if</span>((res = <a class="code" href="ps2atad_8c.html#ab0d320995c13d10d7e0dfeb2928d8adf">ata_reset_devices</a>()) != 0)</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;                <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160; </div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        <a class="code" href="ps2atad_8c.html#a7219d59eb0dda86631c77e5b13eee187">ata_device_probe</a>(&amp;devinfo[0]);</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        <span class="keywordflow">if</span> (!devinfo[0].exists) {</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;                <a class="code" href="ps2atad_8c.html#a1250382de8ce63fd75727fe97bbb8187">M_PRINTF</a>(<span class="stringliteral">&quot;Error: Unable to detect HDD 0.\n&quot;</span>);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                devinfo[1].<a class="code" href="structata__devinfo__t.html#a24e2e6b5ba4ac8e8bf7e1adfb04e3c2a">exists</a> = 0;</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="atad_8h.html#ab3a33c096c7d8071d89cafe6881587b6">ATA_RES_ERR_NODEV</a>;       <span class="comment">//Returns 0 in v1.04.</span></div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        }</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160; </div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        <span class="comment">/* If there is a device 1, grab it&#39;s info too.  */</span></div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        <span class="keywordflow">if</span> ((res = <a class="code" href="ps2atad_8c.html#afa869626ecb5359525c66f68b8fd44f3">ata_device_select</a>(1)) != 0)</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;                <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        <span class="keywordflow">if</span> (ata_hwport-&gt;r_control &amp; 0xff)</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;                <a class="code" href="ps2atad_8c.html#a7219d59eb0dda86631c77e5b13eee187">ata_device_probe</a>(&amp;devinfo[1]);</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                devinfo[1].<a class="code" href="structata__devinfo__t.html#a24e2e6b5ba4ac8e8bf7e1adfb04e3c2a">exists</a> = 0;</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160; </div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;        <a class="code" href="ps2atad_8c.html#a9a34bad4a0850d3cf877949bdaf78218">ata_pio_mode</a>(0);        <span class="comment">//PIO mode is set here, in late ATAD versions.</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160; </div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++) {</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;                <span class="keywordflow">if</span> (!devinfo[i].exists)</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160; </div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                <span class="comment">/* Send the IDENTIFY DEVICE command. if it doesn&#39;t succeed</span></div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="comment">                   devinfo is disabled.  */</span></div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                <span class="keywordflow">if</span> (!devinfo[i].has_packet) {</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                        res = <a class="code" href="ps2atad_8c.html#a74641792cccc14f3a6c8676374c414cd">ata_device_identify</a>(i, <a class="code" href="ps2atad_8c.html#ad7e4a242bab16217e288f17efa109daf">ata_param</a>);</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                        devinfo[i].<a class="code" href="structata__devinfo__t.html#a24e2e6b5ba4ac8e8bf7e1adfb04e3c2a">exists</a> = (res == 0);</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (devinfo[i].has_packet == 1) {</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                        <span class="comment">/* If it&#39;s a packet device, send the IDENTIFY PACKET</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment">                           DEVICE command.  */</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                        res = <a class="code" href="ps2atad_8c.html#a5b3ec1d0aeda2b32dc5dd7635cecf77b">ata_device_pkt_identify</a>(i, <a class="code" href="ps2atad_8c.html#ad7e4a242bab16217e288f17efa109daf">ata_param</a>);</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                        devinfo[i].<a class="code" href="structata__devinfo__t.html#a24e2e6b5ba4ac8e8bf7e1adfb04e3c2a">exists</a> = (res == 0);</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                }</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                <span class="comment">/* Otherwise, do nothing if has_packet = 2. */</span></div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160; </div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                <span class="comment">/* This next section is HDD-specific: if no device or it&#39;s a</span></div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment">                   packet (ATAPI) device, we&#39;re done.  */</span></div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                <span class="keywordflow">if</span> (!devinfo[i].exists || devinfo[i].has_packet)</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160; </div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                <span class="comment">/* This section is to detect whether the HDD supports 48-bit LBA</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment">                   (IDENITFY DEVICE bit 10 word 83) and get the total sectors from</span></div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment">                   either words(61:60) for 28-bit or words(103:100) for 48-bit.  */</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                <span class="keywordflow">if</span> (!<a class="code" href="ps2atad_8c.html#acd506af8f0da0f60a2b367a78964b8b2">ata_disable_lba48</a> &amp;&amp; (<a class="code" href="ps2atad_8c.html#ad7e4a242bab16217e288f17efa109daf">ata_param</a>[<a class="code" href="atahw_8h.html#ac8459f2d6b479b57eb1e4ae21139fac9a9bda691deb86e55822ed1906cb481d13">ATA_ID_COMMAND_SETS_SUPPORTED</a>] &amp; 0x0400)) {</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                        devinfo[i].<a class="code" href="structata__devinfo__t.html#a4017f2b089aea9f05d52e8e076ec6c1c">lba48</a> = 1;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                        <span class="comment">/* I don&#39;t think anyone would use a &gt;2TB HDD but just in case.  */</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="ps2atad_8c.html#ad7e4a242bab16217e288f17efa109daf">ata_param</a>[<a class="code" href="atahw_8h.html#ac8459f2d6b479b57eb1e4ae21139fac9a6e84835bb493baffd12a0118f9aec6a0">ATA_ID_48BIT_SECTOTAL_HI</a>]) {</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                                devinfo[i].<a class="code" href="structata__devinfo__t.html#a769f21c4602ac7864da87741a01e9373">total_sectors</a> = 0xffffffff;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                                devinfo[i].<a class="code" href="structata__devinfo__t.html#a769f21c4602ac7864da87741a01e9373">total_sectors</a> =</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                                        (<a class="code" href="ps2atad_8c.html#ad7e4a242bab16217e288f17efa109daf">ata_param</a>[<a class="code" href="atahw_8h.html#ac8459f2d6b479b57eb1e4ae21139fac9ae37e87a5a80e2070fbcdd7b1e1e01dbd">ATA_ID_48BIT_SECTOTAL_MI</a>] &lt;&lt; 16)|</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                                        <a class="code" href="ps2atad_8c.html#ad7e4a242bab16217e288f17efa109daf">ata_param</a>[<a class="code" href="atahw_8h.html#ac8459f2d6b479b57eb1e4ae21139fac9ad5914db7185a9b1f5b27a322f5543e34">ATA_ID_48BIT_SECTOTAL_LO</a>];</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                        }</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                        devinfo[i].<a class="code" href="structata__devinfo__t.html#a4017f2b089aea9f05d52e8e076ec6c1c">lba48</a> = 0;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                        devinfo[i].<a class="code" href="structata__devinfo__t.html#a769f21c4602ac7864da87741a01e9373">total_sectors</a> = (<a class="code" href="ps2atad_8c.html#ad7e4a242bab16217e288f17efa109daf">ata_param</a>[<a class="code" href="atahw_8h.html#ac8459f2d6b479b57eb1e4ae21139fac9a1025d845a1556f644b25d26354262492">ATA_ID_SECTOTAL_HI</a>] &lt;&lt; 16)|</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                                <a class="code" href="ps2atad_8c.html#ad7e4a242bab16217e288f17efa109daf">ata_param</a>[<a class="code" href="atahw_8h.html#ac8459f2d6b479b57eb1e4ae21139fac9a213fd710af71eb3ff0c2fd9def67f551">ATA_ID_SECTOTAL_LO</a>];</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                }</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                devinfo[i].<a class="code" href="structata__devinfo__t.html#a1770da52385978a37854b21288e5761f">security_status</a> = <a class="code" href="ps2atad_8c.html#ad7e4a242bab16217e288f17efa109daf">ata_param</a>[<a class="code" href="atahw_8h.html#ac8459f2d6b479b57eb1e4ae21139fac9aaa7eff99416c111ddb58d621c335d908">ATA_ID_SECURITY_STATUS</a>];</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160; </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;                <span class="comment">/* Ultra DMA mode 4.  */</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;                <a class="code" href="ps2atad_8c.html#a1834dc226e9b1f884dc42d1a51dc6fc1">ata_device_set_transfer_mode</a>(i, <a class="code" href="ps2atad_8c.html#a14fe84248abb890fc60fe8f15a1b4a81">ATA_XFER_MODE_UDMA</a>, 4);</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;                <a class="code" href="ps2atad_8c.html#a11c2db58d257d48f25a26a963e8bc698">ata_device_smart_enable</a>(i);</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                <span class="comment">/* Set standby timer to 21min 15s.  */</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                <a class="code" href="ps2atad_8c.html#ad5fe2ce0f6c8ff1c2af5faaac8bc20a9">ata_device_idle</a>(i, 0xff);</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160; </div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                <span class="comment">/* Call the proprietary identify command. */</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="preprocessor">#ifdef ATA_SCE_AUTH_HDD</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="ps2atad_8c.html#aa14172e73d2398ff898353839aef7d21">ata_device_sce_identify_drive</a>(i, <a class="code" href="ps2atad_8c.html#ad7e4a242bab16217e288f17efa109daf">ata_param</a>) != 0) {</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                        <a class="code" href="ps2atad_8c.html#a1250382de8ce63fd75727fe97bbb8187">M_PRINTF</a>(<span class="stringliteral">&quot;error: This is not SCE genuine HDD.\n&quot;</span>);</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                        <a class="code" href="sysclib_8h.html#ab8dce9c192324f0fd191fd5b85c7bb60">memset</a>(&amp;devinfo[i], 0, <span class="keyword">sizeof</span>(devinfo[i]));</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                }</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;        }</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;}</div>
<div class="ttc" id="aatad_8h_html_ab3a33c096c7d8071d89cafe6881587b6"><div class="ttname"><a href="atad_8h.html#ab3a33c096c7d8071d89cafe6881587b6">ATA_RES_ERR_NODEV</a></div><div class="ttdeci">#define ATA_RES_ERR_NODEV</div><div class="ttdef"><b>Definition:</b> <a href="atad_8h_source.html#l00044">atad.h:44</a></div></div>
<div class="ttc" id="aatahw_8h_html_ac8459f2d6b479b57eb1e4ae21139fac9a1025d845a1556f644b25d26354262492"><div class="ttname"><a href="atahw_8h.html#ac8459f2d6b479b57eb1e4ae21139fac9a1025d845a1556f644b25d26354262492">ATA_ID_SECTOTAL_HI</a></div><div class="ttdeci">@ ATA_ID_SECTOTAL_HI</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00161">atahw.h:161</a></div></div>
<div class="ttc" id="aatahw_8h_html_ac8459f2d6b479b57eb1e4ae21139fac9a213fd710af71eb3ff0c2fd9def67f551"><div class="ttname"><a href="atahw_8h.html#ac8459f2d6b479b57eb1e4ae21139fac9a213fd710af71eb3ff0c2fd9def67f551">ATA_ID_SECTOTAL_LO</a></div><div class="ttdeci">@ ATA_ID_SECTOTAL_LO</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00161">atahw.h:161</a></div></div>
<div class="ttc" id="aatahw_8h_html_ac8459f2d6b479b57eb1e4ae21139fac9a6e84835bb493baffd12a0118f9aec6a0"><div class="ttname"><a href="atahw_8h.html#ac8459f2d6b479b57eb1e4ae21139fac9a6e84835bb493baffd12a0118f9aec6a0">ATA_ID_48BIT_SECTOTAL_HI</a></div><div class="ttdeci">@ ATA_ID_48BIT_SECTOTAL_HI</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00163">atahw.h:163</a></div></div>
<div class="ttc" id="aatahw_8h_html_ac8459f2d6b479b57eb1e4ae21139fac9a9bda691deb86e55822ed1906cb481d13"><div class="ttname"><a href="atahw_8h.html#ac8459f2d6b479b57eb1e4ae21139fac9a9bda691deb86e55822ed1906cb481d13">ATA_ID_COMMAND_SETS_SUPPORTED</a></div><div class="ttdeci">@ ATA_ID_COMMAND_SETS_SUPPORTED</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00162">atahw.h:162</a></div></div>
<div class="ttc" id="aatahw_8h_html_ac8459f2d6b479b57eb1e4ae21139fac9ad5914db7185a9b1f5b27a322f5543e34"><div class="ttname"><a href="atahw_8h.html#ac8459f2d6b479b57eb1e4ae21139fac9ad5914db7185a9b1f5b27a322f5543e34">ATA_ID_48BIT_SECTOTAL_LO</a></div><div class="ttdeci">@ ATA_ID_48BIT_SECTOTAL_LO</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00163">atahw.h:163</a></div></div>
<div class="ttc" id="aatahw_8h_html_ac8459f2d6b479b57eb1e4ae21139fac9ae37e87a5a80e2070fbcdd7b1e1e01dbd"><div class="ttname"><a href="atahw_8h.html#ac8459f2d6b479b57eb1e4ae21139fac9ae37e87a5a80e2070fbcdd7b1e1e01dbd">ATA_ID_48BIT_SECTOTAL_MI</a></div><div class="ttdeci">@ ATA_ID_48BIT_SECTOTAL_MI</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00163">atahw.h:163</a></div></div>
<div class="ttc" id="aps2atad_8c_html_a11c2db58d257d48f25a26a963e8bc698"><div class="ttname"><a href="ps2atad_8c.html#a11c2db58d257d48f25a26a963e8bc698">ata_device_smart_enable</a></div><div class="ttdeci">static int ata_device_smart_enable(int device)</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00747">ps2atad.c:747</a></div></div>
<div class="ttc" id="aps2atad_8c_html_a1834dc226e9b1f884dc42d1a51dc6fc1"><div class="ttname"><a href="ps2atad_8c.html#a1834dc226e9b1f884dc42d1a51dc6fc1">ata_device_set_transfer_mode</a></div><div class="ttdeci">static int ata_device_set_transfer_mode(int device, int type, int mode)</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00790">ps2atad.c:790</a></div></div>
<div class="ttc" id="aps2atad_8c_html_a5b3ec1d0aeda2b32dc5dd7635cecf77b"><div class="ttname"><a href="ps2atad_8c.html#a5b3ec1d0aeda2b32dc5dd7635cecf77b">ata_device_pkt_identify</a></div><div class="ttdeci">static int ata_device_pkt_identify(int device, void *info)</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00727">ps2atad.c:727</a></div></div>
<div class="ttc" id="aps2atad_8c_html_a7219d59eb0dda86631c77e5b13eee187"><div class="ttname"><a href="ps2atad_8c.html#a7219d59eb0dda86631c77e5b13eee187">ata_device_probe</a></div><div class="ttdeci">static void ata_device_probe(ata_devinfo_t *devinfo)</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00958">ps2atad.c:958</a></div></div>
<div class="ttc" id="aps2atad_8c_html_aa14172e73d2398ff898353839aef7d21"><div class="ttname"><a href="ps2atad_8c.html#aa14172e73d2398ff898353839aef7d21">ata_device_sce_identify_drive</a></div><div class="ttdeci">int ata_device_sce_identify_drive(int device, void *data)</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00738">ps2atad.c:738</a></div></div>
<div class="ttc" id="aps2atad_8c_html_ab0d320995c13d10d7e0dfeb2928d8adf"><div class="ttname"><a href="ps2atad_8c.html#ab0d320995c13d10d7e0dfeb2928d8adf">ata_reset_devices</a></div><div class="ttdeci">int ata_reset_devices(void)</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00680">ps2atad.c:680</a></div></div>
<div class="ttc" id="aps2atad_8c_html_ad5fe2ce0f6c8ff1c2af5faaac8bc20a9"><div class="ttname"><a href="ps2atad_8c.html#ad5fe2ce0f6c8ff1c2af5faaac8bc20a9">ata_device_idle</a></div><div class="ttdeci">int ata_device_idle(int device, int period)</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00709">ps2atad.c:709</a></div></div>
<div class="ttc" id="aps2atad_8c_html_afa869626ecb5359525c66f68b8fd44f3"><div class="ttname"><a href="ps2atad_8c.html#afa869626ecb5359525c66f68b8fd44f3">ata_device_select</a></div><div class="ttdeci">static int ata_device_select(int device)</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00347">ps2atad.c:347</a></div></div>
<div class="ttc" id="astructata__devinfo__t_html_a4017f2b089aea9f05d52e8e076ec6c1c"><div class="ttname"><a href="structata__devinfo__t.html#a4017f2b089aea9f05d52e8e076ec6c1c">ata_devinfo_t::lba48</a></div><div class="ttdeci">u32 lba48</div><div class="ttdef"><b>Definition:</b> <a href="atad_8h_source.html#l00036">atad.h:36</a></div></div>
<div class="ttc" id="astructata__devinfo__t_html_a769f21c4602ac7864da87741a01e9373"><div class="ttname"><a href="structata__devinfo__t.html#a769f21c4602ac7864da87741a01e9373">ata_devinfo_t::total_sectors</a></div><div class="ttdeci">u32 total_sectors</div><div class="ttdef"><b>Definition:</b> <a href="atad_8h_source.html#l00032">atad.h:32</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ps2atad_8c_source.html#l00718">ata_device_identify()</a>, <a class="el" href="ps2atad_8c_source.html#l00709">ata_device_idle()</a>, <a class="el" href="ps2atad_8c_source.html#l00727">ata_device_pkt_identify()</a>, <a class="el" href="ps2atad_8c_source.html#l00958">ata_device_probe()</a>, <a class="el" href="ps2atad_8c_source.html#l00738">ata_device_sce_identify_drive()</a>, <a class="el" href="ps2atad_8c_source.html#l00347">ata_device_select()</a>, <a class="el" href="ps2atad_8c_source.html#l00790">ata_device_set_transfer_mode()</a>, <a class="el" href="ps2atad_8c_source.html#l00747">ata_device_smart_enable()</a>, <a class="el" href="ps2atad_8c_source.html#l00058">ata_disable_lba48</a>, <a class="el" href="atahw_8h_source.html#l00163">ATA_ID_48BIT_SECTOTAL_HI</a>, <a class="el" href="atahw_8h_source.html#l00163">ATA_ID_48BIT_SECTOTAL_LO</a>, <a class="el" href="atahw_8h_source.html#l00163">ATA_ID_48BIT_SECTOTAL_MI</a>, <a class="el" href="atahw_8h_source.html#l00162">ATA_ID_COMMAND_SETS_SUPPORTED</a>, <a class="el" href="atahw_8h_source.html#l00161">ATA_ID_SECTOTAL_HI</a>, <a class="el" href="atahw_8h_source.html#l00161">ATA_ID_SECTOTAL_LO</a>, <a class="el" href="atahw_8h_source.html#l00164">ATA_ID_SECURITY_STATUS</a>, <a class="el" href="ps2atad_8c_source.html#l00068">ata_param</a>, <a class="el" href="ps2atad_8c_source.html#l01106">ata_pio_mode()</a>, <a class="el" href="atad_8h_source.html#l00044">ATA_RES_ERR_NODEV</a>, <a class="el" href="ps2atad_8c_source.html#l00680">ata_reset_devices()</a>, <a class="el" href="ps2atad_8c_source.html#l00049">ATA_XFER_MODE_UDMA</a>, <a class="el" href="atad_8h_source.html#l00028">ata_devinfo_t::exists</a>, <a class="el" href="atad_8h_source.html#l00036">ata_devinfo_t::lba48</a>, <a class="el" href="ps2atad_8c_source.html#l00039">M_PRINTF</a>, <a class="el" href="sysclib_8h.html#ab8dce9c192324f0fd191fd5b85c7bb60">memset()</a>, <a class="el" href="atad_8h_source.html#l00034">ata_devinfo_t::security_status</a>, <a class="el" href="atad_8h_source.html#l00032">ata_devinfo_t::total_sectors</a>, and <a class="el" href="atahw_8h_source.html#l00043">USE_ATA_REGS</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l01080">ata_get_devinfo()</a>.</p>

</div>
</div>
<a id="af0b1d184a9a3e735ede5bd8ad5ccdc22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0b1d184a9a3e735ede5bd8ad5ccdc22">&#9670;&nbsp;</a></span>ata_intr_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ata_intr_cb </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flag</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00278">278</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;{</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="keywordflow">if</span> (flag == 1) {        <span class="comment">/* New card, invalidate device info.  */</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                <a class="code" href="sysclib_8h.html#ab8dce9c192324f0fd191fd5b85c7bb60">memset</a>(<a class="code" href="ps2atad_8c.html#ac2dd933f6c797949159ee6ab90e86f53">atad_devinfo</a>, 0, <span class="keyword">sizeof</span> <a class="code" href="ps2atad_8c.html#ac2dd933f6c797949159ee6ab90e86f53">atad_devinfo</a>);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                <a class="code" href="dev9_8h.html#a09633fb309863fd15c843660290818ae">dev9IntrDisable</a>(<a class="code" href="speedregs_8h.html#a853892c7a8615923eb381fc48e09c66e">SPD_INTR_ATA</a>);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                <a class="code" href="thevent_8h.html#afe53563813c02526e55496e4153441a8">iSetEventFlag</a>(<a class="code" href="ps2atad_8c.html#a63343d9b3948674c9b63eb02a2848580">ata_evflg</a>, <a class="code" href="ps2atad_8c.html#a95a26f0483406276dbed0c5773f71428">ATA_EV_COMPLETE</a>);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        }</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;}</div>
<div class="ttc" id="adev9_8h_html_a09633fb309863fd15c843660290818ae"><div class="ttname"><a href="dev9_8h.html#a09633fb309863fd15c843660290818ae">dev9IntrDisable</a></div><div class="ttdeci">void dev9IntrDisable(int mask)</div><div class="ttdef"><b>Definition:</b> <a href="ps2dev9_8c_source.html#l00383">ps2dev9.c:383</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ps2atad_8c_source.html#l00052">ATA_EV_COMPLETE</a>, <a class="el" href="ps2atad_8c_source.html#l00055">ata_evflg</a>, <a class="el" href="ps2atad_8c_source.html#l00064">atad_devinfo</a>, <a class="el" href="ps2dev9_8c_source.html#l00383">dev9IntrDisable()</a>, <a class="el" href="thevent_8h.html#afe53563813c02526e55496e4153441a8">iSetEventFlag()</a>, <a class="el" href="sysclib_8h.html#ab8dce9c192324f0fd191fd5b85c7bb60">memset()</a>, and <a class="el" href="speedregs_8h_source.html#l00048">SPD_INTR_ATA</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00207">_start()</a>.</p>

</div>
</div>
<a id="a7d648ea6a0eeb70159b54f0cba6602d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d648ea6a0eeb70159b54f0cba6602d9">&#9670;&nbsp;</a></span>ata_io_finish()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ata_io_finish </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00597">597</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;{</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <a class="code" href="speedregs_8h.html#ae17edfe9beb1af5c9a18069f5346c1b5">USE_SPD_REGS</a>;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <a class="code" href="atahw_8h.html#ab4f7d3947f74abdfbc8b1966edd9c09a">USE_ATA_REGS</a>;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <a class="code" href="structata__cmd__state__t.html">ata_cmd_state_t</a> *cmd_state = &amp;<a class="code" href="ps2atad_8c.html#a4150d69c3e790e1f2996abf107cb3eb5">atad_cmd_state</a>;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        <a class="code" href="tamtypes_8h.html#a2caf5cd7bcdbe1eefa727f44ffb10bac">u32</a> bits;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        <span class="keywordtype">int</span> i, res = 0, type = cmd_state-&gt;<a class="code" href="structata__cmd__state__t.html#afb09c69541d7ce3970259a19e18b4d79">type</a>;</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        <a class="code" href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a> stat;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="keywordflow">if</span> (type == 1 || type == 6) {   <span class="comment">/* Non-data commands.  */</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                <a class="code" href="thevent_8h.html#af02e7c7b01bc0632a2d6dd2c97e66dd0">WaitEventFlag</a>(<a class="code" href="ps2atad_8c.html#a63343d9b3948674c9b63eb02a2848580">ata_evflg</a>, <a class="code" href="ps2atad_8c.html#a50452dedf60a5212bb1fdc34d7bed0c5">ATA_EV_TIMEOUT</a>|<a class="code" href="ps2atad_8c.html#a95a26f0483406276dbed0c5773f71428">ATA_EV_COMPLETE</a>, <a class="code" href="thevent_8h.html#a873b52fb6fbd9fd9f4ac161e00982133">WEF_CLEAR</a>|<a class="code" href="thevent_8h.html#aedd147a4c17e7a6d849f6f4205792a53">WEF_OR</a>, &amp;bits);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                <span class="keywordflow">if</span> (bits &amp; <a class="code" href="ps2atad_8c.html#a50452dedf60a5212bb1fdc34d7bed0c5">ATA_EV_TIMEOUT</a>) {    <span class="comment">/* Timeout.  */</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                        <a class="code" href="ps2atad_8c.html#a1250382de8ce63fd75727fe97bbb8187">M_PRINTF</a>(<span class="stringliteral">&quot;Error: ATA timeout on a non-data command.\n&quot;</span>);</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="atad_8h.html#ab61e20397c66cf36c27afaadf2a2d08e">ATA_RES_ERR_TIMEOUT</a>;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                }</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == 4) {         <span class="comment">/* DMA.  */</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                <span class="keywordflow">if</span> ((res = <a class="code" href="ps2atad_8c.html#a57905ac2753d3af573cda8f88ac0539a">ata_dma_complete</a>(cmd_state-&gt;<a class="code" href="structata__cmd__state__t.html#a31bd0df24fb3aef7cec7ddad90e4429f">buf</a>, cmd_state-&gt;<a class="code" href="structata__cmd__state__t.html#a19b9a666d11d13af9aaa9a839b23df8d">blkcount</a>,</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                                                cmd_state-&gt;<a class="code" href="structata__cmd__state__t.html#a66651527eebb4246c375a918a8c91867">dir</a>)) &lt; 0)</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                        <span class="keywordflow">goto</span> finish;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160; </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                <span class="keywordflow">for</span> (i = 0; i &lt; 100; i++)</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                        <span class="keywordflow">if</span> ((stat = <a class="code" href="speedregs_8h.html#a0de0649a772d3a30be4b67b3d222d246">SPD_REG16</a>(<a class="code" href="speedregs_8h.html#a53c267c60f8653ae945a10d4b45e03e6">SPD_R_INTR_STAT</a>) &amp; 0x01))</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                <span class="keywordflow">if</span> (!stat) {</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                        <a class="code" href="dev9_8h.html#ad1c8de3a28913ff71b21e007c56f4fe5">dev9IntrEnable</a>(<a class="code" href="speedregs_8h.html#abfec15973946c023e8d8fce420ec785d">SPD_INTR_ATA0</a>);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                        <a class="code" href="thevent_8h.html#af02e7c7b01bc0632a2d6dd2c97e66dd0">WaitEventFlag</a>(<a class="code" href="ps2atad_8c.html#a63343d9b3948674c9b63eb02a2848580">ata_evflg</a>, <a class="code" href="ps2atad_8c.html#a50452dedf60a5212bb1fdc34d7bed0c5">ATA_EV_TIMEOUT</a>|<a class="code" href="ps2atad_8c.html#a95a26f0483406276dbed0c5773f71428">ATA_EV_COMPLETE</a>, <a class="code" href="thevent_8h.html#a873b52fb6fbd9fd9f4ac161e00982133">WEF_CLEAR</a>|<a class="code" href="thevent_8h.html#aedd147a4c17e7a6d849f6f4205792a53">WEF_OR</a>, &amp;bits);</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                        <span class="keywordflow">if</span> (bits &amp; <a class="code" href="ps2atad_8c.html#a50452dedf60a5212bb1fdc34d7bed0c5">ATA_EV_TIMEOUT</a>) {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                                <a class="code" href="ps2atad_8c.html#a1250382de8ce63fd75727fe97bbb8187">M_PRINTF</a>(<span class="stringliteral">&quot;Error: ATA timeout on DMA completion, buffer stat %04x\n&quot;</span>, <a class="code" href="speedregs_8h.html#a0de0649a772d3a30be4b67b3d222d246">SPD_REG16</a>(0x38));</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                                <a class="code" href="ps2atad_8c.html#a1250382de8ce63fd75727fe97bbb8187">M_PRINTF</a>(<span class="stringliteral">&quot;Error: istat %x, ienable %x\n&quot;</span>, <a class="code" href="speedregs_8h.html#a0de0649a772d3a30be4b67b3d222d246">SPD_REG16</a>(<a class="code" href="speedregs_8h.html#a53c267c60f8653ae945a10d4b45e03e6">SPD_R_INTR_STAT</a>), <a class="code" href="speedregs_8h.html#a0de0649a772d3a30be4b67b3d222d246">SPD_REG16</a>(<a class="code" href="speedregs_8h.html#af87dee81b8f4696ee212b0aaa783bed3">SPD_R_INTR_MASK</a>));</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                                res = <a class="code" href="atad_8h.html#ab61e20397c66cf36c27afaadf2a2d08e">ATA_RES_ERR_TIMEOUT</a>;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                        }</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                }</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        } <span class="keywordflow">else</span> {                        <span class="comment">/* PIO transfers.  */</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                stat = ata_hwport-&gt;r_control;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                <span class="keywordflow">if</span> ((res = <a class="code" href="ps2atad_8c.html#ac9d4860c58b04a2ac5d3f1f003e5a8e7">ata_wait_busy</a>()) &lt; 0)</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                        <span class="keywordflow">goto</span> finish;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                <span class="comment">/* Transfer each PIO data block.  */</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                <span class="keywordflow">while</span> (--cmd_state-&gt;<a class="code" href="structata__cmd__state__t.html#a19b9a666d11d13af9aaa9a839b23df8d">blkcount</a> != -1) {</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                        <span class="keywordflow">if</span> ((res = <a class="code" href="ps2atad_8c.html#af91a5f06a7899804bffc4734c8d53e53">ata_pio_transfer</a>(cmd_state)) &lt; 0)</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                                <span class="keywordflow">goto</span> finish;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                        <span class="keywordflow">if</span> ((res = <a class="code" href="ps2atad_8c.html#ac9d4860c58b04a2ac5d3f1f003e5a8e7">ata_wait_busy</a>()) &lt; 0)</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                                <span class="keywordflow">goto</span> finish;</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                }</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        }</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <span class="keywordflow">if</span> (res)</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                <span class="keywordflow">goto</span> finish;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        <span class="comment">/* Wait until the device isn&#39;t busy.  */</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        <span class="keywordflow">if</span> (ata_hwport-&gt;r_status &amp; <a class="code" href="atahw_8h.html#a16576ead3222be2aa5b0c3e3ed76d097">ATA_STAT_BUSY</a>)</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                res = <a class="code" href="ps2atad_8c.html#ac9d4860c58b04a2ac5d3f1f003e5a8e7">ata_wait_busy</a>();</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        <span class="keywordflow">if</span> ((stat = ata_hwport-&gt;r_status) &amp; <a class="code" href="atahw_8h.html#a58b66bd409925ac01f18f21361e7ef76">ATA_STAT_ERR</a>) {</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                <a class="code" href="ps2atad_8c.html#a1250382de8ce63fd75727fe97bbb8187">M_PRINTF</a>(<span class="stringliteral">&quot;Error: Command error: status 0x%02x, error 0x%02x.\n&quot;</span>, stat, <a class="code" href="ps2atad_8c.html#abd06b5df0dc5102851a9f035b4397725">ata_get_error</a>());</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                <span class="comment">/* In v1.04, there was no check for ICRC. */</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                res = (<a class="code" href="ps2atad_8c.html#abd06b5df0dc5102851a9f035b4397725">ata_get_error</a>() &amp; <a class="code" href="atahw_8h.html#a7181f2d5506b2600a143d509e50d8ca8">ATA_ERR_ICRC</a>) ? <a class="code" href="atad_8h.html#a635f0bfa6a11e9e69a9f3a57f6f603c6">ATA_RES_ERR_ICRC</a> : <a class="code" href="atad_8h.html#a937c8fdec578f257bf7e9cda32d9373e">ATA_RES_ERR_IO</a>;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        }</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160; </div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;finish:</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <span class="comment">/* The command has completed (with an error or not), so clean things up.  */</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        <a class="code" href="thbase_8h.html#a1b61a2148895e76c2b27071ff3f76484">CancelAlarm</a>(&amp;<a class="code" href="ps2atad_8c.html#aa5293599bdaf7e0088900694936606ee">ata_alarm_cb</a>, <a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        <span class="comment">/* Turn off the LED.  */</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <a class="code" href="dev9_8h.html#a1e54ef9096058e351ac8cd31e1583ad9">dev9LEDCtl</a>(0);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160; </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        <span class="keywordflow">if</span>(res)</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                <a class="code" href="ps2atad_8c.html#a1250382de8ce63fd75727fe97bbb8187">M_PRINTF</a>(<span class="stringliteral">&quot;error: ATA failed, %d\n&quot;</span>, res);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;}</div>
<div class="ttc" id="aatahw_8h_html_a16576ead3222be2aa5b0c3e3ed76d097"><div class="ttname"><a href="atahw_8h.html#a16576ead3222be2aa5b0c3e3ed76d097">ATA_STAT_BUSY</a></div><div class="ttdeci">#define ATA_STAT_BUSY</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00067">atahw.h:67</a></div></div>
<div class="ttc" id="aatahw_8h_html_a58b66bd409925ac01f18f21361e7ef76"><div class="ttname"><a href="atahw_8h.html#a58b66bd409925ac01f18f21361e7ef76">ATA_STAT_ERR</a></div><div class="ttdeci">#define ATA_STAT_ERR</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00060">atahw.h:60</a></div></div>
<div class="ttc" id="adev9_8h_html_a1e54ef9096058e351ac8cd31e1583ad9"><div class="ttname"><a href="dev9_8h.html#a1e54ef9096058e351ac8cd31e1583ad9">dev9LEDCtl</a></div><div class="ttdeci">void dev9LEDCtl(int ctl)</div><div class="ttdef"><b>Definition:</b> <a href="ps2dev9_8c_source.html#l00538">ps2dev9.c:538</a></div></div>
<div class="ttc" id="aps2atad_8c_html_a4150d69c3e790e1f2996abf107cb3eb5"><div class="ttname"><a href="ps2atad_8c.html#a4150d69c3e790e1f2996abf107cb3eb5">atad_cmd_state</a></div><div class="ttdeci">static ata_cmd_state_t atad_cmd_state</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00167">ps2atad.c:167</a></div></div>
<div class="ttc" id="aps2atad_8c_html_a57905ac2753d3af573cda8f88ac0539a"><div class="ttname"><a href="ps2atad_8c.html#a57905ac2753d3af573cda8f88ac0539a">ata_dma_complete</a></div><div class="ttdeci">static int ata_dma_complete(void *buf, u32 blkcount, int dir)</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00544">ps2atad.c:544</a></div></div>
<div class="ttc" id="aps2atad_8c_html_aa5293599bdaf7e0088900694936606ee"><div class="ttname"><a href="ps2atad_8c.html#aa5293599bdaf7e0088900694936606ee">ata_alarm_cb</a></div><div class="ttdeci">static unsigned int ata_alarm_cb(void *unused)</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00290">ps2atad.c:290</a></div></div>
<div class="ttc" id="aps2atad_8c_html_af91a5f06a7899804bffc4734c8d53e53"><div class="ttname"><a href="ps2atad_8c.html#af91a5f06a7899804bffc4734c8d53e53">ata_pio_transfer</a></div><div class="ttdeci">static int ata_pio_transfer(ata_cmd_state_t *cmd_state)</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00498">ps2atad.c:498</a></div></div>
<div class="ttc" id="aspeedregs_8h_html_abfec15973946c023e8d8fce420ec785d"><div class="ttname"><a href="speedregs_8h.html#abfec15973946c023e8d8fce420ec785d">SPD_INTR_ATA0</a></div><div class="ttdeci">#define SPD_INTR_ATA0</div><div class="ttdef"><b>Definition:</b> <a href="speedregs_8h_source.html#l00046">speedregs.h:46</a></div></div>
<div class="ttc" id="aspeedregs_8h_html_af87dee81b8f4696ee212b0aaa783bed3"><div class="ttname"><a href="speedregs_8h.html#af87dee81b8f4696ee212b0aaa783bed3">SPD_R_INTR_MASK</a></div><div class="ttdeci">#define SPD_R_INTR_MASK</div><div class="ttdef"><b>Definition:</b> <a href="speedregs_8h_source.html#l00045">speedregs.h:45</a></div></div>
<div class="ttc" id="astructata__cmd__state__t_html"><div class="ttname"><a href="structata__cmd__state__t.html">ata_cmd_state_t</a></div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00156">ps2atad.c:156</a></div></div>
<div class="ttc" id="astructata__cmd__state__t_html_a19b9a666d11d13af9aaa9a839b23df8d"><div class="ttname"><a href="structata__cmd__state__t.html#a19b9a666d11d13af9aaa9a839b23df8d">ata_cmd_state_t::blkcount</a></div><div class="ttdeci">u32 blkcount</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00163">ps2atad.c:163</a></div></div>
<div class="ttc" id="astructata__cmd__state__t_html_a31bd0df24fb3aef7cec7ddad90e4429f"><div class="ttname"><a href="structata__cmd__state__t.html#a31bd0df24fb3aef7cec7ddad90e4429f">ata_cmd_state_t::buf</a></div><div class="ttdeci">void * buf</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00159">ps2atad.c:159</a></div></div>
<div class="ttc" id="astructata__cmd__state__t_html_a66651527eebb4246c375a918a8c91867"><div class="ttname"><a href="structata__cmd__state__t.html#a66651527eebb4246c375a918a8c91867">ata_cmd_state_t::dir</a></div><div class="ttdeci">s32 dir</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00164">ps2atad.c:164</a></div></div>
<div class="ttc" id="astructata__cmd__state__t_html_afb09c69541d7ce3970259a19e18b4d79"><div class="ttname"><a href="structata__cmd__state__t.html#afb09c69541d7ce3970259a19e18b4d79">ata_cmd_state_t::type</a></div><div class="ttdeci">s32 type</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00157">ps2atad.c:157</a></div></div>
<div class="ttc" id="athbase_8h_html_a1b61a2148895e76c2b27071ff3f76484"><div class="ttname"><a href="thbase_8h.html#a1b61a2148895e76c2b27071ff3f76484">CancelAlarm</a></div><div class="ttdeci">int CancelAlarm(unsigned int(*alarm_cb)(void *), void *arg)</div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00699">ata_device_flush_cache()</a>, <a class="el" href="ps2atad_8c_source.html#l00718">ata_device_identify()</a>, <a class="el" href="ps2atad_8c_source.html#l00709">ata_device_idle()</a>, <a class="el" href="ps2atad_8c_source.html#l01186">ata_device_idle_immediate()</a>, <a class="el" href="ps2atad_8c_source.html#l00727">ata_device_pkt_identify()</a>, <a class="el" href="ps2atad_8c_source.html#l00738">ata_device_sce_identify_drive()</a>, <a class="el" href="ps2atad_8c_source.html#l00937">ata_device_sce_sec_erase()</a>, <a class="el" href="ps2atad_8c_source.html#l00892">ata_device_sce_sec_set_password()</a>, <a class="el" href="ps2atad_8c_source.html#l00912">ata_device_sce_sec_unlock()</a>, <a class="el" href="ps2atad_8c_source.html#l00821">ata_device_sector_io()</a>, <a class="el" href="ps2atad_8c_source.html#l00790">ata_device_set_transfer_mode()</a>, <a class="el" href="ps2atad_8c_source.html#l00747">ata_device_smart_enable()</a>, <a class="el" href="ps2atad_8c_source.html#l00767">ata_device_smart_get_status()</a>, <a class="el" href="ps2atad_8c_source.html#l00757">ata_device_smart_save_attr()</a>, and <a class="el" href="ps2atad_8c_source.html#l01195">ata_device_standby_immediate()</a>.</p>

</div>
</div>
<a id="a072b372a9a27da323409e0d693ab92b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a072b372a9a27da323409e0d693ab92b8">&#9670;&nbsp;</a></span>ata_io_start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ata_io_start </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tamtypes_8h.html#a2caf5cd7bcdbe1eefa727f44ffb10bac">u32</a>&#160;</td>
          <td class="paramname"><em>blkcount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a>&#160;</td>
          <td class="paramname"><em>feature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a>&#160;</td>
          <td class="paramname"><em>nsector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a>&#160;</td>
          <td class="paramname"><em>sector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a>&#160;</td>
          <td class="paramname"><em>lcyl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a>&#160;</td>
          <td class="paramname"><em>hcyl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a>&#160;</td>
          <td class="paramname"><em>select</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a>&#160;</td>
          <td class="paramname"><em>command</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00377">377</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;{</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <a class="code" href="atahw_8h.html#ab4f7d3947f74abdfbc8b1966edd9c09a">USE_ATA_REGS</a>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <a class="code" href="structiop__sys__clock__t.html">iop_sys_clock_t</a> cmd_timeout;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="keyword">const</span> <a class="code" href="structata__cmd__info__t.html">ata_cmd_info_t</a> *cmd_table;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="keywordtype">int</span> i, res, type, cmd_table_size;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordtype">int</span> using_timeout, device = (<a class="code" href="ps2ip_8h.html#a2b406456012f9f74aeb33de6f3df053c">select</a> &gt;&gt; 4) &amp; 1;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <a class="code" href="tamtypes_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> searchcmd;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <a class="code" href="thevent_8h.html#ab76a40095333d3f3dd69570a5d9a845d">ClearEventFlag</a>(<a class="code" href="ps2atad_8c.html#a63343d9b3948674c9b63eb02a2848580">ata_evflg</a>, 0);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="ps2atad_8c.html#ac2dd933f6c797949159ee6ab90e86f53">atad_devinfo</a>[device].exists)</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="atad_8h.html#ab3a33c096c7d8071d89cafe6881587b6">ATA_RES_ERR_NODEV</a>;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <span class="keywordflow">if</span> ((res = <a class="code" href="ps2atad_8c.html#afa869626ecb5359525c66f68b8fd44f3">ata_device_select</a>(device)) != 0)</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="comment">/* For the SCE and SMART commands, we need to search on the subcommand</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">        specified in the feature register.  */</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <span class="keywordflow">if</span> (command == <a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca636c7fa5a858d8799484a1650fb410b7">ATA_C_SCE_SECURITY_CONTROL</a>) {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                cmd_table = <a class="code" href="ps2atad_8c.html#ab4616ef4238e77ee363c63d8a5f101e2">sec_ctrl_cmd_table</a>;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                cmd_table_size = <a class="code" href="ps2atad_8c.html#a82ab2311a481a6d46e499c10cc138d4d">SEC_CTRL_CMD_TABLE_SIZE</a>;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                searchcmd = (<a class="code" href="tamtypes_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)feature;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (command == <a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca0f23e95ceda82aee30c00f03f0512c29">ATA_C_SMART</a>) {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                cmd_table = <a class="code" href="ps2atad_8c.html#a931f820c13618c3af525915a18fd755c">smart_cmd_table</a>;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                cmd_table_size = <a class="code" href="ps2atad_8c.html#acd3c64565836f2654180caa8d14a3bea">SMART_CMD_TABLE_SIZE</a>;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                searchcmd = (<a class="code" href="tamtypes_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)feature;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                cmd_table = <a class="code" href="ps2atad_8c.html#abb55a24e7d572d1e58cc40e65b3e52d4">ata_cmd_table</a>;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                cmd_table_size = <a class="code" href="ps2atad_8c.html#a0867c52fd38c6b77b455373854673459">ATA_CMD_TABLE_SIZE</a>;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                searchcmd = (<a class="code" href="tamtypes_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>)command;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        type = 0;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; cmd_table_size; i++) {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                <span class="keywordflow">if</span> (searchcmd == cmd_table[i].command) {</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                        type = cmd_table[i].<a class="code" href="structata__cmd__info__t.html#a0cd01645473aaf1a0f9b17461f8c659d">type</a>;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <span class="keywordflow">if</span> (!(<a class="code" href="ps2atad_8c.html#a4150d69c3e790e1f2996abf107cb3eb5">atad_cmd_state</a>.<a class="code" href="structata__cmd__state__t.html#afb09c69541d7ce3970259a19e18b4d79">type</a> = type &amp; 0x7F))       <span class="comment">//Non-SONY: ignore the 48-bit LBA flag.</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="atad_8h.html#a1510c5faf9a838b13de5406299a9d67f">ATA_RES_ERR_CMD</a>;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <a class="code" href="ps2atad_8c.html#a4150d69c3e790e1f2996abf107cb3eb5">atad_cmd_state</a>.<a class="code" href="structata__cmd__state__t.html#a31bd0df24fb3aef7cec7ddad90e4429f">buf</a> = buf;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <a class="code" href="ps2atad_8c.html#a4150d69c3e790e1f2996abf107cb3eb5">atad_cmd_state</a>.<a class="code" href="structata__cmd__state__t.html#a19b9a666d11d13af9aaa9a839b23df8d">blkcount</a> = blkcount;</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="comment">/* Check that the device is ready if this the appropiate command.  */</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="keywordflow">if</span> (!(ata_hwport-&gt;r_control &amp; 0x40)) {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                <span class="keywordflow">switch</span> (command) {</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1caa565bbfdb25530f3b3c7b29beeda0d9e">ATA_C_DEVICE_RESET</a>:</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1cae4ebb8a9e80e70ce9a37ddde1762f370">ATA_C_EXECUTE_DEVICE_DIAGNOSTIC</a>:</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca08406455bbbffa54e06bd17d4ca5e14d">ATA_C_INITIALIZE_DEVICE_PARAMETERS</a>:</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1cae10831f3c2a570f082aad59b06dcb17e">ATA_C_PACKET</a>:</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                        <span class="keywordflow">case</span> <a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1caf51f406b4db0dd6b7edec5d923833126">ATA_C_IDENTIFY_PACKET_DEVICE</a>:</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                                <a class="code" href="ps2atad_8c.html#a1250382de8ce63fd75727fe97bbb8187">M_PRINTF</a>(<span class="stringliteral">&quot;Error: Device %d is not ready.\n&quot;</span>, device);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                                <span class="keywordflow">return</span> <a class="code" href="atad_8h.html#acb5288b991e55ea53c30b70076a8d1a4">ATA_RES_ERR_NOTREADY</a>;</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        }</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="comment">/* Does this command need a timeout?  */</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        using_timeout = 0;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keywordflow">switch</span> (type &amp; 0x7F) {  <span class="comment">//Non-SONY: ignore the 48-bit LBA flag.</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                <span class="keywordflow">case</span> 6:</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                        using_timeout = 1;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                        <a class="code" href="ps2atad_8c.html#a4150d69c3e790e1f2996abf107cb3eb5">atad_cmd_state</a>.<a class="code" href="structata__cmd__state__t.html#a66651527eebb4246c375a918a8c91867">dir</a> = (command != <a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca8528cbf02928a3d56063941d7c0f4fdb">ATA_C_READ_DMA</a> &amp;&amp; command != <a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca829d6f30a4eb1e462e302b054a8107fe">ATA_C_READ_DMA_EXT</a>);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                        using_timeout = 1;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="keywordflow">if</span> (using_timeout) {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                cmd_timeout.<a class="code" href="structiop__sys__clock__t.html#a5ab3b49c6140e055efd5743f53bc1be1">lo</a> = 0x41eb0000;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                cmd_timeout.<a class="code" href="structiop__sys__clock__t.html#a9e74f03f12eb61e75bb4e353b337baa2">hi</a> = 0;</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                <span class="comment">/* SECURITY ERASE UNIT needs a bit more time.  */</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                <span class="keywordflow">if</span> (command == <a class="code" href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca636c7fa5a858d8799484a1650fb410b7">ATA_C_SCE_SECURITY_CONTROL</a> &amp;&amp; feature == <a class="code" href="atahw_8h.html#a4b112c014d1917234e33ec5dca4c2847a99e4bee4d5ac488b43b9a108a6e32df2">ATA_SCE_SECURITY_ERASE_UNIT</a>)</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                        <a class="code" href="thbase_8h.html#ac6b2d42bc4a4b6a4696f5f64a2244331">USec2SysClock</a>(180000000, &amp;cmd_timeout);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                <span class="keywordflow">if</span> ((res = <a class="code" href="thbase_8h.html#aeda51418a4ceb05028cdc32009e4a4f7">SetAlarm</a>(&amp;cmd_timeout, &amp;<a class="code" href="ps2atad_8c.html#aa5293599bdaf7e0088900694936606ee">ata_alarm_cb</a>, <a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)) &lt; 0)</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                        <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        }</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="comment">/* Enable the command completion interrupt.  */</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="keywordflow">if</span> ((type &amp; 0x7F) == 1)</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                <a class="code" href="dev9_8h.html#ad1c8de3a28913ff71b21e007c56f4fe5">dev9IntrEnable</a>(<a class="code" href="speedregs_8h.html#abfec15973946c023e8d8fce420ec785d">SPD_INTR_ATA0</a>);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="comment">/* Finally!  We send off the ATA command with arguments.  */</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        ata_hwport-&gt;r_control = (using_timeout == 0) &lt;&lt; 1;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        <span class="keywordflow">if</span>(type&amp;0x80) { <span class="comment">//For the sake of achieving improved performance, write the registers twice only if required! This is also required for compatibility with the buggy firmware of certain PSX units.</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                <span class="comment">/* 48-bit LBA requires writing to the address registers twice,</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">                   24 bits of the LBA address is written each time.</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">                   Writing to registers twice does not affect 28-bit LBA since</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">                   only the latest data stored in address registers is used.  */</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                ata_hwport-&gt;r_feature = (feature &gt;&gt; 8) &amp; 0xff;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                ata_hwport-&gt;r_nsector = (nsector &gt;&gt; 8) &amp; 0xff;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                ata_hwport-&gt;r_sector  = (sector &gt;&gt; 8) &amp; 0xff;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                ata_hwport-&gt;r_lcyl    = (lcyl &gt;&gt; 8) &amp; 0xff;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                ata_hwport-&gt;r_hcyl    = (hcyl &gt;&gt; 8) &amp; 0xff;</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        }</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        ata_hwport-&gt;r_feature = feature &amp; 0xff;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        ata_hwport-&gt;r_nsector = nsector &amp; 0xff;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        ata_hwport-&gt;r_sector  = sector &amp; 0xff;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        ata_hwport-&gt;r_lcyl    = lcyl &amp; 0xff;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        ata_hwport-&gt;r_hcyl    = hcyl &amp; 0xff;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        ata_hwport-&gt;r_select  = (<a class="code" href="ps2ip_8h.html#a2b406456012f9f74aeb33de6f3df053c">select</a> | <a class="code" href="atahw_8h.html#a2363a814027582ee4bd2e8ff384b7b40">ATA_SEL_LBA</a>) &amp; 0xff;  <span class="comment">//In v1.04, LBA was enabled in the ata_device_sector_io function.</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        ata_hwport-&gt;r_command = command &amp; 0xff;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <span class="comment">/* Turn on the LED.  */</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <a class="code" href="dev9_8h.html#a1e54ef9096058e351ac8cd31e1583ad9">dev9LEDCtl</a>(1);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;}</div>
<div class="ttc" id="aatad_8h_html_a1510c5faf9a838b13de5406299a9d67f"><div class="ttname"><a href="atad_8h.html#a1510c5faf9a838b13de5406299a9d67f">ATA_RES_ERR_CMD</a></div><div class="ttdeci">#define ATA_RES_ERR_CMD</div><div class="ttdef"><b>Definition:</b> <a href="atad_8h_source.html#l00045">atad.h:45</a></div></div>
<div class="ttc" id="aatad_8h_html_acb5288b991e55ea53c30b70076a8d1a4"><div class="ttname"><a href="atad_8h.html#acb5288b991e55ea53c30b70076a8d1a4">ATA_RES_ERR_NOTREADY</a></div><div class="ttdeci">#define ATA_RES_ERR_NOTREADY</div><div class="ttdef"><b>Definition:</b> <a href="atad_8h_source.html#l00040">atad.h:40</a></div></div>
<div class="ttc" id="aatahw_8h_html_a2363a814027582ee4bd2e8ff384b7b40"><div class="ttname"><a href="atahw_8h.html#a2363a814027582ee4bd2e8ff384b7b40">ATA_SEL_LBA</a></div><div class="ttdeci">#define ATA_SEL_LBA</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00070">atahw.h:70</a></div></div>
<div class="ttc" id="aatahw_8h_html_a414747b879d890c1df55ccbd4208cf1ca08406455bbbffa54e06bd17d4ca5e14d"><div class="ttname"><a href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1ca08406455bbbffa54e06bd17d4ca5e14d">ATA_C_INITIALIZE_DEVICE_PARAMETERS</a></div><div class="ttdeci">@ ATA_C_INITIALIZE_DEVICE_PARAMETERS</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00091">atahw.h:91</a></div></div>
<div class="ttc" id="aatahw_8h_html_a414747b879d890c1df55ccbd4208cf1caa565bbfdb25530f3b3c7b29beeda0d9e"><div class="ttname"><a href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1caa565bbfdb25530f3b3c7b29beeda0d9e">ATA_C_DEVICE_RESET</a></div><div class="ttdeci">@ ATA_C_DEVICE_RESET</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00076">atahw.h:76</a></div></div>
<div class="ttc" id="aatahw_8h_html_a414747b879d890c1df55ccbd4208cf1cae10831f3c2a570f082aad59b06dcb17e"><div class="ttname"><a href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1cae10831f3c2a570f082aad59b06dcb17e">ATA_C_PACKET</a></div><div class="ttdeci">@ ATA_C_PACKET</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00093">atahw.h:93</a></div></div>
<div class="ttc" id="aatahw_8h_html_a414747b879d890c1df55ccbd4208cf1cae4ebb8a9e80e70ce9a37ddde1762f370"><div class="ttname"><a href="atahw_8h.html#a414747b879d890c1df55ccbd4208cf1cae4ebb8a9e80e70ce9a37ddde1762f370">ATA_C_EXECUTE_DEVICE_DIAGNOSTIC</a></div><div class="ttdeci">@ ATA_C_EXECUTE_DEVICE_DIAGNOSTIC</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00090">atahw.h:90</a></div></div>
<div class="ttc" id="aps2atad_8c_html_a0867c52fd38c6b77b455373854673459"><div class="ttname"><a href="ps2atad_8c.html#a0867c52fd38c6b77b455373854673459">ATA_CMD_TABLE_SIZE</a></div><div class="ttdeci">#define ATA_CMD_TABLE_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00128">ps2atad.c:128</a></div></div>
<div class="ttc" id="aps2atad_8c_html_a82ab2311a481a6d46e499c10cc138d4d"><div class="ttname"><a href="ps2atad_8c.html#a82ab2311a481a6d46e499c10cc138d4d">SEC_CTRL_CMD_TABLE_SIZE</a></div><div class="ttdeci">#define SEC_CTRL_CMD_TABLE_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00140">ps2atad.c:140</a></div></div>
<div class="ttc" id="aps2atad_8c_html_a931f820c13618c3af525915a18fd755c"><div class="ttname"><a href="ps2atad_8c.html#a931f820c13618c3af525915a18fd755c">smart_cmd_table</a></div><div class="ttdeci">static const ata_cmd_info_t smart_cmd_table[]</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00142">ps2atad.c:142</a></div></div>
<div class="ttc" id="aps2atad_8c_html_ab4616ef4238e77ee363c63d8a5f101e2"><div class="ttname"><a href="ps2atad_8c.html#ab4616ef4238e77ee363c63d8a5f101e2">sec_ctrl_cmd_table</a></div><div class="ttdeci">static const ata_cmd_info_t sec_ctrl_cmd_table[]</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00130">ps2atad.c:130</a></div></div>
<div class="ttc" id="aps2atad_8c_html_abb55a24e7d572d1e58cc40e65b3e52d4"><div class="ttname"><a href="ps2atad_8c.html#abb55a24e7d572d1e58cc40e65b3e52d4">ata_cmd_table</a></div><div class="ttdeci">static const ata_cmd_info_t ata_cmd_table[]</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00076">ps2atad.c:76</a></div></div>
<div class="ttc" id="aps2atad_8c_html_acd3c64565836f2654180caa8d14a3bea"><div class="ttname"><a href="ps2atad_8c.html#acd3c64565836f2654180caa8d14a3bea">SMART_CMD_TABLE_SIZE</a></div><div class="ttdeci">#define SMART_CMD_TABLE_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00153">ps2atad.c:153</a></div></div>
<div class="ttc" id="astructata__cmd__info__t_html"><div class="ttname"><a href="structata__cmd__info__t.html">ata_cmd_info_t</a></div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00071">ps2atad.c:71</a></div></div>
<div class="ttc" id="astructata__cmd__info__t_html_a0cd01645473aaf1a0f9b17461f8c659d"><div class="ttname"><a href="structata__cmd__info__t.html#a0cd01645473aaf1a0f9b17461f8c659d">ata_cmd_info_t::type</a></div><div class="ttdeci">u8 type</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00073">ps2atad.c:73</a></div></div>
<div class="ttc" id="astructiop__sys__clock__t_html"><div class="ttname"><a href="structiop__sys__clock__t.html">iop_sys_clock_t</a></div><div class="ttdef"><b>Definition:</b> <a href="thbase_8h_source.html#l00075">thbase.h:75</a></div></div>
<div class="ttc" id="astructiop__sys__clock__t_html_a5ab3b49c6140e055efd5743f53bc1be1"><div class="ttname"><a href="structiop__sys__clock__t.html#a5ab3b49c6140e055efd5743f53bc1be1">iop_sys_clock_t::lo</a></div><div class="ttdeci">u32 lo</div><div class="ttdef"><b>Definition:</b> <a href="thbase_8h_source.html#l00076">thbase.h:76</a></div></div>
<div class="ttc" id="astructiop__sys__clock__t_html_a9e74f03f12eb61e75bb4e353b337baa2"><div class="ttname"><a href="structiop__sys__clock__t.html#a9e74f03f12eb61e75bb4e353b337baa2">iop_sys_clock_t::hi</a></div><div class="ttdeci">u32 hi</div><div class="ttdef"><b>Definition:</b> <a href="thbase_8h_source.html#l00076">thbase.h:76</a></div></div>
<div class="ttc" id="athbase_8h_html_ac6b2d42bc4a4b6a4696f5f64a2244331"><div class="ttname"><a href="thbase_8h.html#ac6b2d42bc4a4b6a4696f5f64a2244331">USec2SysClock</a></div><div class="ttdeci">void USec2SysClock(u32 usec, iop_sys_clock_t *sys_clock)</div></div>
<div class="ttc" id="athbase_8h_html_aeda51418a4ceb05028cdc32009e4a4f7"><div class="ttname"><a href="thbase_8h.html#aeda51418a4ceb05028cdc32009e4a4f7">SetAlarm</a></div><div class="ttdeci">int SetAlarm(iop_sys_clock_t *sys_clock, unsigned int(*alarm_cb)(void *), void *arg)</div></div>
<div class="ttc" id="athevent_8h_html_ab76a40095333d3f3dd69570a5d9a845d"><div class="ttname"><a href="thevent_8h.html#ab76a40095333d3f3dd69570a5d9a845d">ClearEventFlag</a></div><div class="ttdeci">int ClearEventFlag(int ef, u32 bits)</div></div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00699">ata_device_flush_cache()</a>, <a class="el" href="ps2atad_8c_source.html#l00718">ata_device_identify()</a>, <a class="el" href="ps2atad_8c_source.html#l00709">ata_device_idle()</a>, <a class="el" href="ps2atad_8c_source.html#l01186">ata_device_idle_immediate()</a>, <a class="el" href="ps2atad_8c_source.html#l00727">ata_device_pkt_identify()</a>, <a class="el" href="ps2atad_8c_source.html#l00738">ata_device_sce_identify_drive()</a>, <a class="el" href="ps2atad_8c_source.html#l00937">ata_device_sce_sec_erase()</a>, <a class="el" href="ps2atad_8c_source.html#l00892">ata_device_sce_sec_set_password()</a>, <a class="el" href="ps2atad_8c_source.html#l00912">ata_device_sce_sec_unlock()</a>, <a class="el" href="ps2atad_8c_source.html#l00821">ata_device_sector_io()</a>, <a class="el" href="ps2atad_8c_source.html#l00790">ata_device_set_transfer_mode()</a>, <a class="el" href="ps2atad_8c_source.html#l00747">ata_device_smart_enable()</a>, <a class="el" href="ps2atad_8c_source.html#l00767">ata_device_smart_get_status()</a>, <a class="el" href="ps2atad_8c_source.html#l00757">ata_device_smart_save_attr()</a>, and <a class="el" href="ps2atad_8c_source.html#l01195">ata_device_standby_immediate()</a>.</p>

</div>
</div>
<a id="a9a34bad4a0850d3cf877949bdaf78218"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a34bad4a0850d3cf877949bdaf78218">&#9670;&nbsp;</a></span>ata_pio_mode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ata_pio_mode </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l01106">1106</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;{</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;        <a class="code" href="speedregs_8h.html#ae17edfe9beb1af5c9a18069f5346c1b5">USE_SPD_REGS</a>;</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="preprocessor">#ifdef ATA_ALL_PIO_MODES</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;        <a class="code" href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a> val;</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160; </div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        <span class="keywordflow">switch</span> (mode) {</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                        val = 0x72;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;                <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                        val = 0x32;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;                <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                        val = 0x24;</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;                <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                        val = 0x23;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;                        val = 0x92;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        }</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160; </div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        <a class="code" href="speedregs_8h.html#a0de0649a772d3a30be4b67b3d222d246">SPD_REG16</a>(<a class="code" href="speedregs_8h.html#a0dd953ef8d48178f2bce012ddd31ea27">SPD_R_PIO_MODE</a>) = val;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        <span class="comment">/* In the late ATAD versions, PIO mode 0 is always used if PIO mode is utilized. */</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        <a class="code" href="speedregs_8h.html#a0de0649a772d3a30be4b67b3d222d246">SPD_REG16</a>(<a class="code" href="speedregs_8h.html#a0dd953ef8d48178f2bce012ddd31ea27">SPD_R_PIO_MODE</a>) = 0x92;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;}</div>
<div class="ttc" id="aspeedregs_8h_html_a0dd953ef8d48178f2bce012ddd31ea27"><div class="ttname"><a href="speedregs_8h.html#a0dd953ef8d48178f2bce012ddd31ea27">SPD_R_PIO_MODE</a></div><div class="ttdeci">#define SPD_R_PIO_MODE</div><div class="ttdef"><b>Definition:</b> <a href="speedregs_8h_source.html#l00072">speedregs.h:72</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="irx_8h_source.html#l00089">irx_export_table::mode</a>, <a class="el" href="speedregs_8h_source.html#l00072">SPD_R_PIO_MODE</a>, <a class="el" href="speedregs_8h_source.html#l00030">SPD_REG16</a>, and <a class="el" href="speedregs_8h_source.html#l00027">USE_SPD_REGS</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00790">ata_device_set_transfer_mode()</a>, and <a class="el" href="ps2atad_8c_source.html#l00995">ata_init_devices()</a>.</p>

</div>
</div>
<a id="af91a5f06a7899804bffc4734c8d53e53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af91a5f06a7899804bffc4734c8d53e53">&#9670;&nbsp;</a></span>ata_pio_transfer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int ata_pio_transfer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structata__cmd__state__t.html">ata_cmd_state_t</a> *&#160;</td>
          <td class="paramname"><em>cmd_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00498">498</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;{</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <a class="code" href="atahw_8h.html#ab4f7d3947f74abdfbc8b1966edd9c09a">USE_ATA_REGS</a>;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <a class="code" href="tamtypes_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> *buf8;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <a class="code" href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a> *buf16;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <span class="keywordtype">int</span> i, type;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <a class="code" href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a> <a class="code" href="IEEE1394__bd_2src_2sbp2__driver_8c.html#ae05ca492ff4accc0e319f6cf3084c5e9">status</a> = ata_hwport-&gt;r_status &amp; 0xff;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="IEEE1394__bd_2src_2sbp2__driver_8c.html#ae05ca492ff4accc0e319f6cf3084c5e9">status</a> &amp; <a class="code" href="atahw_8h.html#a58b66bd409925ac01f18f21361e7ef76">ATA_STAT_ERR</a>) {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                <a class="code" href="ps2atad_8c.html#a1250382de8ce63fd75727fe97bbb8187">M_PRINTF</a>(<span class="stringliteral">&quot;Error: PIO cmd error: status 0x%02x, error 0x%02x.\n&quot;</span>, <a class="code" href="IEEE1394__bd_2src_2sbp2__driver_8c.html#ae05ca492ff4accc0e319f6cf3084c5e9">status</a>, <a class="code" href="ps2atad_8c.html#abd06b5df0dc5102851a9f035b4397725">ata_get_error</a>());</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="atad_8h.html#a937c8fdec578f257bf7e9cda32d9373e">ATA_RES_ERR_IO</a>;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        }</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        <span class="comment">/* DRQ must be set (data request).  */</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="keywordflow">if</span> (!(<a class="code" href="IEEE1394__bd_2src_2sbp2__driver_8c.html#ae05ca492ff4accc0e319f6cf3084c5e9">status</a> &amp; <a class="code" href="atahw_8h.html#a7cd004f7073b92e7e453c4894ca085ea">ATA_STAT_DRQ</a>))</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="atad_8h.html#a96c9c94f3189ab90dc6d22699f6367ea">ATA_RES_ERR_NODATA</a>;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160; </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        type = cmd_state-&gt;<a class="code" href="structata__cmd__state__t.html#afb09c69541d7ce3970259a19e18b4d79">type</a>;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="keywordflow">if</span> (type == 3 || type == 8) {</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                <span class="comment">/* PIO data out */</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                buf16 = cmd_state-&gt;<a class="code" href="structata__cmd__state__t.html#ae151319263e2c9ff2b0c3d226dcc72f5">buf16</a>;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                <span class="keywordflow">for</span> (i = 0; i &lt; 256; i++) {</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                        ata_hwport-&gt;r_data = *buf16;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                        cmd_state-&gt;<a class="code" href="structata__cmd__state__t.html#ae151319263e2c9ff2b0c3d226dcc72f5">buf16</a> = ++buf16;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                }</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                <span class="keywordflow">if</span> (cmd_state-&gt;<a class="code" href="structata__cmd__state__t.html#afb09c69541d7ce3970259a19e18b4d79">type</a> == 8) {</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;                        buf8 = cmd_state-&gt;<a class="code" href="structata__cmd__state__t.html#ac62c7798dce71677da0af4aca6d3e7af">buf8</a>;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                        <span class="keywordflow">for</span> (i = 0; i &lt; 4; i++) {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                                ata_hwport-&gt;r_data = *buf8;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                                cmd_state-&gt;<a class="code" href="structata__cmd__state__t.html#ac62c7798dce71677da0af4aca6d3e7af">buf8</a> = ++buf8;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                        }</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                }</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == 2) {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                <span class="comment">/* PIO data in  */</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                buf16 = cmd_state-&gt;<a class="code" href="structata__cmd__state__t.html#ae151319263e2c9ff2b0c3d226dcc72f5">buf16</a>;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                <span class="keywordflow">for</span> (i = 0; i &lt; 256; i++) {</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                        *buf16 = ata_hwport-&gt;r_data;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                        cmd_state-&gt;<a class="code" href="structata__cmd__state__t.html#ae151319263e2c9ff2b0c3d226dcc72f5">buf16</a> = ++buf16;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                }</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;}</div>
<div class="ttc" id="aIEEE1394__bd_2src_2sbp2__driver_8c_html_ae05ca492ff4accc0e319f6cf3084c5e9"><div class="ttname"><a href="IEEE1394__bd_2src_2sbp2__driver_8c.html#ae05ca492ff4accc0e319f6cf3084c5e9">status</a></div><div class="ttdeci">struct sbp2_status status</div><div class="ttdef"><b>Definition:</b> <a href="IEEE1394__bd_2src_2sbp2__driver_8c_source.html#l00662">sbp2_driver.c:42</a></div></div>
<div class="ttc" id="aatad_8h_html_a96c9c94f3189ab90dc6d22699f6367ea"><div class="ttname"><a href="atad_8h.html#a96c9c94f3189ab90dc6d22699f6367ea">ATA_RES_ERR_NODATA</a></div><div class="ttdeci">#define ATA_RES_ERR_NODATA</div><div class="ttdef"><b>Definition:</b> <a href="atad_8h_source.html#l00043">atad.h:43</a></div></div>
<div class="ttc" id="aatahw_8h_html_a7cd004f7073b92e7e453c4894ca085ea"><div class="ttname"><a href="atahw_8h.html#a7cd004f7073b92e7e453c4894ca085ea">ATA_STAT_DRQ</a></div><div class="ttdeci">#define ATA_STAT_DRQ</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00063">atahw.h:63</a></div></div>
<div class="ttc" id="astructata__cmd__state__t_html_ac62c7798dce71677da0af4aca6d3e7af"><div class="ttname"><a href="structata__cmd__state__t.html#ac62c7798dce71677da0af4aca6d3e7af">ata_cmd_state_t::buf8</a></div><div class="ttdeci">u8 * buf8</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00160">ps2atad.c:160</a></div></div>
<div class="ttc" id="astructata__cmd__state__t_html_ae151319263e2c9ff2b0c3d226dcc72f5"><div class="ttname"><a href="structata__cmd__state__t.html#ae151319263e2c9ff2b0c3d226dcc72f5">ata_cmd_state_t::buf16</a></div><div class="ttdeci">u16 * buf16</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l00161">ps2atad.c:161</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ps2atad_8c_source.html#l00297">ata_get_error()</a>, <a class="el" href="atad_8h_source.html#l00042">ATA_RES_ERR_IO</a>, <a class="el" href="atad_8h_source.html#l00043">ATA_RES_ERR_NODATA</a>, <a class="el" href="atahw_8h_source.html#l00063">ATA_STAT_DRQ</a>, <a class="el" href="atahw_8h_source.html#l00060">ATA_STAT_ERR</a>, <a class="el" href="ps2atad_8c_source.html#l00161">ata_cmd_state_t::buf16</a>, <a class="el" href="ps2atad_8c_source.html#l00160">ata_cmd_state_t::buf8</a>, <a class="el" href="ps2atad_8c_source.html#l00039">M_PRINTF</a>, <a class="el" href="IEEE1394__bd_2src_2sbp2__driver_8c_source.html#l00042">status</a>, <a class="el" href="ps2atad_8c_source.html#l00157">ata_cmd_state_t::type</a>, and <a class="el" href="atahw_8h_source.html#l00043">USE_ATA_REGS</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00597">ata_io_finish()</a>.</p>

</div>
</div>
<a id="a040e68dee95540d676c13ada05a92c2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a040e68dee95540d676c13ada05a92c2d">&#9670;&nbsp;</a></span>ata_post_dma_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ata_post_dma_cb </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bcr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00191">191</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;{</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        <a class="code" href="speedregs_8h.html#ae17edfe9beb1af5c9a18069f5346c1b5">USE_SPD_REGS</a>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <a class="code" href="speedregs_8h.html#a0de0649a772d3a30be4b67b3d222d246">SPD_REG16</a>(<a class="code" href="speedregs_8h.html#a1faac1455f79d4b04e6e3453541643fd">SPD_R_XFR_CTRL</a>)&amp;=~0x80;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;}</div>
<div class="ttc" id="aspeedregs_8h_html_a1faac1455f79d4b04e6e3453541643fd"><div class="ttname"><a href="speedregs_8h.html#a1faac1455f79d4b04e6e3453541643fd">SPD_R_XFR_CTRL</a></div><div class="ttdeci">#define SPD_R_XFR_CTRL</div><div class="ttdef"><b>Definition:</b> <a href="speedregs_8h_source.html#l00068">speedregs.h:68</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="speedregs_8h_source.html#l00068">SPD_R_XFR_CTRL</a>, <a class="el" href="speedregs_8h_source.html#l00030">SPD_REG16</a>, and <a class="el" href="speedregs_8h_source.html#l00027">USE_SPD_REGS</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00207">_start()</a>.</p>

</div>
</div>
<a id="a80f0a9a75a37a8c73bac955b9cd39746"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80f0a9a75a37a8c73bac955b9cd39746">&#9670;&nbsp;</a></span>ata_pre_dma_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ata_pre_dma_cb </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bcr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00184">184</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;{</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <a class="code" href="speedregs_8h.html#ae17edfe9beb1af5c9a18069f5346c1b5">USE_SPD_REGS</a>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <a class="code" href="speedregs_8h.html#a0de0649a772d3a30be4b67b3d222d246">SPD_REG16</a>(<a class="code" href="speedregs_8h.html#a1faac1455f79d4b04e6e3453541643fd">SPD_R_XFR_CTRL</a>)|=0x80;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="speedregs_8h_source.html#l00068">SPD_R_XFR_CTRL</a>, <a class="el" href="speedregs_8h_source.html#l00030">SPD_REG16</a>, and <a class="el" href="speedregs_8h_source.html#l00027">USE_SPD_REGS</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00207">_start()</a>.</p>

</div>
</div>
<a id="ab0d320995c13d10d7e0dfeb2928d8adf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0d320995c13d10d7e0dfeb2928d8adf">&#9670;&nbsp;</a></span>ata_reset_devices()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ata_reset_devices </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00680">680</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;{</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <a class="code" href="atahw_8h.html#ab4f7d3947f74abdfbc8b1966edd9c09a">USE_ATA_REGS</a>;</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160; </div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <span class="keywordflow">if</span> (ata_hwport-&gt;r_control &amp; 0x80)</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="atad_8h.html#acb5288b991e55ea53c30b70076a8d1a4">ATA_RES_ERR_NOTREADY</a>;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="comment">/* Disables device interrupt assertion and asserts SRST. */</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        ata_hwport-&gt;r_control = 6;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        <a class="code" href="thbase_8h.html#a9e662b5867cf57e38015ced97ae413b6">DelayThread</a>(100);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        <span class="comment">/* Disable ATA interrupts.  */</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        ata_hwport-&gt;r_control = 2;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <a class="code" href="thbase_8h.html#a9e662b5867cf57e38015ced97ae413b6">DelayThread</a>(3000);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="ps2atad_8c.html#ac9d4860c58b04a2ac5d3f1f003e5a8e7">ata_wait_busy</a>();</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00995">ata_init_devices()</a>.</p>

</div>
</div>
<a id="a2908a76726fc3566bbdf7a9394d10da4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2908a76726fc3566bbdf7a9394d10da4">&#9670;&nbsp;</a></span>ata_set_dir()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ata_set_dir </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>dir</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l01090">1090</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;{</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        <a class="code" href="speedregs_8h.html#ae17edfe9beb1af5c9a18069f5346c1b5">USE_SPD_REGS</a>;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        <a class="code" href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a> val;</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160; </div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        <a class="code" href="speedregs_8h.html#a0de0649a772d3a30be4b67b3d222d246">SPD_REG16</a>(0x38) = 3;</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        val = <a class="code" href="speedregs_8h.html#a0de0649a772d3a30be4b67b3d222d246">SPD_REG16</a>(<a class="code" href="speedregs_8h.html#ad03f9f6f9754ce6e5698e72c631f5345">SPD_R_IF_CTRL</a>) &amp; 1;</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        val |= (dir == <a class="code" href="atad_8h.html#a24116a956e5fb319dc94739c7e5a6dab">ATA_DIR_WRITE</a>) ? 0x4c : 0x4e;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;        <a class="code" href="speedregs_8h.html#a0de0649a772d3a30be4b67b3d222d246">SPD_REG16</a>(<a class="code" href="speedregs_8h.html#ad03f9f6f9754ce6e5698e72c631f5345">SPD_R_IF_CTRL</a>) = val;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="preprocessor">#ifdef ATA_GAMESTAR_WORKAROUND</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        <a class="code" href="speedregs_8h.html#a0de0649a772d3a30be4b67b3d222d246">SPD_REG16</a>(<a class="code" href="speedregs_8h.html#a1faac1455f79d4b04e6e3453541643fd">SPD_R_XFR_CTRL</a>) = dir | (ata_gamestar_workaround ? 0x86 : 0x6);</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        <a class="code" href="speedregs_8h.html#a0de0649a772d3a30be4b67b3d222d246">SPD_REG16</a>(<a class="code" href="speedregs_8h.html#a1faac1455f79d4b04e6e3453541643fd">SPD_R_XFR_CTRL</a>) = dir | 0x6;  <span class="comment">//In v1.04, DMA was enabled here (0x86 instead of 0x6)</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;}</div>
<div class="ttc" id="aatad_8h_html_a24116a956e5fb319dc94739c7e5a6dab"><div class="ttname"><a href="atad_8h.html#a24116a956e5fb319dc94739c7e5a6dab">ATA_DIR_WRITE</a></div><div class="ttdeci">#define ATA_DIR_WRITE</div><div class="ttdef"><b>Definition:</b> <a href="atad_8h_source.html#l00024">atad.h:24</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="atad_8h_source.html#l00024">ATA_DIR_WRITE</a>, <a class="el" href="speedregs_8h_source.html#l00069">SPD_R_IF_CTRL</a>, <a class="el" href="speedregs_8h_source.html#l00068">SPD_R_XFR_CTRL</a>, <a class="el" href="speedregs_8h_source.html#l00030">SPD_REG16</a>, and <a class="el" href="speedregs_8h_source.html#l00027">USE_SPD_REGS</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00821">ata_device_sector_io()</a>.</p>

</div>
</div>
<a id="aae806c1f3b59570cec35c27dbdd9cfe4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae806c1f3b59570cec35c27dbdd9cfe4">&#9670;&nbsp;</a></span>ata_shutdown_cb()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ata_shutdown_cb </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l01204">1204</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;{</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;        <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160; </div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; 2; i++)</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;        {</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="ps2atad_8c.html#ac2dd933f6c797949159ee6ab90e86f53">atad_devinfo</a>[i].exists)</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;                        <a class="code" href="ps2atad_8c.html#a2858d85ffb9fcd6a6e30d268d134fe3c">ata_device_standby_immediate</a>(i);</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        }</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;}</div>
<div class="ttc" id="aps2atad_8c_html_a2858d85ffb9fcd6a6e30d268d134fe3c"><div class="ttname"><a href="ps2atad_8c.html#a2858d85ffb9fcd6a6e30d268d134fe3c">ata_device_standby_immediate</a></div><div class="ttdeci">static int ata_device_standby_immediate(int device)</div><div class="ttdef"><b>Definition:</b> <a href="ps2atad_8c_source.html#l01195">ps2atad.c:1195</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="ps2atad_8c_source.html#l01195">ata_device_standby_immediate()</a>, and <a class="el" href="ps2atad_8c_source.html#l00064">atad_devinfo</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00207">_start()</a>.</p>

</div>
</div>
<a id="a077ecda08e27dfa44cadda1e1c8b18b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a077ecda08e27dfa44cadda1e1c8b18b8">&#9670;&nbsp;</a></span>ata_ultra_dma_mode()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void ata_ultra_dma_mode </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>mode</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l01158">1158</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;{</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;        <a class="code" href="speedregs_8h.html#ae17edfe9beb1af5c9a18069f5346c1b5">USE_SPD_REGS</a>;</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        <a class="code" href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a> val;</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160; </div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;        <span class="keywordflow">switch</span> (mode)</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;        {</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;                <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                        val = 0x85;</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                        val = 0x63;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                        val = 0x62;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                        val = 0x61;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                        val = 0xa7;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;        }</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        <a class="code" href="speedregs_8h.html#a0de0649a772d3a30be4b67b3d222d246">SPD_REG16</a>(<a class="code" href="speedregs_8h.html#a1774494f73303d2715511b088fba31bb">SPD_R_UDMA_MODE</a>) = val;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        <a class="code" href="speedregs_8h.html#a0de0649a772d3a30be4b67b3d222d246">SPD_REG16</a>(<a class="code" href="speedregs_8h.html#ad03f9f6f9754ce6e5698e72c631f5345">SPD_R_IF_CTRL</a>) |= 0x49;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;}</div>
<div class="ttc" id="aspeedregs_8h_html_a1774494f73303d2715511b088fba31bb"><div class="ttname"><a href="speedregs_8h.html#a1774494f73303d2715511b088fba31bb">SPD_R_UDMA_MODE</a></div><div class="ttdeci">#define SPD_R_UDMA_MODE</div><div class="ttdef"><b>Definition:</b> <a href="speedregs_8h_source.html#l00074">speedregs.h:74</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="irx_8h_source.html#l00089">irx_export_table::mode</a>, <a class="el" href="speedregs_8h_source.html#l00069">SPD_R_IF_CTRL</a>, <a class="el" href="speedregs_8h_source.html#l00074">SPD_R_UDMA_MODE</a>, <a class="el" href="speedregs_8h_source.html#l00030">SPD_REG16</a>, and <a class="el" href="speedregs_8h_source.html#l00027">USE_SPD_REGS</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00790">ata_device_set_transfer_mode()</a>.</p>

</div>
</div>
<a id="a886021ff3904acdbf64a88befd93330a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a886021ff3904acdbf64a88befd93330a">&#9670;&nbsp;</a></span>gen_ata_wait_busy()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int gen_ata_wait_busy </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bits</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00311">311</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;{</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <a class="code" href="atahw_8h.html#ab4f7d3947f74abdfbc8b1966edd9c09a">USE_ATA_REGS</a>;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordtype">int</span> i, didx, delay;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; 80; i++) {</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                <span class="keywordflow">if</span> (!(ata_hwport-&gt;r_control &amp; bits))</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                didx = i / 10;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                <span class="keywordflow">switch</span> (didx) {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                        <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                        <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                                delay = 100;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                        <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                                delay = 1000;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                        <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                                delay = 10000;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                        <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                                delay = 100000;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                                delay = 1000000;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                <a class="code" href="thbase_8h.html#a9e662b5867cf57e38015ced97ae413b6">DelayThread</a>(delay);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <a class="code" href="ps2atad_8c.html#a1250382de8ce63fd75727fe97bbb8187">M_PRINTF</a>(<span class="stringliteral">&quot;Timeout while waiting on busy (0x%02x).\n&quot;</span>, bits);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="atad_8h.html#ab61e20397c66cf36c27afaadf2a2d08e">ATA_RES_ERR_TIMEOUT</a>;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="atad_8h_source.html#l00041">ATA_RES_ERR_TIMEOUT</a>, <a class="el" href="thbase_8h.html#a9e662b5867cf57e38015ced97ae413b6">DelayThread()</a>, <a class="el" href="ps2atad_8c_source.html#l00039">M_PRINTF</a>, and <a class="el" href="atahw_8h_source.html#l00043">USE_ATA_REGS</a>.</p>

</div>
</div>
<a id="a89c734517935f08827f3e6cdedf3e40a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89c734517935f08827f3e6cdedf3e40a">&#9670;&nbsp;</a></span>IRX_ID()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IRX_ID </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="usb_2usbmass__bd_2src_2main_8c.html#a0d598793f4b45908f46521f31f108dff">MODNAME</a>&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">2&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">7&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a6d3162693508354859edc5d7623dc6ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d3162693508354859edc5d7623dc6ee">&#9670;&nbsp;</a></span>_exp_atad</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structirx__export__table.html">irx_export_table</a> _exp_atad</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00207">_start()</a>.</p>

</div>
</div>
<a id="abb55a24e7d572d1e58cc40e65b3e52d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb55a24e7d572d1e58cc40e65b3e52d4">&#9670;&nbsp;</a></span>ata_cmd_table</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structata__cmd__info__t.html">ata_cmd_info_t</a> ata_cmd_table[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00076">76</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00377">ata_io_start()</a>.</p>

</div>
</div>
<a id="a36d5160a12b758a05b46552665fa0420"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36d5160a12b758a05b46552665fa0420">&#9670;&nbsp;</a></span>ata_devinfo_init</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ata_devinfo_init = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00054">54</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l01080">ata_get_devinfo()</a>.</p>

</div>
</div>
<a id="acd506af8f0da0f60a2b367a78964b8b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd506af8f0da0f60a2b367a78964b8b2">&#9670;&nbsp;</a></span>ata_disable_lba48</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tamtypes_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> ata_disable_lba48 = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00058">58</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00207">_start()</a>, and <a class="el" href="ps2atad_8c_source.html#l00995">ata_init_devices()</a>.</p>

</div>
</div>
<a id="a63343d9b3948674c9b63eb02a2848580"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a63343d9b3948674c9b63eb02a2848580">&#9670;&nbsp;</a></span>ata_evflg</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ata_evflg = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00055">55</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00207">_start()</a>, <a class="el" href="ps2atad_8c_source.html#l00290">ata_alarm_cb()</a>, <a class="el" href="ps2atad_8c_source.html#l00544">ata_dma_complete()</a>, <a class="el" href="ps2atad_8c_source.html#l00278">ata_intr_cb()</a>, <a class="el" href="ps2atad_8c_source.html#l00597">ata_io_finish()</a>, and <a class="el" href="ps2atad_8c_source.html#l00377">ata_io_start()</a>.</p>

</div>
</div>
<a id="ad7e4a242bab16217e288f17efa109daf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7e4a242bab16217e288f17efa109daf">&#9670;&nbsp;</a></span>ata_param</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tamtypes_8h.html#a9e6c91d77e24643b888dbd1a1a590054">u16</a> ata_param[256]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00068">68</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00892">ata_device_sce_sec_set_password()</a>, <a class="el" href="ps2atad_8c_source.html#l00912">ata_device_sce_sec_unlock()</a>, and <a class="el" href="ps2atad_8c_source.html#l00995">ata_init_devices()</a>.</p>

</div>
</div>
<a id="a4150d69c3e790e1f2996abf107cb3eb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4150d69c3e790e1f2996abf107cb3eb5">&#9670;&nbsp;</a></span>atad_cmd_state</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structata__cmd__state__t.html">ata_cmd_state_t</a> atad_cmd_state</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00167">167</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00597">ata_io_finish()</a>, and <a class="el" href="ps2atad_8c_source.html#l00377">ata_io_start()</a>.</p>

</div>
</div>
<a id="ac2dd933f6c797949159ee6ab90e86f53"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2dd933f6c797949159ee6ab90e86f53">&#9670;&nbsp;</a></span>atad_devinfo</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structata__devinfo__t.html">ata_devinfo_t</a> atad_devinfo[2]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00064">64</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00699">ata_device_flush_cache()</a>, <a class="el" href="ps2atad_8c_source.html#l00937">ata_device_sce_sec_erase()</a>, <a class="el" href="ps2atad_8c_source.html#l00892">ata_device_sce_sec_set_password()</a>, <a class="el" href="ps2atad_8c_source.html#l00912">ata_device_sce_sec_unlock()</a>, <a class="el" href="ps2atad_8c_source.html#l00821">ata_device_sector_io()</a>, <a class="el" href="ps2atad_8c_source.html#l01080">ata_get_devinfo()</a>, <a class="el" href="ps2atad_8c_source.html#l00278">ata_intr_cb()</a>, <a class="el" href="ps2atad_8c_source.html#l00377">ata_io_start()</a>, and <a class="el" href="ps2atad_8c_source.html#l01204">ata_shutdown_cb()</a>.</p>

</div>
</div>
<a id="ab4616ef4238e77ee363c63d8a5f101e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4616ef4238e77ee363c63d8a5f101e2">&#9670;&nbsp;</a></span>sec_ctrl_cmd_table</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structata__cmd__info__t.html">ata_cmd_info_t</a> sec_ctrl_cmd_table[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">        {<a class="code" href="atahw_8h.html#a4b112c014d1917234e33ec5dca4c2847a9433ff34e77c159c74e6e8799478e599">ATA_SCE_IDENTIFY_DRIVE</a>,2},</div>
<div class="line">        {<a class="code" href="atahw_8h.html#a4b112c014d1917234e33ec5dca4c2847ab26408b75ac253276b7a3fd8343190fc">ATA_SCE_SECURITY_ERASE_PREPARE</a>,1},</div>
<div class="line">        {<a class="code" href="atahw_8h.html#a4b112c014d1917234e33ec5dca4c2847a99e4bee4d5ac488b43b9a108a6e32df2">ATA_SCE_SECURITY_ERASE_UNIT</a>,1},</div>
<div class="line">        {<a class="code" href="atahw_8h.html#a4b112c014d1917234e33ec5dca4c2847a1a45a390875ade2a12e554d20673d210">ATA_SCE_SECURITY_FREEZE_LOCK</a>,1},</div>
<div class="line">        {<a class="code" href="atahw_8h.html#a4b112c014d1917234e33ec5dca4c2847ae86129a74686a6bb1f2d5f00249231e3">ATA_SCE_SECURITY_SET_PASSWORD</a>,3},</div>
<div class="line">        {<a class="code" href="atahw_8h.html#a4b112c014d1917234e33ec5dca4c2847ab370cf0ba472a39c7096e487eafdad5f">ATA_SCE_SECURITY_UNLOCK</a>,3},</div>
<div class="line">        {<a class="code" href="atahw_8h.html#a4b112c014d1917234e33ec5dca4c2847a53394542a5fe7a5584e62e2232261497">ATA_SCE_SECURITY_WRITE_ID</a>,3},</div>
<div class="line">        {<a class="code" href="atahw_8h.html#a4b112c014d1917234e33ec5dca4c2847a889ce851393b0c370898f8f5cbca2590">ATA_SCE_SECURITY_READ_ID</a>,2}</div>
<div class="line">}</div>
<div class="ttc" id="aatahw_8h_html_a4b112c014d1917234e33ec5dca4c2847a1a45a390875ade2a12e554d20673d210"><div class="ttname"><a href="atahw_8h.html#a4b112c014d1917234e33ec5dca4c2847a1a45a390875ade2a12e554d20673d210">ATA_SCE_SECURITY_FREEZE_LOCK</a></div><div class="ttdeci">@ ATA_SCE_SECURITY_FREEZE_LOCK</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00142">atahw.h:142</a></div></div>
<div class="ttc" id="aatahw_8h_html_a4b112c014d1917234e33ec5dca4c2847a53394542a5fe7a5584e62e2232261497"><div class="ttname"><a href="atahw_8h.html#a4b112c014d1917234e33ec5dca4c2847a53394542a5fe7a5584e62e2232261497">ATA_SCE_SECURITY_WRITE_ID</a></div><div class="ttdeci">@ ATA_SCE_SECURITY_WRITE_ID</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00144">atahw.h:144</a></div></div>
<div class="ttc" id="aatahw_8h_html_a4b112c014d1917234e33ec5dca4c2847a889ce851393b0c370898f8f5cbca2590"><div class="ttname"><a href="atahw_8h.html#a4b112c014d1917234e33ec5dca4c2847a889ce851393b0c370898f8f5cbca2590">ATA_SCE_SECURITY_READ_ID</a></div><div class="ttdeci">@ ATA_SCE_SECURITY_READ_ID</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00143">atahw.h:143</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00130">130</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00377">ata_io_start()</a>.</p>

</div>
</div>
<a id="a931f820c13618c3af525915a18fd755c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a931f820c13618c3af525915a18fd755c">&#9670;&nbsp;</a></span>smart_cmd_table</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="structata__cmd__info__t.html">ata_cmd_info_t</a> smart_cmd_table[]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div>
<div class="line">        {<a class="code" href="atahw_8h.html#ac3fe83b43eefb25639ccd0d41935e6f0ae832d753d7da4705ce0927ba2ab6568c">ATA_S_SMART_READ_DATA</a>,2},</div>
<div class="line">        {<a class="code" href="atahw_8h.html#ac3fe83b43eefb25639ccd0d41935e6f0a1b7cb7f1eff673f87d2e0cbb0b9d8279">ATA_S_SMART_ENABLE_DISABLE_AUTOSAVE</a>,1},</div>
<div class="line">        {<a class="code" href="atahw_8h.html#ac3fe83b43eefb25639ccd0d41935e6f0a259d021f1364bf8602f4307ba0d55338">ATA_S_SMART_SAVE_ATTRIBUTE_VALUES</a>,1},</div>
<div class="line">        {<a class="code" href="atahw_8h.html#ac3fe83b43eefb25639ccd0d41935e6f0a3800de8a84025d7df8a0271d3e91ba3d">ATA_S_SMART_EXECUTE_OFF_LINE</a>,1},</div>
<div class="line">        {<a class="code" href="atahw_8h.html#ac3fe83b43eefb25639ccd0d41935e6f0a9766f1587e96d06d1bf435baecd4253e">ATA_S_SMART_READ_LOG</a>,2},</div>
<div class="line">        {<a class="code" href="atahw_8h.html#ac3fe83b43eefb25639ccd0d41935e6f0a47b76b4d2867389549d254230c71283d">ATA_S_SMART_WRITE_LOG</a>,3},</div>
<div class="line">        {<a class="code" href="atahw_8h.html#ac3fe83b43eefb25639ccd0d41935e6f0a3f480513f134e7e2a410542aabbde6cd">ATA_S_SMART_ENABLE_OPERATIONS</a>,1},</div>
<div class="line">        {<a class="code" href="atahw_8h.html#ac3fe83b43eefb25639ccd0d41935e6f0ad2c97a7a47c6af8ee5bb8c8409f1b971">ATA_S_SMART_DISABLE_OPERATIONS</a>,1},</div>
<div class="line">        {<a class="code" href="atahw_8h.html#ac3fe83b43eefb25639ccd0d41935e6f0accf0a7832ee3df9bea4ce618b807d5d7">ATA_S_SMART_RETURN_STATUS</a>,1}</div>
<div class="line">}</div>
<div class="ttc" id="aatahw_8h_html_ac3fe83b43eefb25639ccd0d41935e6f0a1b7cb7f1eff673f87d2e0cbb0b9d8279"><div class="ttname"><a href="atahw_8h.html#ac3fe83b43eefb25639ccd0d41935e6f0a1b7cb7f1eff673f87d2e0cbb0b9d8279">ATA_S_SMART_ENABLE_DISABLE_AUTOSAVE</a></div><div class="ttdeci">@ ATA_S_SMART_ENABLE_DISABLE_AUTOSAVE</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00149">atahw.h:149</a></div></div>
<div class="ttc" id="aatahw_8h_html_ac3fe83b43eefb25639ccd0d41935e6f0a3800de8a84025d7df8a0271d3e91ba3d"><div class="ttname"><a href="atahw_8h.html#ac3fe83b43eefb25639ccd0d41935e6f0a3800de8a84025d7df8a0271d3e91ba3d">ATA_S_SMART_EXECUTE_OFF_LINE</a></div><div class="ttdeci">@ ATA_S_SMART_EXECUTE_OFF_LINE</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00151">atahw.h:151</a></div></div>
<div class="ttc" id="aatahw_8h_html_ac3fe83b43eefb25639ccd0d41935e6f0a47b76b4d2867389549d254230c71283d"><div class="ttname"><a href="atahw_8h.html#ac3fe83b43eefb25639ccd0d41935e6f0a47b76b4d2867389549d254230c71283d">ATA_S_SMART_WRITE_LOG</a></div><div class="ttdeci">@ ATA_S_SMART_WRITE_LOG</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00153">atahw.h:153</a></div></div>
<div class="ttc" id="aatahw_8h_html_ac3fe83b43eefb25639ccd0d41935e6f0a9766f1587e96d06d1bf435baecd4253e"><div class="ttname"><a href="atahw_8h.html#ac3fe83b43eefb25639ccd0d41935e6f0a9766f1587e96d06d1bf435baecd4253e">ATA_S_SMART_READ_LOG</a></div><div class="ttdeci">@ ATA_S_SMART_READ_LOG</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00152">atahw.h:152</a></div></div>
<div class="ttc" id="aatahw_8h_html_ac3fe83b43eefb25639ccd0d41935e6f0ad2c97a7a47c6af8ee5bb8c8409f1b971"><div class="ttname"><a href="atahw_8h.html#ac3fe83b43eefb25639ccd0d41935e6f0ad2c97a7a47c6af8ee5bb8c8409f1b971">ATA_S_SMART_DISABLE_OPERATIONS</a></div><div class="ttdeci">@ ATA_S_SMART_DISABLE_OPERATIONS</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00155">atahw.h:155</a></div></div>
<div class="ttc" id="aatahw_8h_html_ac3fe83b43eefb25639ccd0d41935e6f0ae832d753d7da4705ce0927ba2ab6568c"><div class="ttname"><a href="atahw_8h.html#ac3fe83b43eefb25639ccd0d41935e6f0ae832d753d7da4705ce0927ba2ab6568c">ATA_S_SMART_READ_DATA</a></div><div class="ttdeci">@ ATA_S_SMART_READ_DATA</div><div class="ttdef"><b>Definition:</b> <a href="atahw_8h_source.html#l00148">atahw.h:148</a></div></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="ps2atad_8c_source.html#l00142">142</a> of file <a class="el" href="ps2atad_8c_source.html">ps2atad.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="ps2atad_8c_source.html#l00377">ata_io_start()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_0981ace215aa2029f526b70c145b9fbe.html">iop</a></li><li class="navelem"><a class="el" href="dir_6f16cad81de2453a6f48c5e272ba4a18.html">dev9</a></li><li class="navelem"><a class="el" href="dir_c9fad5ea75093c7356ef5f2b903232b1.html">atad</a></li><li class="navelem"><a class="el" href="dir_afe8e9069a558f7a54a2a2685d2ad2e6.html">src</a></li><li class="navelem"><a class="el" href="ps2atad_8c.html">ps2atad.c</a></li>
    <li class="footer">Generated on Thu Feb 11 2021 11:42:42 for ps2sdk by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
</body>
</html>
