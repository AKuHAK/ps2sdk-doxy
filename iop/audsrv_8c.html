<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ps2sdk: iop/sound/audsrv/src/audsrv.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="code.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ps2sdk
   &#160;<span id="projectnumber">1.1</span>
   </div>
   <div id="projectbrief">A collection of Open Source libraries used for developing applications on Sony&#39;s PlayStation 2Â® (PS2).</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('audsrv_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">audsrv.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="stdio_8h_source.html">stdio.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="thbase_8h_source.html">thbase.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="thsemap_8h_source.html">thsemap.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="loadcore_8h_source.html">loadcore.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="sysmem_8h_source.html">sysmem.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="intrman_8h_source.html">intrman.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="sifcmd_8h_source.html">sifcmd.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="libsd_8h_source.html">libsd.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="sysclib_8h_source.html">sysclib.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="audsrv_8h_source.html">audsrv.h</a>&gt;</code><br />
<code>#include &quot;<a class="el" href="audsrv__internal_8h_source.html">audsrv_internal.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sound_2audsrv_2src_2common_8h_source.html">common.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sound_2audsrv_2src_2rpc__server_8h_source.html">rpc_server.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sound_2audsrv_2src_2rpc__client_8h_source.html">rpc_client.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="upsamplers_8h_source.html">upsamplers.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="hw_8h_source.html">hw.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="spu_8h_source.html">spu.h</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for audsrv.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="audsrv_8c__incl.svg" width="100%" height="563"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div>
<p><a href="audsrv_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a1c6d5de492ac61ad29aec7aa9a436bbf"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#a1c6d5de492ac61ad29aec7aa9a436bbf">VERSION</a>&#160;&#160;&#160;&quot;0.92&quot;</td></tr>
<tr class="separator:a1c6d5de492ac61ad29aec7aa9a436bbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa488e2e7c1e287d7cb48c57c287b7257"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#aa488e2e7c1e287d7cb48c57c287b7257">IRX_ID</a> (&quot;audsrv&quot;, 1, 3)</td></tr>
<tr class="separator:aa488e2e7c1e287d7cb48c57c287b7257"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addc7abfb9fc4d953e5e6bd5014948a3e"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#addc7abfb9fc4d953e5e6bd5014948a3e">play_thread</a> (void *<a class="el" href="sbusintr_8c.html#a9ce2ec4812a92cb6ab39f6e81e9173a9">arg</a>)</td></tr>
<tr class="separator:addc7abfb9fc4d953e5e6bd5014948a3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bcbc0994bd2a234b67ba334bba98374"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#a8bcbc0994bd2a234b67ba334bba98374">transfer_complete</a> (void *<a class="el" href="sbusintr_8c.html#a9ce2ec4812a92cb6ab39f6e81e9173a9">arg</a>)</td></tr>
<tr class="separator:a8bcbc0994bd2a234b67ba334bba98374"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3b9ac75129aa004ecb1215bdc7b6264"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#aa3b9ac75129aa004ecb1215bdc7b6264">update_volume</a> ()</td></tr>
<tr class="separator:aa3b9ac75129aa004ecb1215bdc7b6264"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74eb49da756be49fcd0eafee340c4bf3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#a74eb49da756be49fcd0eafee340c4bf3">audsrv_stop_audio</a> ()</td></tr>
<tr class="separator:a74eb49da756be49fcd0eafee340c4bf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90ea71b90d5163569fa5da7b3ad30c23"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#a90ea71b90d5163569fa5da7b3ad30c23">audsrv_format_ok</a> (int freq, int bits, int channels)</td></tr>
<tr class="separator:a90ea71b90d5163569fa5da7b3ad30c23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f2fa483fb1e9ce5b55b48eca5d925d1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#a8f2fa483fb1e9ce5b55b48eca5d925d1">audsrv_set_format</a> (int freq, int bits, int channels)</td></tr>
<tr class="separator:a8f2fa483fb1e9ce5b55b48eca5d925d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39840d3595dac76a4636a371ea22363e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#a39840d3595dac76a4636a371ea22363e">audsrv_init</a> ()</td></tr>
<tr class="separator:a39840d3595dac76a4636a371ea22363e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8cbc4efcabf1cacf0fc605d07c1b62c5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#a8cbc4efcabf1cacf0fc605d07c1b62c5">audsrv_available</a> ()</td></tr>
<tr class="separator:a8cbc4efcabf1cacf0fc605d07c1b62c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c6fd06f035d6f7ac65d1f6c5399c9f1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#a1c6fd06f035d6f7ac65d1f6c5399c9f1">audsrv_wait_audio</a> (int buflen)</td></tr>
<tr class="separator:a1c6fd06f035d6f7ac65d1f6c5399c9f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc83c5941bfa150bf8adb821f92f3ae8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#adc83c5941bfa150bf8adb821f92f3ae8">audsrv_play_audio</a> (const char *buf, int buflen)</td></tr>
<tr class="separator:adc83c5941bfa150bf8adb821f92f3ae8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b1e932fab3e35b04cbf4c651d3a818e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#a1b1e932fab3e35b04cbf4c651d3a818e">audsrv_set_volume</a> (int vol)</td></tr>
<tr class="separator:a1b1e932fab3e35b04cbf4c651d3a818e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a25ac3a1b590c27f4d096d4d6cadb00"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#a1a25ac3a1b590c27f4d096d4d6cadb00">audsrv_set_threshold</a> (int amount)</td></tr>
<tr class="separator:a1a25ac3a1b590c27f4d096d4d6cadb00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af96a6cbe0fcfc100127b49184d4480a2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#af96a6cbe0fcfc100127b49184d4480a2">audsrv_quit</a> ()</td></tr>
<tr class="separator:af96a6cbe0fcfc100127b49184d4480a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48daaa0d3de94863970a8153910775a6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#a48daaa0d3de94863970a8153910775a6">unittest_start</a> ()</td></tr>
<tr class="separator:a48daaa0d3de94863970a8153910775a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d259b9f2c7d45f4713e0c483d0fa25b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#a7d259b9f2c7d45f4713e0c483d0fa25b">_start</a> (int argc, char *argv[])</td></tr>
<tr class="separator:a7d259b9f2c7d45f4713e0c483d0fa25b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a69da40149fa83da89f0af9681a6eeeac"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#a69da40149fa83da89f0af9681a6eeeac">core1_volume</a> = <a class="el" href="spu_8h.html#a7ed6a6db7ec466a04b820f3de267708a">MAX_VOLUME</a></td></tr>
<tr class="separator:a69da40149fa83da89f0af9681a6eeeac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac273d1740f99ea0b6a7a4b3735ecdfa0"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#ac273d1740f99ea0b6a7a4b3735ecdfa0">core1_freq</a> = 0</td></tr>
<tr class="separator:ac273d1740f99ea0b6a7a4b3735ecdfa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acfe400051687fd6e8c158ac22d509ae6"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#acfe400051687fd6e8c158ac22d509ae6">core1_bits</a> = 0</td></tr>
<tr class="separator:acfe400051687fd6e8c158ac22d509ae6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3168c7f7f22624aa7906c9b47bacbd30"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#a3168c7f7f22624aa7906c9b47bacbd30">core1_channels</a> = 0</td></tr>
<tr class="separator:a3168c7f7f22624aa7906c9b47bacbd30"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78383d9f30a7cb3d6f4fe07973c7d69a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#a78383d9f30a7cb3d6f4fe07973c7d69a">core1_sample_shift</a> = 0</td></tr>
<tr class="separator:a78383d9f30a7cb3d6f4fe07973c7d69a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad06983e7f6e71b233ea7ff3dee1952f2"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#ad06983e7f6e71b233ea7ff3dee1952f2">initialized</a> = 0</td></tr>
<tr class="separator:ad06983e7f6e71b233ea7ff3dee1952f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35fd1e3b4b7aa595eca11a2b9d953c31"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#a35fd1e3b4b7aa595eca11a2b9d953c31">playing</a> = 0</td></tr>
<tr class="separator:a35fd1e3b4b7aa595eca11a2b9d953c31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b54b44595bb0afc505dba9ddc6a4e26"><td class="memItemLeft" align="right" valign="top">static char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#a5b54b44595bb0afc505dba9ddc6a4e26">ringbuf</a> [20480]</td></tr>
<tr class="separator:a5b54b44595bb0afc505dba9ddc6a4e26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2fb3a6b652ed6dda27b5672372183ca"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#aa2fb3a6b652ed6dda27b5672372183ca">ringbuf_size</a> = sizeof(<a class="el" href="audsrv_8c.html#a5b54b44595bb0afc505dba9ddc6a4e26">ringbuf</a>)</td></tr>
<tr class="separator:aa2fb3a6b652ed6dda27b5672372183ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bf189efc18e1f2c352c562b85bf851f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#a6bf189efc18e1f2c352c562b85bf851f">readpos</a></td></tr>
<tr class="separator:a6bf189efc18e1f2c352c562b85bf851f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f6eda090a2a7d35f235aa0db908ed15"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#a4f6eda090a2a7d35f235aa0db908ed15">writepos</a></td></tr>
<tr class="separator:a4f6eda090a2a7d35f235aa0db908ed15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e9d895d9f970505d574ee19c1d26d19"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#a0e9d895d9f970505d574ee19c1d26d19">play_tid</a> = 0</td></tr>
<tr class="separator:a0e9d895d9f970505d574ee19c1d26d19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cd0ef0a782e1c8ca8147796e538a26a"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#a7cd0ef0a782e1c8ca8147796e538a26a">queue_sema</a> = 0</td></tr>
<tr class="separator:a7cd0ef0a782e1c8ca8147796e538a26a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae538f96c6438e7b0ed26269a283afc09"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#ae538f96c6438e7b0ed26269a283afc09">transfer_sema</a> = 0</td></tr>
<tr class="separator:ae538f96c6438e7b0ed26269a283afc09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56a7783a6416e54a779e0e2ffc31fadd"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#a56a7783a6416e54a779e0e2ffc31fadd">fillbuf_threshold</a> = 0</td></tr>
<tr class="separator:a56a7783a6416e54a779e0e2ffc31fadd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaeab2fdb9a7b3830fdfa6cdc781c1f9e"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#aaeab2fdb9a7b3830fdfa6cdc781c1f9e">format_changed</a> = 0</td></tr>
<tr class="separator:aaeab2fdb9a7b3830fdfa6cdc781c1f9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8239de91b01b86a813ab98ca78a98930"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="tamtypes_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#a8239de91b01b86a813ab98ca78a98930">core1_buf</a> [0x1000]</td></tr>
<tr class="separator:a8239de91b01b86a813ab98ca78a98930"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab524ac072670ad66c54fa64539fad503"><td class="memItemLeft" align="right" valign="top">static short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#ab524ac072670ad66c54fa64539fad503">rendered_left</a> [512]</td></tr>
<tr class="separator:ab524ac072670ad66c54fa64539fad503"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacdc06af33627c2816d728e4ae45f3c1"><td class="memItemLeft" align="right" valign="top">static short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#aacdc06af33627c2816d728e4ae45f3c1">rendered_right</a> [512]</td></tr>
<tr class="separator:aacdc06af33627c2816d728e4ae45f3c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad23dc209a0ea2d9b3b4db0f4fc741ed1"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structirx__export__table.html">irx_export_table</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="audsrv_8c.html#ad23dc209a0ea2d9b3b4db0f4fc741ed1">_exp_audsrv</a></td></tr>
<tr class="separator:ad23dc209a0ea2d9b3b4db0f4fc741ed1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>audsrv IOP server </p>

<p class="definition">Definition in file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a1c6d5de492ac61ad29aec7aa9a436bbf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c6d5de492ac61ad29aec7aa9a436bbf">&#9670;&nbsp;</a></span>VERSION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VERSION&#160;&#160;&#160;&quot;0.92&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00034">34</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a7d259b9f2c7d45f4713e0c483d0fa25b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d259b9f2c7d45f4713e0c483d0fa25b">&#9670;&nbsp;</a></span>_start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int _start </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>IRX _start function </p><dl class="section return"><dt>Returns</dt><dd>zero on success</dd></dl>
<p>Initializes interrupts and the RPC thread. Oh, and greets the user. </p>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00538">538</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;{</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="keywordtype">int</span> err;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160; </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;audsrv: greetings from version &quot;</span> <a class="code" href="audsrv_8c.html#a1c6d5de492ac61ad29aec7aa9a436bbf">VERSION</a> <span class="stringliteral">&quot; !\n&quot;</span>);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        err = <a class="code" href="loadcore_8h.html#a2c521e294f194478fc1c99edc42be38c">RegisterLibraryEntries</a>(&amp;<a class="code" href="audsrv_8c.html#ad23dc209a0ea2d9b3b4db0f4fc741ed1">_exp_audsrv</a>);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        <span class="keywordflow">if</span> (err != 0)</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        {</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;audsrv: couldn&#39;t register library entries. Error %d\n&quot;</span>, err);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="loadcore_8h.html#a067c1c24977441fa17bdbfc659657fd6">MODULE_NO_RESIDENT_END</a>;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;        <a class="code" href="audsrv_8h.html#a7058f31efe4bd38e4d7d1a646d47c206">audsrv_adpcm_init</a>();</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="preprocessor">#ifndef NO_RPC_THREAD</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        <span class="comment">/* create RPC listener thread */</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <a class="code" href="sound_2audsrv_2src_2rpc__server_8c.html#a036f2ad911cd4ab4cf8596b57383c189">initialize_rpc_thread</a>();</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <span class="comment">/* call unittest, if available */</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        <a class="code" href="audsrv_8c.html#a48daaa0d3de94863970a8153910775a6">unittest_start</a>();</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="loadcore_8h.html#ab8f94884411e6a7622dfa010f554d5b1">MODULE_RESIDENT_END</a>;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;}</div>
<div class="ttc" id="aaudsrv_8c_html_a1c6d5de492ac61ad29aec7aa9a436bbf"><div class="ttname"><a href="audsrv_8c.html#a1c6d5de492ac61ad29aec7aa9a436bbf">VERSION</a></div><div class="ttdeci">#define VERSION</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8c_source.html#l00034">audsrv.c:34</a></div></div>
<div class="ttc" id="aaudsrv_8c_html_a48daaa0d3de94863970a8153910775a6"><div class="ttname"><a href="audsrv_8c.html#a48daaa0d3de94863970a8153910775a6">unittest_start</a></div><div class="ttdeci">void unittest_start()</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8c_source.html#l00528">audsrv.c:528</a></div></div>
<div class="ttc" id="aaudsrv_8c_html_ad23dc209a0ea2d9b3b4db0f4fc741ed1"><div class="ttname"><a href="audsrv_8c.html#ad23dc209a0ea2d9b3b4db0f4fc741ed1">_exp_audsrv</a></div><div class="ttdeci">struct irx_export_table _exp_audsrv</div></div>
<div class="ttc" id="aaudsrv_8h_html_a7058f31efe4bd38e4d7d1a646d47c206"><div class="ttname"><a href="audsrv_8h.html#a7058f31efe4bd38e4d7d1a646d47c206">audsrv_adpcm_init</a></div><div class="ttdeci">int audsrv_adpcm_init()</div><div class="ttdef"><b>Definition:</b> <a href="adpcm_8c_source.html#l00250">adpcm.c:250</a></div></div>
<div class="ttc" id="aloadcore_8h_html_a067c1c24977441fa17bdbfc659657fd6"><div class="ttname"><a href="loadcore_8h.html#a067c1c24977441fa17bdbfc659657fd6">MODULE_NO_RESIDENT_END</a></div><div class="ttdeci">#define MODULE_NO_RESIDENT_END</div><div class="ttdef"><b>Definition:</b> <a href="loadcore_8h_source.html#l00023">loadcore.h:23</a></div></div>
<div class="ttc" id="aloadcore_8h_html_a2c521e294f194478fc1c99edc42be38c"><div class="ttname"><a href="loadcore_8h.html#a2c521e294f194478fc1c99edc42be38c">RegisterLibraryEntries</a></div><div class="ttdeci">int RegisterLibraryEntries(struct irx_export_table *exports)</div></div>
<div class="ttc" id="aloadcore_8h_html_ab8f94884411e6a7622dfa010f554d5b1"><div class="ttname"><a href="loadcore_8h.html#ab8f94884411e6a7622dfa010f554d5b1">MODULE_RESIDENT_END</a></div><div class="ttdeci">#define MODULE_RESIDENT_END</div><div class="ttdef"><b>Definition:</b> <a href="loadcore_8h_source.html#l00022">loadcore.h:22</a></div></div>
<div class="ttc" id="asound_2audsrv_2src_2rpc__server_8c_html_a036f2ad911cd4ab4cf8596b57383c189"><div class="ttname"><a href="sound_2audsrv_2src_2rpc__server_8c.html#a036f2ad911cd4ab4cf8596b57383c189">initialize_rpc_thread</a></div><div class="ttdeci">int initialize_rpc_thread()</div><div class="ttdef"><b>Definition:</b> <a href="sound_2audsrv_2src_2rpc__server_8c_source.html#l00174">rpc_server.c:174</a></div></div>
<div class="ttc" id="astdio_8h_html_a98631211a4a8aee62f572375d5b637be"><div class="ttname"><a href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a></div><div class="ttdeci">int printf(const char *format,...)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="audsrv_8c.html#ad23dc209a0ea2d9b3b4db0f4fc741ed1">_exp_audsrv</a>, <a class="el" href="adpcm_8c_source.html#l00250">audsrv_adpcm_init()</a>, <a class="el" href="sound_2audsrv_2src_2rpc__server_8c_source.html#l00174">initialize_rpc_thread()</a>, <a class="el" href="loadcore_8h_source.html#l00023">MODULE_NO_RESIDENT_END</a>, <a class="el" href="loadcore_8h_source.html#l00022">MODULE_RESIDENT_END</a>, <a class="el" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf()</a>, <a class="el" href="loadcore_8h.html#a2c521e294f194478fc1c99edc42be38c">RegisterLibraryEntries()</a>, <a class="el" href="audsrv_8c_source.html#l00528">unittest_start()</a>, and <a class="el" href="audsrv_8c_source.html#l00034">VERSION</a>.</p>

</div>
</div>
<a id="a8cbc4efcabf1cacf0fc605d07c1b62c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8cbc4efcabf1cacf0fc605d07c1b62c5">&#9670;&nbsp;</a></span>audsrv_available()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int audsrv_available </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the number of bytes that can be queued </p><dl class="section return"><dt>Returns</dt><dd>sample count</dd></dl>
<p>Returns the number of bytes that are available in the ring buffer. This is the total bytes that can be queued, without collision of the reading head with the writing head. </p>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00274">274</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;{</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="audsrv_8c.html#a4f6eda090a2a7d35f235aa0db908ed15">writepos</a> &lt;= <a class="code" href="audsrv_8c.html#a6bf189efc18e1f2c352c562b85bf851f">readpos</a>)</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="audsrv_8c.html#a6bf189efc18e1f2c352c562b85bf851f">readpos</a> - <a class="code" href="audsrv_8c.html#a4f6eda090a2a7d35f235aa0db908ed15">writepos</a>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        {</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                <span class="keywordflow">return</span> (<a class="code" href="audsrv_8c.html#aa2fb3a6b652ed6dda27b5672372183ca">ringbuf_size</a> - (<a class="code" href="audsrv_8c.html#a4f6eda090a2a7d35f235aa0db908ed15">writepos</a> - <a class="code" href="audsrv_8c.html#a6bf189efc18e1f2c352c562b85bf851f">readpos</a>));</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;}</div>
<div class="ttc" id="aaudsrv_8c_html_a4f6eda090a2a7d35f235aa0db908ed15"><div class="ttname"><a href="audsrv_8c.html#a4f6eda090a2a7d35f235aa0db908ed15">writepos</a></div><div class="ttdeci">static int writepos</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8c_source.html#l00064">audsrv.c:64</a></div></div>
<div class="ttc" id="aaudsrv_8c_html_a6bf189efc18e1f2c352c562b85bf851f"><div class="ttname"><a href="audsrv_8c.html#a6bf189efc18e1f2c352c562b85bf851f">readpos</a></div><div class="ttdeci">static int readpos</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8c_source.html#l00062">audsrv.c:62</a></div></div>
<div class="ttc" id="aaudsrv_8c_html_aa2fb3a6b652ed6dda27b5672372183ca"><div class="ttname"><a href="audsrv_8c.html#aa2fb3a6b652ed6dda27b5672372183ca">ringbuf_size</a></div><div class="ttdeci">static int ringbuf_size</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8c_source.html#l00060">audsrv.c:60</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="audsrv_8c_source.html#l00062">readpos</a>, <a class="el" href="audsrv_8c_source.html#l00060">ringbuf_size</a>, and <a class="el" href="audsrv_8c_source.html#l00064">writepos</a>.</p>

<p class="reference">Referenced by <a class="el" href="audsrv_8c_source.html#l00323">audsrv_play_audio()</a>, <a class="el" href="audsrv_8c_source.html#l00293">audsrv_wait_audio()</a>, and <a class="el" href="audsrv_8c_source.html#l00408">play_thread()</a>.</p>

</div>
</div>
<a id="a90ea71b90d5163569fa5da7b3ad30c23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90ea71b90d5163569fa5da7b3ad30c23">&#9670;&nbsp;</a></span>audsrv_format_ok()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int audsrv_format_ok </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>freq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>channels</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Checks if the format noted by frequency and depth is supported</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">freq</td><td>frequency in hz </td></tr>
    <tr><td class="paramname">bits</td><td>bits per sample (8, 16) </td></tr>
    <tr><td class="paramname">channels</td><td>channels </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>positive on success, zero value on failure </dd></dl>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00152">152</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;{</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="upsamplers_8c.html#a080f1c6b8e59ac4baf325245d6607ee7">find_upsampler</a>(freq, bits, channels) != <a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="comment">/* unsupported format */</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;}</div>
<div class="ttc" id="adefs_8h_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="defs_8h_source.html#l00022">defs.h:22</a></div></div>
<div class="ttc" id="aupsamplers_8c_html_a080f1c6b8e59ac4baf325245d6607ee7"><div class="ttname"><a href="upsamplers_8c.html#a080f1c6b8e59ac4baf325245d6607ee7">find_upsampler</a></div><div class="ttdeci">upsampler_t find_upsampler(int freq, int bits, int channels)</div><div class="ttdef"><b>Definition:</b> <a href="upsamplers_8c_source.html#l00539">upsamplers.c:539</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="upsamplers_8c_source.html#l00539">find_upsampler()</a>, and <a class="el" href="defs_8h_source.html#l00022">NULL</a>.</p>

<p class="reference">Referenced by <a class="el" href="audsrv_8c_source.html#l00174">audsrv_set_format()</a>, and <a class="el" href="sound_2audsrv_2src_2rpc__server_8c_source.html#l00046">rpc_command()</a>.</p>

</div>
</div>
<a id="a39840d3595dac76a4636a371ea22363e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39840d3595dac76a4636a371ea22363e">&#9670;&nbsp;</a></span>audsrv_init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int audsrv_init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initializes audsrv library </p><dl class="section return"><dt>Returns</dt><dd>0 on success </dd></dl>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00215">215</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;{</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="audsrv_8c.html#ad06983e7f6e71b233ea7ff3dee1952f2">initialized</a>)</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="comment">/* initialize libsd */</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="spu2_8c.html#ace82ec081edae6108db8a814cd45de27">sceSdInit</a>(<a class="code" href="ahx__irx_8c.html#a55666fea1b2faee09fe9a371010b6473">SD_INIT_COLD</a>) &lt; 0)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;audsrv: failed to initialize libsd\n&quot;</span>);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        }</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <a class="code" href="audsrv_8c.html#a6bf189efc18e1f2c352c562b85bf851f">readpos</a> = 0;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <a class="code" href="audsrv_8c.html#a4f6eda090a2a7d35f235aa0db908ed15">writepos</a> = 0;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="comment">/* initialize transfer_complete&#39;s semaphore */</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <a class="code" href="audsrv_8c.html#ae538f96c6438e7b0ed26269a283afc09">transfer_sema</a> = <a class="code" href="thsemap_8h.html#a7c96e33204a7a6b31dea2349e6463e1c">CreateMutex</a>(0);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="audsrv_8c.html#ae538f96c6438e7b0ed26269a283afc09">transfer_sema</a> &lt; 0)</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="audsrv_8h.html#a3cb51eb032c89dad0542dbd49d9a7eea">AUDSRV_ERR_OUT_OF_MEMORY</a>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <a class="code" href="audsrv_8c.html#a7cd0ef0a782e1c8ca8147796e538a26a">queue_sema</a> = <a class="code" href="thsemap_8h.html#a7c96e33204a7a6b31dea2349e6463e1c">CreateMutex</a>(0);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="audsrv_8c.html#a7cd0ef0a782e1c8ca8147796e538a26a">queue_sema</a> &lt; 0)</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                <a class="code" href="thsemap_8h.html#aee7ad551c1fe522d76e545cfc2ac046c">DeleteSema</a>(<a class="code" href="audsrv_8c.html#ae538f96c6438e7b0ed26269a283afc09">transfer_sema</a>);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="audsrv_8h.html#a3cb51eb032c89dad0542dbd49d9a7eea">AUDSRV_ERR_OUT_OF_MEMORY</a>;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="comment">/* audio is always playing in the background. trick is to</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">         * set the data input volume to zero</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <a class="code" href="audsrv_8c.html#a74eb49da756be49fcd0eafee340c4bf3">audsrv_stop_audio</a>();</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="comment">/* initialize transfer-complete callback */</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <a class="code" href="spu2_8c.html#a90b260fc21ef93cf6789e93d423e82bc">sceSdSetTransCallback</a>(<a class="code" href="audsrv__internal_8h.html#afc40df38dddd64e383c749497ac64189">AUDSRV_BLOCK_DMA_CH</a>, (<span class="keywordtype">void</span> *)<a class="code" href="audsrv_8c.html#a8bcbc0994bd2a234b67ba334bba98374">transfer_complete</a>);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <a class="code" href="spu2_8c.html#a4b63f216977ffbebbb21bd24c9b3fea3">sceSdBlockTrans</a>(<a class="code" href="audsrv__internal_8h.html#afc40df38dddd64e383c749497ac64189">AUDSRV_BLOCK_DMA_CH</a>, <a class="code" href="libsd-common_8h.html#afeb1de49aad1f52516e103102a9a5b0c">SD_TRANS_LOOP</a>, <a class="code" href="audsrv_8c.html#a8239de91b01b86a813ab98ca78a98930">core1_buf</a>, <span class="keyword">sizeof</span>(<a class="code" href="audsrv_8c.html#a8239de91b01b86a813ab98ca78a98930">core1_buf</a>), 0);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="comment">/* default to SPU&#39;s native */</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <a class="code" href="audsrv_8c.html#a8f2fa483fb1e9ce5b55b48eca5d925d1">audsrv_set_format</a>(48000, 16, 2);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <a class="code" href="audsrv_8c.html#a0e9d895d9f970505d574ee19c1d26d19">play_tid</a> = <a class="code" href="common_8c.html#a90e2fae148f4296f2132f6cb4af4cb6d">create_thread</a>(<a class="code" href="audsrv_8c.html#addc7abfb9fc4d953e5e6bd5014948a3e">play_thread</a>, 39, 0);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;audsrv: playing thread 0x%x started\n&quot;</span>, <a class="code" href="audsrv_8c.html#a0e9d895d9f970505d574ee19c1d26d19">play_tid</a>);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160; </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;audsrv: kickstarted\n&quot;</span>);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <a class="code" href="audsrv_8c.html#ad06983e7f6e71b233ea7ff3dee1952f2">initialized</a> = 1;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="audsrv_8h.html#a50c703b30d2e69499418394f870a3eff">AUDSRV_ERR_NOERROR</a>;</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;}</div>
<div class="ttc" id="aahx__irx_8c_html_a55666fea1b2faee09fe9a371010b6473"><div class="ttname"><a href="ahx__irx_8c.html#a55666fea1b2faee09fe9a371010b6473">SD_INIT_COLD</a></div><div class="ttdeci">#define SD_INIT_COLD</div><div class="ttdef"><b>Definition:</b> <a href="ahx__irx_8c_source.html#l00025">ahx_irx.c:25</a></div></div>
<div class="ttc" id="aaudsrv_8c_html_a0e9d895d9f970505d574ee19c1d26d19"><div class="ttname"><a href="audsrv_8c.html#a0e9d895d9f970505d574ee19c1d26d19">play_tid</a></div><div class="ttdeci">static int play_tid</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8c_source.html#l00067">audsrv.c:67</a></div></div>
<div class="ttc" id="aaudsrv_8c_html_a74eb49da756be49fcd0eafee340c4bf3"><div class="ttname"><a href="audsrv_8c.html#a74eb49da756be49fcd0eafee340c4bf3">audsrv_stop_audio</a></div><div class="ttdeci">int audsrv_stop_audio()</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8c_source.html#l00135">audsrv.c:135</a></div></div>
<div class="ttc" id="aaudsrv_8c_html_a7cd0ef0a782e1c8ca8147796e538a26a"><div class="ttname"><a href="audsrv_8c.html#a7cd0ef0a782e1c8ca8147796e538a26a">queue_sema</a></div><div class="ttdeci">static int queue_sema</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8c_source.html#l00069">audsrv.c:69</a></div></div>
<div class="ttc" id="aaudsrv_8c_html_a8239de91b01b86a813ab98ca78a98930"><div class="ttname"><a href="audsrv_8c.html#a8239de91b01b86a813ab98ca78a98930">core1_buf</a></div><div class="ttdeci">static u8 core1_buf[0x1000]</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8c_source.html#l00079">audsrv.c:79</a></div></div>
<div class="ttc" id="aaudsrv_8c_html_a8bcbc0994bd2a234b67ba334bba98374"><div class="ttname"><a href="audsrv_8c.html#a8bcbc0994bd2a234b67ba334bba98374">transfer_complete</a></div><div class="ttdeci">static int transfer_complete(void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8c_source.html#l00097">audsrv.c:97</a></div></div>
<div class="ttc" id="aaudsrv_8c_html_a8f2fa483fb1e9ce5b55b48eca5d925d1"><div class="ttname"><a href="audsrv_8c.html#a8f2fa483fb1e9ce5b55b48eca5d925d1">audsrv_set_format</a></div><div class="ttdeci">int audsrv_set_format(int freq, int bits, int channels)</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8c_source.html#l00174">audsrv.c:174</a></div></div>
<div class="ttc" id="aaudsrv_8c_html_ad06983e7f6e71b233ea7ff3dee1952f2"><div class="ttname"><a href="audsrv_8c.html#ad06983e7f6e71b233ea7ff3dee1952f2">initialized</a></div><div class="ttdeci">static int initialized</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8c_source.html#l00051">audsrv.c:51</a></div></div>
<div class="ttc" id="aaudsrv_8c_html_addc7abfb9fc4d953e5e6bd5014948a3e"><div class="ttname"><a href="audsrv_8c.html#addc7abfb9fc4d953e5e6bd5014948a3e">play_thread</a></div><div class="ttdeci">static void play_thread(void *arg)</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8c_source.html#l00408">audsrv.c:408</a></div></div>
<div class="ttc" id="aaudsrv_8c_html_ae538f96c6438e7b0ed26269a283afc09"><div class="ttname"><a href="audsrv_8c.html#ae538f96c6438e7b0ed26269a283afc09">transfer_sema</a></div><div class="ttdeci">static int transfer_sema</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8c_source.html#l00071">audsrv.c:71</a></div></div>
<div class="ttc" id="aaudsrv_8h_html_a3cb51eb032c89dad0542dbd49d9a7eea"><div class="ttname"><a href="audsrv_8h.html#a3cb51eb032c89dad0542dbd49d9a7eea">AUDSRV_ERR_OUT_OF_MEMORY</a></div><div class="ttdeci">#define AUDSRV_ERR_OUT_OF_MEMORY</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8h_source.html#l00060">audsrv.h:60</a></div></div>
<div class="ttc" id="aaudsrv_8h_html_a50c703b30d2e69499418394f870a3eff"><div class="ttname"><a href="audsrv_8h.html#a50c703b30d2e69499418394f870a3eff">AUDSRV_ERR_NOERROR</a></div><div class="ttdeci">#define AUDSRV_ERR_NOERROR</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8h_source.html#l00056">audsrv.h:56</a></div></div>
<div class="ttc" id="aaudsrv__internal_8h_html_afc40df38dddd64e383c749497ac64189"><div class="ttname"><a href="audsrv__internal_8h.html#afc40df38dddd64e383c749497ac64189">AUDSRV_BLOCK_DMA_CH</a></div><div class="ttdeci">#define AUDSRV_BLOCK_DMA_CH</div><div class="ttdef"><b>Definition:</b> <a href="audsrv__internal_8h_source.html#l00026">audsrv_internal.h:26</a></div></div>
<div class="ttc" id="acommon_8c_html_a90e2fae148f4296f2132f6cb4af4cb6d"><div class="ttname"><a href="common_8c.html#a90e2fae148f4296f2132f6cb4af4cb6d">create_thread</a></div><div class="ttdeci">int create_thread(void *func, int priority, void *param)</div><div class="ttdef"><b>Definition:</b> <a href="common_8c_source.html#l00034">common.c:34</a></div></div>
<div class="ttc" id="alibsd-common_8h_html_afeb1de49aad1f52516e103102a9a5b0c"><div class="ttname"><a href="libsd-common_8h.html#afeb1de49aad1f52516e103102a9a5b0c">SD_TRANS_LOOP</a></div><div class="ttdeci">#define SD_TRANS_LOOP</div><div class="ttdef"><b>Definition:</b> <a href="libsd-common_8h_source.html#l00051">libsd-common.h:51</a></div></div>
<div class="ttc" id="aspu2_8c_html_a4b63f216977ffbebbb21bd24c9b3fea3"><div class="ttname"><a href="spu2_8c.html#a4b63f216977ffbebbb21bd24c9b3fea3">sceSdBlockTrans</a></div><div class="ttdeci">int sceSdBlockTrans(s16 chan, u16 mode, u8 *iopaddr, u32 size,...)</div><div class="ttdef"><b>Definition:</b> <a href="spu2_8c_source.html#l00745">spu2.c:745</a></div></div>
<div class="ttc" id="aspu2_8c_html_a90b260fc21ef93cf6789e93d423e82bc"><div class="ttname"><a href="spu2_8c.html#a90b260fc21ef93cf6789e93d423e82bc">sceSdSetTransCallback</a></div><div class="ttdeci">SdIntrCallback sceSdSetTransCallback(s32 core, SdIntrCallback cb)</div><div class="ttdef"><b>Definition:</b> <a href="spu2_8c_source.html#l00577">spu2.c:577</a></div></div>
<div class="ttc" id="aspu2_8c_html_ace82ec081edae6108db8a814cd45de27"><div class="ttname"><a href="spu2_8c.html#ace82ec081edae6108db8a814cd45de27">sceSdInit</a></div><div class="ttdeci">int sceSdInit(int flag)</div><div class="ttdef"><b>Definition:</b> <a href="spu2_8c_source.html#l00417">spu2.c:417</a></div></div>
<div class="ttc" id="athsemap_8h_html_a7c96e33204a7a6b31dea2349e6463e1c"><div class="ttname"><a href="thsemap_8h.html#a7c96e33204a7a6b31dea2349e6463e1c">CreateMutex</a></div><div class="ttdeci">static int CreateMutex(int state)</div><div class="ttdef"><b>Definition:</b> <a href="thsemap_8h_source.html#l00065">thsemap.h:65</a></div></div>
<div class="ttc" id="athsemap_8h_html_aee7ad551c1fe522d76e545cfc2ac046c"><div class="ttname"><a href="thsemap_8h.html#aee7ad551c1fe522d76e545cfc2ac046c">DeleteSema</a></div><div class="ttdeci">int DeleteSema(int semid)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="audsrv__internal_8h_source.html#l00026">AUDSRV_BLOCK_DMA_CH</a>, <a class="el" href="audsrv_8h_source.html#l00056">AUDSRV_ERR_NOERROR</a>, <a class="el" href="audsrv_8h_source.html#l00060">AUDSRV_ERR_OUT_OF_MEMORY</a>, <a class="el" href="audsrv_8c_source.html#l00174">audsrv_set_format()</a>, <a class="el" href="audsrv_8c_source.html#l00135">audsrv_stop_audio()</a>, <a class="el" href="audsrv_8c_source.html#l00079">core1_buf</a>, <a class="el" href="common_8c_source.html#l00034">create_thread()</a>, <a class="el" href="thsemap_8h_source.html#l00065">CreateMutex()</a>, <a class="el" href="thsemap_8h.html#aee7ad551c1fe522d76e545cfc2ac046c">DeleteSema()</a>, <a class="el" href="audsrv_8c_source.html#l00051">initialized</a>, <a class="el" href="audsrv_8c_source.html#l00408">play_thread()</a>, <a class="el" href="audsrv_8c_source.html#l00067">play_tid</a>, <a class="el" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf()</a>, <a class="el" href="audsrv_8c_source.html#l00069">queue_sema</a>, <a class="el" href="audsrv_8c_source.html#l00062">readpos</a>, <a class="el" href="spu2_8c_source.html#l00745">sceSdBlockTrans()</a>, <a class="el" href="spu2_8c_source.html#l00417">sceSdInit()</a>, <a class="el" href="spu2_8c_source.html#l00577">sceSdSetTransCallback()</a>, <a class="el" href="ahx__irx_8c_source.html#l00025">SD_INIT_COLD</a>, <a class="el" href="libsd-common_8h_source.html#l00051">SD_TRANS_LOOP</a>, <a class="el" href="audsrv_8c_source.html#l00097">transfer_complete()</a>, <a class="el" href="audsrv_8c_source.html#l00071">transfer_sema</a>, and <a class="el" href="audsrv_8c_source.html#l00064">writepos</a>.</p>

<p class="reference">Referenced by <a class="el" href="sound_2audsrv_2src_2rpc__server_8c_source.html#l00046">rpc_command()</a>.</p>

</div>
</div>
<a id="adc83c5941bfa150bf8adb821f92f3ae8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc83c5941bfa150bf8adb821f92f3ae8">&#9670;&nbsp;</a></span>audsrv_play_audio()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int audsrv_play_audio </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>buflen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Uploads audio buffer to SPU </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td>audio chunk </td></tr>
    <tr><td class="paramname">buflen</td><td>size of chunk in bytes </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>positive number of bytes sent to processor or negative error status</dd></dl>
<p>Plays an audio buffer; It will not interrupt a playing buffer, rather queue it up and play it as soon as possible without interfering with fluent streaming. The buffer and buflen are given in host format (i.e, 11025hz 8bit stereo.) </p>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00323">323</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;{</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keywordtype">int</span> sent = 0;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="audsrv_8c.html#ad06983e7f6e71b233ea7ff3dee1952f2">initialized</a> == 0)</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                <span class="keywordflow">return</span> -<a class="code" href="audsrv_8h.html#a4a96c290ab15d76584b3c45b113c6f17">AUDSRV_ERR_NOT_INITIALIZED</a>;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="audsrv_8c.html#a35fd1e3b4b7aa595eca11a2b9d953c31">playing</a> == 0)</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                <span class="comment">/* audio is always playing, just change the volume */</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                <a class="code" href="audsrv_8c.html#a35fd1e3b4b7aa595eca11a2b9d953c31">playing</a> = 1;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                <a class="code" href="audsrv_8c.html#aa3b9ac75129aa004ecb1215bdc7b6264">update_volume</a>();</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        }</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        <span class="comment">//printf(&quot;play audio %d bytes, readpos %d, writepos %d avail %d\n&quot;, buflen, readpos, writepos, audsrv_available());</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="comment">/* limit to what&#39;s available, no crossing possible */</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        buflen = <a class="code" href="fileXio__iop_8c.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(buflen, <a class="code" href="audsrv_8c.html#a8cbc4efcabf1cacf0fc605d07c1b62c5">audsrv_available</a>());</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keywordflow">while</span> (buflen &gt; 0)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                <span class="keywordtype">int</span> copy = buflen;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="audsrv_8c.html#a4f6eda090a2a7d35f235aa0db908ed15">writepos</a> &gt;= <a class="code" href="audsrv_8c.html#a6bf189efc18e1f2c352c562b85bf851f">readpos</a>)</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                        copy = <a class="code" href="fileXio__iop_8c.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a>(<a class="code" href="audsrv_8c.html#aa2fb3a6b652ed6dda27b5672372183ca">ringbuf_size</a> - <a class="code" href="audsrv_8c.html#a4f6eda090a2a7d35f235aa0db908ed15">writepos</a>, buflen);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                }</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                <a class="code" href="sysclib_8h.html#ad1b7311b48288a0d08172f26ff64dd67">memcpy</a>(<a class="code" href="audsrv_8c.html#a5b54b44595bb0afc505dba9ddc6a4e26">ringbuf</a> + <a class="code" href="audsrv_8c.html#a4f6eda090a2a7d35f235aa0db908ed15">writepos</a>, buf, copy);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                buf = buf + copy;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                buflen = buflen - copy;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                sent = sent + copy;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                <a class="code" href="audsrv_8c.html#a4f6eda090a2a7d35f235aa0db908ed15">writepos</a> = <a class="code" href="audsrv_8c.html#a4f6eda090a2a7d35f235aa0db908ed15">writepos</a> + copy;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="audsrv_8c.html#a4f6eda090a2a7d35f235aa0db908ed15">writepos</a> &gt;= <a class="code" href="audsrv_8c.html#aa2fb3a6b652ed6dda27b5672372183ca">ringbuf_size</a>)</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                        <span class="comment">/* rewind */</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                        <a class="code" href="audsrv_8c.html#a4f6eda090a2a7d35f235aa0db908ed15">writepos</a> = 0;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                }</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="keywordflow">return</span> sent;</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;}</div>
<div class="ttc" id="aaudsrv_8c_html_a35fd1e3b4b7aa595eca11a2b9d953c31"><div class="ttname"><a href="audsrv_8c.html#a35fd1e3b4b7aa595eca11a2b9d953c31">playing</a></div><div class="ttdeci">static int playing</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8c_source.html#l00053">audsrv.c:53</a></div></div>
<div class="ttc" id="aaudsrv_8c_html_a5b54b44595bb0afc505dba9ddc6a4e26"><div class="ttname"><a href="audsrv_8c.html#a5b54b44595bb0afc505dba9ddc6a4e26">ringbuf</a></div><div class="ttdeci">static char ringbuf[20480]</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8c_source.html#l00058">audsrv.c:58</a></div></div>
<div class="ttc" id="aaudsrv_8c_html_a8cbc4efcabf1cacf0fc605d07c1b62c5"><div class="ttname"><a href="audsrv_8c.html#a8cbc4efcabf1cacf0fc605d07c1b62c5">audsrv_available</a></div><div class="ttdeci">int audsrv_available()</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8c_source.html#l00274">audsrv.c:274</a></div></div>
<div class="ttc" id="aaudsrv_8c_html_aa3b9ac75129aa004ecb1215bdc7b6264"><div class="ttname"><a href="audsrv_8c.html#aa3b9ac75129aa004ecb1215bdc7b6264">update_volume</a></div><div class="ttdeci">static void update_volume()</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8c_source.html#l00104">audsrv.c:104</a></div></div>
<div class="ttc" id="aaudsrv_8h_html_a4a96c290ab15d76584b3c45b113c6f17"><div class="ttname"><a href="audsrv_8h.html#a4a96c290ab15d76584b3c45b113c6f17">AUDSRV_ERR_NOT_INITIALIZED</a></div><div class="ttdeci">#define AUDSRV_ERR_NOT_INITIALIZED</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8h_source.html#l00057">audsrv.h:57</a></div></div>
<div class="ttc" id="afileXio__iop_8c_html_a3acffbd305ee72dcd4593c0d8af64a4f"><div class="ttname"><a href="fileXio__iop_8c.html#a3acffbd305ee72dcd4593c0d8af64a4f">MIN</a></div><div class="ttdeci">#define MIN(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="fileXio__iop_8c_source.html#l00039">fileXio_iop.c:39</a></div></div>
<div class="ttc" id="asysclib_8h_html_ad1b7311b48288a0d08172f26ff64dd67"><div class="ttname"><a href="sysclib_8h.html#ad1b7311b48288a0d08172f26ff64dd67">memcpy</a></div><div class="ttdeci">void * memcpy(void *dest, const void *src, size_t size)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="audsrv_8c_source.html#l00274">audsrv_available()</a>, <a class="el" href="audsrv_8h_source.html#l00057">AUDSRV_ERR_NOT_INITIALIZED</a>, <a class="el" href="audsrv_8c_source.html#l00051">initialized</a>, <a class="el" href="sysclib_8h.html#ad1b7311b48288a0d08172f26ff64dd67">memcpy()</a>, <a class="el" href="fileXio__iop_8c_source.html#l00039">MIN</a>, <a class="el" href="audsrv_8c_source.html#l00053">playing</a>, <a class="el" href="audsrv_8c_source.html#l00062">readpos</a>, <a class="el" href="audsrv_8c_source.html#l00058">ringbuf</a>, <a class="el" href="audsrv_8c_source.html#l00060">ringbuf_size</a>, <a class="el" href="audsrv_8c_source.html#l00104">update_volume()</a>, and <a class="el" href="audsrv_8c_source.html#l00064">writepos</a>.</p>

<p class="reference">Referenced by <a class="el" href="sound_2audsrv_2src_2rpc__server_8c_source.html#l00046">rpc_command()</a>.</p>

</div>
</div>
<a id="af96a6cbe0fcfc100127b49184d4480a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af96a6cbe0fcfc100127b49184d4480a2">&#9670;&nbsp;</a></span>audsrv_quit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int audsrv_quit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Shutdowns audsrv </p><dl class="section return"><dt>Returns</dt><dd>AUDSRV_ERR_NOERROR </dd></dl>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00488">488</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;{</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="comment">/* silence! */</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <a class="code" href="audsrv_8c.html#a74eb49da756be49fcd0eafee340c4bf3">audsrv_stop_audio</a>();</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <a class="code" href="audsrv_8h.html#ace8f3e7b23e37ea21800e83d83b12b7f">audsrv_stop_cd</a>();</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        <a class="code" href="audsrv_8h.html#a7058f31efe4bd38e4d7d1a646d47c206">audsrv_adpcm_init</a>();</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <span class="comment">/* stop transmission */</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <a class="code" href="spu2_8c.html#a90b260fc21ef93cf6789e93d423e82bc">sceSdSetTransCallback</a>(<a class="code" href="audsrv__internal_8h.html#afc40df38dddd64e383c749497ac64189">AUDSRV_BLOCK_DMA_CH</a>, <a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <a class="code" href="spu2_8c.html#a4b63f216977ffbebbb21bd24c9b3fea3">sceSdBlockTrans</a>(<a class="code" href="audsrv__internal_8h.html#afc40df38dddd64e383c749497ac64189">AUDSRV_BLOCK_DMA_CH</a>, <a class="code" href="libsd-common_8h.html#a70f162890bbfebfc933f9748366ad618">SD_TRANS_STOP</a>, 0, 0, 0);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <span class="comment">/* stop playing thread */</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="audsrv_8c.html#a0e9d895d9f970505d574ee19c1d26d19">play_tid</a> &gt; 0)</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        {</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                <a class="code" href="thbase_8h.html#abec33163c1290d55979d50b140888deb">TerminateThread</a>(<a class="code" href="audsrv_8c.html#a0e9d895d9f970505d574ee19c1d26d19">play_tid</a>);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                <a class="code" href="thbase_8h.html#a1600ea5c145936a291af42006f7aa4a8">DeleteThread</a>(<a class="code" href="audsrv_8c.html#a0e9d895d9f970505d574ee19c1d26d19">play_tid</a>);</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                <a class="code" href="audsrv_8c.html#a0e9d895d9f970505d574ee19c1d26d19">play_tid</a> = 0;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        }</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160; </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="preprocessor">#ifndef NO_RPC_THREAD</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="comment">/* Deinitialize RPC client, only once the playback thread is stopped. */</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <a class="code" href="sound_2audsrv_2src_2rpc__client_8c.html#af1f43156785560f5b772714fd5edf242">deinitialize_rpc_client</a>();</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="audsrv_8c.html#ae538f96c6438e7b0ed26269a283afc09">transfer_sema</a> &gt; 0)</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        {</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                <a class="code" href="thsemap_8h.html#aee7ad551c1fe522d76e545cfc2ac046c">DeleteSema</a>(<a class="code" href="audsrv_8c.html#ae538f96c6438e7b0ed26269a283afc09">transfer_sema</a>);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                <a class="code" href="audsrv_8c.html#ae538f96c6438e7b0ed26269a283afc09">transfer_sema</a> = 0;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        }</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="audsrv_8c.html#a7cd0ef0a782e1c8ca8147796e538a26a">queue_sema</a> &gt; 0)</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                <a class="code" href="thsemap_8h.html#aee7ad551c1fe522d76e545cfc2ac046c">DeleteSema</a>(<a class="code" href="audsrv_8c.html#a7cd0ef0a782e1c8ca8147796e538a26a">queue_sema</a>);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                <a class="code" href="audsrv_8c.html#a7cd0ef0a782e1c8ca8147796e538a26a">queue_sema</a> = 0;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        }</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;}</div>
<div class="ttc" id="aaudsrv_8h_html_ace8f3e7b23e37ea21800e83d83b12b7f"><div class="ttname"><a href="audsrv_8h.html#ace8f3e7b23e37ea21800e83d83b12b7f">audsrv_stop_cd</a></div><div class="ttdeci">int audsrv_stop_cd()</div><div class="ttdef"><b>Definition:</b> <a href="cdrom_8c_source.html#l00557">cdrom.c:557</a></div></div>
<div class="ttc" id="alibsd-common_8h_html_a70f162890bbfebfc933f9748366ad618"><div class="ttname"><a href="libsd-common_8h.html#a70f162890bbfebfc933f9748366ad618">SD_TRANS_STOP</a></div><div class="ttdeci">#define SD_TRANS_STOP</div><div class="ttdef"><b>Definition:</b> <a href="libsd-common_8h_source.html#l00049">libsd-common.h:49</a></div></div>
<div class="ttc" id="asound_2audsrv_2src_2rpc__client_8c_html_af1f43156785560f5b772714fd5edf242"><div class="ttname"><a href="sound_2audsrv_2src_2rpc__client_8c.html#af1f43156785560f5b772714fd5edf242">deinitialize_rpc_client</a></div><div class="ttdeci">void deinitialize_rpc_client(void)</div><div class="ttdef"><b>Definition:</b> <a href="sound_2audsrv_2src_2rpc__client_8c_source.html#l00026">rpc_client.c:26</a></div></div>
<div class="ttc" id="athbase_8h_html_a1600ea5c145936a291af42006f7aa4a8"><div class="ttname"><a href="thbase_8h.html#a1600ea5c145936a291af42006f7aa4a8">DeleteThread</a></div><div class="ttdeci">int DeleteThread(int thid)</div></div>
<div class="ttc" id="athbase_8h_html_abec33163c1290d55979d50b140888deb"><div class="ttname"><a href="thbase_8h.html#abec33163c1290d55979d50b140888deb">TerminateThread</a></div><div class="ttdeci">int TerminateThread(int thid)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="adpcm_8c_source.html#l00250">audsrv_adpcm_init()</a>, <a class="el" href="audsrv__internal_8h_source.html#l00026">AUDSRV_BLOCK_DMA_CH</a>, <a class="el" href="audsrv_8c_source.html#l00135">audsrv_stop_audio()</a>, <a class="el" href="cdrom_8c_source.html#l00557">audsrv_stop_cd()</a>, <a class="el" href="sound_2audsrv_2src_2rpc__client_8c_source.html#l00026">deinitialize_rpc_client()</a>, <a class="el" href="thsemap_8h.html#aee7ad551c1fe522d76e545cfc2ac046c">DeleteSema()</a>, <a class="el" href="thbase_8h.html#a1600ea5c145936a291af42006f7aa4a8">DeleteThread()</a>, <a class="el" href="defs_8h_source.html#l00022">NULL</a>, <a class="el" href="audsrv_8c_source.html#l00067">play_tid</a>, <a class="el" href="audsrv_8c_source.html#l00069">queue_sema</a>, <a class="el" href="spu2_8c_source.html#l00745">sceSdBlockTrans()</a>, <a class="el" href="spu2_8c_source.html#l00577">sceSdSetTransCallback()</a>, <a class="el" href="libsd-common_8h_source.html#l00049">SD_TRANS_STOP</a>, <a class="el" href="thbase_8h.html#abec33163c1290d55979d50b140888deb">TerminateThread()</a>, and <a class="el" href="audsrv_8c_source.html#l00071">transfer_sema</a>.</p>

<p class="reference">Referenced by <a class="el" href="sound_2audsrv_2src_2rpc__server_8c_source.html#l00046">rpc_command()</a>.</p>

</div>
</div>
<a id="a8f2fa483fb1e9ce5b55b48eca5d925d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f2fa483fb1e9ce5b55b48eca5d925d1">&#9670;&nbsp;</a></span>audsrv_set_format()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int audsrv_set_format </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>freq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>channels</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Configures audio stream </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">freq</td><td>frequency in hz </td></tr>
    <tr><td class="paramname">bits</td><td>bits per sample (8, 16) </td></tr>
    <tr><td class="paramname">channels</td><td>number of channels </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, negative if configuration is not supported</dd></dl>
<p>This sets up audsrv to accept stream in this format and convert it to SPU2's native format if required. Note: it is possible to change the format at any point. You might want to stop audio prior to that, to prevent mismatched audio output. </p>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00174">174</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;{</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordtype">int</span> feed_size;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="audsrv_8c.html#a90ea71b90d5163569fa5da7b3ad30c23">audsrv_format_ok</a>(freq, bits, channels) == 0)</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                <span class="keywordflow">return</span> -<a class="code" href="audsrv_8h.html#a269f49eb7c42ac9be6117813c8b9b7e4">AUDSRV_ERR_FORMAT_NOT_SUPPORTED</a>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        }</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="comment">/* update shift-right count */</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <a class="code" href="audsrv_8c.html#a78383d9f30a7cb3d6f4fe07973c7d69a">core1_sample_shift</a> = 0;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordflow">if</span> (bits == 16)</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                <a class="code" href="audsrv_8c.html#a78383d9f30a7cb3d6f4fe07973c7d69a">core1_sample_shift</a>++;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keywordflow">if</span> (channels == 2)</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                <a class="code" href="audsrv_8c.html#a78383d9f30a7cb3d6f4fe07973c7d69a">core1_sample_shift</a>++;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <a class="code" href="audsrv_8c.html#ac273d1740f99ea0b6a7a4b3735ecdfa0">core1_freq</a> = freq;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <a class="code" href="audsrv_8c.html#acfe400051687fd6e8c158ac22d509ae6">core1_bits</a> = bits;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <a class="code" href="audsrv_8c.html#a3168c7f7f22624aa7906c9b47bacbd30">core1_channels</a> = channels;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="comment">/* set ring buffer size to 10 iterations worth of data (~50 ms) */</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        feed_size = ((512 * <a class="code" href="audsrv_8c.html#ac273d1740f99ea0b6a7a4b3735ecdfa0">core1_freq</a>) / 48000) &lt;&lt; <a class="code" href="audsrv_8c.html#a78383d9f30a7cb3d6f4fe07973c7d69a">core1_sample_shift</a>;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <a class="code" href="audsrv_8c.html#aa2fb3a6b652ed6dda27b5672372183ca">ringbuf_size</a> = feed_size * 10;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <a class="code" href="audsrv_8c.html#a4f6eda090a2a7d35f235aa0db908ed15">writepos</a> = 0;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <a class="code" href="audsrv_8c.html#a6bf189efc18e1f2c352c562b85bf851f">readpos</a> = (feed_size * 5) &amp; ~3;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;audsrv: freq %d bits %d channels %d ringbuf_sz %d feed_size %d shift %d\n&quot;</span>, freq, bits, channels, <a class="code" href="audsrv_8c.html#aa2fb3a6b652ed6dda27b5672372183ca">ringbuf_size</a>, feed_size, <a class="code" href="audsrv_8c.html#a78383d9f30a7cb3d6f4fe07973c7d69a">core1_sample_shift</a>);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        <a class="code" href="audsrv_8c.html#aaeab2fdb9a7b3830fdfa6cdc781c1f9e">format_changed</a> = 1;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="audsrv_8h.html#a50c703b30d2e69499418394f870a3eff">AUDSRV_ERR_NOERROR</a>;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;}</div>
<div class="ttc" id="aaudsrv_8c_html_a3168c7f7f22624aa7906c9b47bacbd30"><div class="ttname"><a href="audsrv_8c.html#a3168c7f7f22624aa7906c9b47bacbd30">core1_channels</a></div><div class="ttdeci">static int core1_channels</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8c_source.html#l00045">audsrv.c:45</a></div></div>
<div class="ttc" id="aaudsrv_8c_html_a78383d9f30a7cb3d6f4fe07973c7d69a"><div class="ttname"><a href="audsrv_8c.html#a78383d9f30a7cb3d6f4fe07973c7d69a">core1_sample_shift</a></div><div class="ttdeci">static int core1_sample_shift</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8c_source.html#l00047">audsrv.c:47</a></div></div>
<div class="ttc" id="aaudsrv_8c_html_a90ea71b90d5163569fa5da7b3ad30c23"><div class="ttname"><a href="audsrv_8c.html#a90ea71b90d5163569fa5da7b3ad30c23">audsrv_format_ok</a></div><div class="ttdeci">int audsrv_format_ok(int freq, int bits, int channels)</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8c_source.html#l00152">audsrv.c:152</a></div></div>
<div class="ttc" id="aaudsrv_8c_html_aaeab2fdb9a7b3830fdfa6cdc781c1f9e"><div class="ttname"><a href="audsrv_8c.html#aaeab2fdb9a7b3830fdfa6cdc781c1f9e">format_changed</a></div><div class="ttdeci">static int format_changed</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8c_source.html#l00076">audsrv.c:76</a></div></div>
<div class="ttc" id="aaudsrv_8c_html_ac273d1740f99ea0b6a7a4b3735ecdfa0"><div class="ttname"><a href="audsrv_8c.html#ac273d1740f99ea0b6a7a4b3735ecdfa0">core1_freq</a></div><div class="ttdeci">static int core1_freq</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8c_source.html#l00041">audsrv.c:41</a></div></div>
<div class="ttc" id="aaudsrv_8c_html_acfe400051687fd6e8c158ac22d509ae6"><div class="ttname"><a href="audsrv_8c.html#acfe400051687fd6e8c158ac22d509ae6">core1_bits</a></div><div class="ttdeci">static int core1_bits</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8c_source.html#l00043">audsrv.c:43</a></div></div>
<div class="ttc" id="aaudsrv_8h_html_a269f49eb7c42ac9be6117813c8b9b7e4"><div class="ttname"><a href="audsrv_8h.html#a269f49eb7c42ac9be6117813c8b9b7e4">AUDSRV_ERR_FORMAT_NOT_SUPPORTED</a></div><div class="ttdeci">#define AUDSRV_ERR_FORMAT_NOT_SUPPORTED</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8h_source.html#l00059">audsrv.h:59</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="audsrv_8h_source.html#l00059">AUDSRV_ERR_FORMAT_NOT_SUPPORTED</a>, <a class="el" href="audsrv_8h_source.html#l00056">AUDSRV_ERR_NOERROR</a>, <a class="el" href="audsrv_8c_source.html#l00152">audsrv_format_ok()</a>, <a class="el" href="audsrv_8c_source.html#l00043">core1_bits</a>, <a class="el" href="audsrv_8c_source.html#l00045">core1_channels</a>, <a class="el" href="audsrv_8c_source.html#l00041">core1_freq</a>, <a class="el" href="audsrv_8c_source.html#l00047">core1_sample_shift</a>, <a class="el" href="audsrv_8c_source.html#l00076">format_changed</a>, <a class="el" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf()</a>, <a class="el" href="audsrv_8c_source.html#l00062">readpos</a>, <a class="el" href="audsrv_8c_source.html#l00060">ringbuf_size</a>, and <a class="el" href="audsrv_8c_source.html#l00064">writepos</a>.</p>

<p class="reference">Referenced by <a class="el" href="audsrv_8c_source.html#l00215">audsrv_init()</a>, and <a class="el" href="sound_2audsrv_2src_2rpc__server_8c_source.html#l00046">rpc_command()</a>.</p>

</div>
</div>
<a id="a1a25ac3a1b590c27f4d096d4d6cadb00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a25ac3a1b590c27f4d096d4d6cadb00">&#9670;&nbsp;</a></span>audsrv_set_threshold()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int audsrv_set_threshold </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>amount</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00385">385</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;{</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="keywordflow">if</span> (amount &gt; (<a class="code" href="audsrv_8c.html#aa2fb3a6b652ed6dda27b5672372183ca">ringbuf_size</a> / 2))</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                <span class="comment">/* amount is greater than what we&#39;d recommend */</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="audsrv_8h.html#a25370175ccf23d229b87cf133d4ee9a1">AUDSRV_ERR_ARGS</a>;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;audsrv: callback threshold: %d\n&quot;</span>, amount);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <a class="code" href="audsrv_8c.html#a56a7783a6416e54a779e0e2ffc31fadd">fillbuf_threshold</a> = amount;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;}</div>
<div class="ttc" id="aaudsrv_8c_html_a56a7783a6416e54a779e0e2ffc31fadd"><div class="ttname"><a href="audsrv_8c.html#a56a7783a6416e54a779e0e2ffc31fadd">fillbuf_threshold</a></div><div class="ttdeci">static int fillbuf_threshold</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8c_source.html#l00073">audsrv.c:73</a></div></div>
<div class="ttc" id="aaudsrv_8h_html_a25370175ccf23d229b87cf133d4ee9a1"><div class="ttname"><a href="audsrv_8h.html#a25370175ccf23d229b87cf133d4ee9a1">AUDSRV_ERR_ARGS</a></div><div class="ttdeci">#define AUDSRV_ERR_ARGS</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8h_source.html#l00061">audsrv.h:61</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="audsrv_8h_source.html#l00061">AUDSRV_ERR_ARGS</a>, <a class="el" href="audsrv_8c_source.html#l00073">fillbuf_threshold</a>, <a class="el" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf()</a>, and <a class="el" href="audsrv_8c_source.html#l00060">ringbuf_size</a>.</p>

<p class="reference">Referenced by <a class="el" href="sound_2audsrv_2src_2rpc__server_8c_source.html#l00046">rpc_command()</a>.</p>

</div>
</div>
<a id="a1b1e932fab3e35b04cbf4c651d3a818e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b1e932fab3e35b04cbf4c651d3a818e">&#9670;&nbsp;</a></span>audsrv_set_volume()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int audsrv_set_volume </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>vol</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Sets output volume </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vol</td><td>volume in SPU2 units [0 .. 0x3fff] </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success, negative otherwise </dd></dl>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00372">372</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;{</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="keywordflow">if</span> (vol &lt; 0 || vol &gt; <a class="code" href="spu_8h.html#a7ed6a6db7ec466a04b820f3de267708a">MAX_VOLUME</a>)</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                <span class="comment">/* bad joke */</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="audsrv_8h.html#a25370175ccf23d229b87cf133d4ee9a1">AUDSRV_ERR_ARGS</a>;</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        }</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <a class="code" href="audsrv_8c.html#a69da40149fa83da89f0af9681a6eeeac">core1_volume</a> = vol;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <a class="code" href="audsrv_8c.html#aa3b9ac75129aa004ecb1215bdc7b6264">update_volume</a>();</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="audsrv_8h.html#a50c703b30d2e69499418394f870a3eff">AUDSRV_ERR_NOERROR</a>;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;}</div>
<div class="ttc" id="aaudsrv_8c_html_a69da40149fa83da89f0af9681a6eeeac"><div class="ttname"><a href="audsrv_8c.html#a69da40149fa83da89f0af9681a6eeeac">core1_volume</a></div><div class="ttdeci">static int core1_volume</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8c_source.html#l00039">audsrv.c:39</a></div></div>
<div class="ttc" id="aspu_8h_html_a7ed6a6db7ec466a04b820f3de267708a"><div class="ttname"><a href="spu_8h.html#a7ed6a6db7ec466a04b820f3de267708a">MAX_VOLUME</a></div><div class="ttdeci">#define MAX_VOLUME</div><div class="ttdef"><b>Definition:</b> <a href="spu_8h_source.html#l00018">spu.h:18</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="audsrv_8h_source.html#l00061">AUDSRV_ERR_ARGS</a>, <a class="el" href="audsrv_8h_source.html#l00056">AUDSRV_ERR_NOERROR</a>, <a class="el" href="audsrv_8c_source.html#l00039">core1_volume</a>, <a class="el" href="spu_8h_source.html#l00018">MAX_VOLUME</a>, and <a class="el" href="audsrv_8c_source.html#l00104">update_volume()</a>.</p>

<p class="reference">Referenced by <a class="el" href="sound_2audsrv_2src_2rpc__server_8c_source.html#l00046">rpc_command()</a>.</p>

</div>
</div>
<a id="a74eb49da756be49fcd0eafee340c4bf3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74eb49da756be49fcd0eafee340c4bf3">&#9670;&nbsp;</a></span>audsrv_stop_audio()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int audsrv_stop_audio </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Stops all audio playing </p><dl class="section return"><dt>Returns</dt><dd>0, always</dd></dl>
<p>Mutes output and stops accepting audio blocks; also, clears callbacks. </p>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00135">135</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;{</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="comment">/* audio is still playing, just mute */</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <a class="code" href="audsrv_8c.html#a35fd1e3b4b7aa595eca11a2b9d953c31">playing</a> = 0;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <a class="code" href="audsrv_8c.html#aa3b9ac75129aa004ecb1215bdc7b6264">update_volume</a>();</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <a class="code" href="audsrv_8c.html#a56a7783a6416e54a779e0e2ffc31fadd">fillbuf_threshold</a> = 0;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="audsrv_8h.html#a50c703b30d2e69499418394f870a3eff">AUDSRV_ERR_NOERROR</a>;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="audsrv_8h_source.html#l00056">AUDSRV_ERR_NOERROR</a>, <a class="el" href="audsrv_8c_source.html#l00073">fillbuf_threshold</a>, <a class="el" href="audsrv_8c_source.html#l00053">playing</a>, and <a class="el" href="audsrv_8c_source.html#l00104">update_volume()</a>.</p>

<p class="reference">Referenced by <a class="el" href="audsrv_8c_source.html#l00215">audsrv_init()</a>, <a class="el" href="audsrv_8c_source.html#l00488">audsrv_quit()</a>, and <a class="el" href="sound_2audsrv_2src_2rpc__server_8c_source.html#l00046">rpc_command()</a>.</p>

</div>
</div>
<a id="a1c6fd06f035d6f7ac65d1f6c5399c9f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c6fd06f035d6f7ac65d1f6c5399c9f1">&#9670;&nbsp;</a></span>audsrv_wait_audio()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int audsrv_wait_audio </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>buflen</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Blocks until there is enough space to enqueue chunk </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buflen</td><td>size of chunk requested to be enqueued (in bytes) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error status code</dd></dl>
<p>Blocks until there are enough space to store the upcoming chunk in audsrv's internal ring buffer. </p>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00293">293</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;{</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="audsrv_8c.html#aa2fb3a6b652ed6dda27b5672372183ca">ringbuf_size</a> &lt; buflen)</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                <span class="comment">/* this will never happen */</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="audsrv_8h.html#a25370175ccf23d229b87cf133d4ee9a1">AUDSRV_ERR_ARGS</a>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keywordflow">while</span> (1)</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="audsrv_8c.html#a8cbc4efcabf1cacf0fc605d07c1b62c5">audsrv_available</a>() &gt;= buflen)</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                        <span class="comment">/* enough space! */</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="audsrv_8h.html#a50c703b30d2e69499418394f870a3eff">AUDSRV_ERR_NOERROR</a>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                <a class="code" href="thsemap_8h.html#aa890eb0239413fa93002f4c3583ad0e3">WaitSema</a>(<a class="code" href="audsrv_8c.html#a7cd0ef0a782e1c8ca8147796e538a26a">queue_sema</a>);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;}</div>
<div class="ttc" id="athsemap_8h_html_aa890eb0239413fa93002f4c3583ad0e3"><div class="ttname"><a href="thsemap_8h.html#aa890eb0239413fa93002f4c3583ad0e3">WaitSema</a></div><div class="ttdeci">int WaitSema(int semid)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="audsrv_8c_source.html#l00274">audsrv_available()</a>, <a class="el" href="audsrv_8h_source.html#l00061">AUDSRV_ERR_ARGS</a>, <a class="el" href="audsrv_8h_source.html#l00056">AUDSRV_ERR_NOERROR</a>, <a class="el" href="audsrv_8c_source.html#l00069">queue_sema</a>, <a class="el" href="audsrv_8c_source.html#l00060">ringbuf_size</a>, and <a class="el" href="thsemap_8h.html#aa890eb0239413fa93002f4c3583ad0e3">WaitSema()</a>.</p>

<p class="reference">Referenced by <a class="el" href="sound_2audsrv_2src_2rpc__server_8c_source.html#l00046">rpc_command()</a>.</p>

</div>
</div>
<a id="aa488e2e7c1e287d7cb48c57c287b7257"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa488e2e7c1e287d7cb48c57c287b7257">&#9670;&nbsp;</a></span>IRX_ID()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">IRX_ID </td>
          <td>(</td>
          <td class="paramtype">&quot;audsrv&quot;&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">1&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">3&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="addc7abfb9fc4d953e5e6bd5014948a3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addc7abfb9fc4d953e5e6bd5014948a3e">&#9670;&nbsp;</a></span>play_thread()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void play_thread </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Main playing thread </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arg</td><td>not used</td></tr>
  </table>
  </dd>
</dl>
<p>This is the main playing thread. It feeds the SPU with upsampled, demux'd audio data, from what has been queued beforehand. The stream is constructed as a ring buffer. This thread only ends with TerminateThread, and is usually asleep, waiting for SPU to complete playing the current wave. SPU plays 2048 bytes blocks, which yields that this thread wakes and sleeps 93.75 times a second </p>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00408">408</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;{</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <span class="keywordtype">int</span> block;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <a class="code" href="tamtypes_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> *bufptr;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;        <span class="keywordtype">int</span> <a class="code" href="ahx__irx_8c.html#a9df0138945acc88462f7c4e7eb5a2c5f">intr_state</a>;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <span class="keywordtype">int</span> step;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;        <span class="keywordtype">int</span> available;</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <span class="keyword">struct </span><a class="code" href="structupsample__t.html">upsample_t</a> up;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        <a class="code" href="upsamplers_8h.html#a896f9f55c7cb1f745aba53f7bfffb70e">upsampler_t</a> upsampler = <a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;starting play thread\n&quot;</span>);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="keywordflow">while</span> (1)</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        {</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="audsrv_8c.html#aaeab2fdb9a7b3830fdfa6cdc781c1f9e">format_changed</a>)</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                        upsampler = <a class="code" href="upsamplers_8c.html#a080f1c6b8e59ac4baf325245d6607ee7">find_upsampler</a>(<a class="code" href="audsrv_8c.html#ac273d1740f99ea0b6a7a4b3735ecdfa0">core1_freq</a>, <a class="code" href="audsrv_8c.html#acfe400051687fd6e8c158ac22d509ae6">core1_bits</a>, <a class="code" href="audsrv_8c.html#a3168c7f7f22624aa7906c9b47bacbd30">core1_channels</a>);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                        <a class="code" href="audsrv_8c.html#aaeab2fdb9a7b3830fdfa6cdc781c1f9e">format_changed</a> = 0;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="audsrv_8c.html#a35fd1e3b4b7aa595eca11a2b9d953c31">playing</a> &amp;&amp; upsampler != <a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                        up.src = (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> *)<a class="code" href="audsrv_8c.html#a5b54b44595bb0afc505dba9ddc6a4e26">ringbuf</a> + <a class="code" href="audsrv_8c.html#a6bf189efc18e1f2c352c562b85bf851f">readpos</a>;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                        up.left = <a class="code" href="audsrv_8c.html#ab524ac072670ad66c54fa64539fad503">rendered_left</a>;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                        up.right = <a class="code" href="audsrv_8c.html#aacdc06af33627c2816d728e4ae45f3c1">rendered_right</a>;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                        step = upsampler(&amp;up);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                        <a class="code" href="audsrv_8c.html#a6bf189efc18e1f2c352c562b85bf851f">readpos</a> = <a class="code" href="audsrv_8c.html#a6bf189efc18e1f2c352c562b85bf851f">readpos</a> + step;</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="audsrv_8c.html#a6bf189efc18e1f2c352c562b85bf851f">readpos</a> &gt;= <a class="code" href="audsrv_8c.html#aa2fb3a6b652ed6dda27b5672372183ca">ringbuf_size</a>)</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                        {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                                <span class="comment">/* wrap around */</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                                <a class="code" href="audsrv_8c.html#a6bf189efc18e1f2c352c562b85bf851f">readpos</a> = 0;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                        }</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                <span class="keywordflow">else</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                        <span class="comment">/* not playing */</span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                        <a class="code" href="sysclib_8h.html#ab8dce9c192324f0fd191fd5b85c7bb60">memset</a>(<a class="code" href="audsrv_8c.html#ab524ac072670ad66c54fa64539fad503">rendered_left</a>, <span class="charliteral">&#39;\0&#39;</span>, <span class="keyword">sizeof</span>(<a class="code" href="audsrv_8c.html#ab524ac072670ad66c54fa64539fad503">rendered_left</a>));</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                        <a class="code" href="sysclib_8h.html#ab8dce9c192324f0fd191fd5b85c7bb60">memset</a>(<a class="code" href="audsrv_8c.html#aacdc06af33627c2816d728e4ae45f3c1">rendered_right</a>, <span class="charliteral">&#39;\0&#39;</span>, <span class="keyword">sizeof</span>(<a class="code" href="audsrv_8c.html#aacdc06af33627c2816d728e4ae45f3c1">rendered_right</a>));</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                <span class="comment">/* wait until it&#39;s safe to transmit another block */</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                <a class="code" href="thsemap_8h.html#aa890eb0239413fa93002f4c3583ad0e3">WaitSema</a>(<a class="code" href="audsrv_8c.html#ae538f96c6438e7b0ed26269a283afc09">transfer_sema</a>);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                <span class="comment">/* suspend all interrupts */</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                <a class="code" href="intrman_8h.html#aa8739c5782168d4e937ac378e80b1bb9">CpuSuspendIntr</a>(&amp;<a class="code" href="ahx__irx_8c.html#a9df0138945acc88462f7c4e7eb5a2c5f">intr_state</a>);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                <span class="comment">/* one block is playing currently, other is idle */</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                block = 1 - (<a class="code" href="spu2_8c.html#a154de74613aff7e1ee6c75f9ac69a47f">sceSdBlockTransStatus</a>(<a class="code" href="audsrv__internal_8h.html#afc40df38dddd64e383c749497ac64189">AUDSRV_BLOCK_DMA_CH</a>, 0) &gt;&gt; 24);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                <span class="comment">/* copy 1024 bytes from left and right buffers, into core1_buf */</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                bufptr = <a class="code" href="audsrv_8c.html#a8239de91b01b86a813ab98ca78a98930">core1_buf</a> + (block &lt;&lt; 11);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                <a class="code" href="ahx__irx_8c.html#ae1977fe02ec05e19fd4cd2601aa49889">wmemcpy</a>(bufptr +    0, <a class="code" href="audsrv_8c.html#ab524ac072670ad66c54fa64539fad503">rendered_left</a> + 0, 512);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                <a class="code" href="ahx__irx_8c.html#ae1977fe02ec05e19fd4cd2601aa49889">wmemcpy</a>(bufptr +  512, <a class="code" href="audsrv_8c.html#aacdc06af33627c2816d728e4ae45f3c1">rendered_right</a> + 0, 512);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                <a class="code" href="ahx__irx_8c.html#ae1977fe02ec05e19fd4cd2601aa49889">wmemcpy</a>(bufptr + 1024, <a class="code" href="audsrv_8c.html#ab524ac072670ad66c54fa64539fad503">rendered_left</a> + 256, 512);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                <a class="code" href="ahx__irx_8c.html#ae1977fe02ec05e19fd4cd2601aa49889">wmemcpy</a>(bufptr + 1536, <a class="code" href="audsrv_8c.html#aacdc06af33627c2816d728e4ae45f3c1">rendered_right</a> + 256, 512);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                <a class="code" href="intrman_8h.html#a030d0fd3089b8cc506fcc9a8c617e589">CpuResumeIntr</a>(<a class="code" href="ahx__irx_8c.html#a9df0138945acc88462f7c4e7eb5a2c5f">intr_state</a>);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                available = <a class="code" href="audsrv_8c.html#a8cbc4efcabf1cacf0fc605d07c1b62c5">audsrv_available</a>();</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                <span class="keywordflow">if</span> (available &gt;= (<a class="code" href="audsrv_8c.html#aa2fb3a6b652ed6dda27b5672372183ca">ringbuf_size</a> / 10))</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                {</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                        <span class="comment">/* arbitrarily selected ringbuf_size / 10, to reduce</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">                         * number of semaphores signalled.</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">                         */</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                        <a class="code" href="thsemap_8h.html#aa7a328a6f153f3cbffe8dba78d0b5519">SignalSema</a>(<a class="code" href="audsrv_8c.html#a7cd0ef0a782e1c8ca8147796e538a26a">queue_sema</a>);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                }</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="audsrv_8c.html#a56a7783a6416e54a779e0e2ffc31fadd">fillbuf_threshold</a> &gt; 0 &amp;&amp; available &gt;= <a class="code" href="audsrv_8c.html#a56a7783a6416e54a779e0e2ffc31fadd">fillbuf_threshold</a>)</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                {</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                        <span class="comment">/* EE client requested a callback */</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                        <a class="code" href="sound_2audsrv_2src_2rpc__client_8c.html#a6d69ce6698bb271dfff025afd37b124d">call_client_callback</a>(<a class="code" href="audsrv_8h.html#ae8bb5075f7485aa7d8127b169fe6dd69">AUDSRV_FILLBUF_CALLBACK</a>);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                <span class="comment">//printf(&quot;avaiable: %d, queued: %d\n&quot;, available, ringbuf_size - available);</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        }</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;}</div>
<div class="ttc" id="aahx__irx_8c_html_a9df0138945acc88462f7c4e7eb5a2c5f"><div class="ttname"><a href="ahx__irx_8c.html#a9df0138945acc88462f7c4e7eb5a2c5f">intr_state</a></div><div class="ttdeci">int intr_state</div><div class="ttdef"><b>Definition:</b> <a href="ahx__irx_8c_source.html#l00031">ahx_irx.c:31</a></div></div>
<div class="ttc" id="aahx__irx_8c_html_ae1977fe02ec05e19fd4cd2601aa49889"><div class="ttname"><a href="ahx__irx_8c.html#ae1977fe02ec05e19fd4cd2601aa49889">wmemcpy</a></div><div class="ttdeci">void wmemcpy(void *dest, void *src, int numwords)</div></div>
<div class="ttc" id="aaudsrv_8c_html_aacdc06af33627c2816d728e4ae45f3c1"><div class="ttname"><a href="audsrv_8c.html#aacdc06af33627c2816d728e4ae45f3c1">rendered_right</a></div><div class="ttdeci">static short rendered_right[512]</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8c_source.html#l00082">audsrv.c:82</a></div></div>
<div class="ttc" id="aaudsrv_8c_html_ab524ac072670ad66c54fa64539fad503"><div class="ttname"><a href="audsrv_8c.html#ab524ac072670ad66c54fa64539fad503">rendered_left</a></div><div class="ttdeci">static short rendered_left[512]</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8c_source.html#l00081">audsrv.c:81</a></div></div>
<div class="ttc" id="aaudsrv_8h_html_ae8bb5075f7485aa7d8127b169fe6dd69"><div class="ttname"><a href="audsrv_8h.html#ae8bb5075f7485aa7d8127b169fe6dd69">AUDSRV_FILLBUF_CALLBACK</a></div><div class="ttdeci">#define AUDSRV_FILLBUF_CALLBACK</div><div class="ttdef"><b>Definition:</b> <a href="audsrv_8h_source.html#l00052">audsrv.h:52</a></div></div>
<div class="ttc" id="aintrman_8h_html_a030d0fd3089b8cc506fcc9a8c617e589"><div class="ttname"><a href="intrman_8h.html#a030d0fd3089b8cc506fcc9a8c617e589">CpuResumeIntr</a></div><div class="ttdeci">int CpuResumeIntr(int state)</div></div>
<div class="ttc" id="aintrman_8h_html_aa8739c5782168d4e937ac378e80b1bb9"><div class="ttname"><a href="intrman_8h.html#aa8739c5782168d4e937ac378e80b1bb9">CpuSuspendIntr</a></div><div class="ttdeci">int CpuSuspendIntr(int *state)</div></div>
<div class="ttc" id="asound_2audsrv_2src_2rpc__client_8c_html_a6d69ce6698bb271dfff025afd37b124d"><div class="ttname"><a href="sound_2audsrv_2src_2rpc__client_8c.html#a6d69ce6698bb271dfff025afd37b124d">call_client_callback</a></div><div class="ttdeci">void call_client_callback(int id)</div><div class="ttdef"><b>Definition:</b> <a href="sound_2audsrv_2src_2rpc__client_8c_source.html#l00037">rpc_client.c:37</a></div></div>
<div class="ttc" id="aspu2_8c_html_a154de74613aff7e1ee6c75f9ac69a47f"><div class="ttname"><a href="spu2_8c.html#a154de74613aff7e1ee6c75f9ac69a47f">sceSdBlockTransStatus</a></div><div class="ttdeci">u32 sceSdBlockTransStatus(s16 chan, s16 flag)</div><div class="ttdef"><b>Definition:</b> <a href="spu2_8c_source.html#l00829">spu2.c:829</a></div></div>
<div class="ttc" id="astructupsample__t_html"><div class="ttname"><a href="structupsample__t.html">upsample_t</a></div><div class="ttdef"><b>Definition:</b> <a href="upsamplers_8h_source.html#l00018">upsamplers.h:19</a></div></div>
<div class="ttc" id="asysclib_8h_html_ab8dce9c192324f0fd191fd5b85c7bb60"><div class="ttname"><a href="sysclib_8h.html#ab8dce9c192324f0fd191fd5b85c7bb60">memset</a></div><div class="ttdeci">void * memset(void *ptr, int c, size_t size)</div></div>
<div class="ttc" id="atamtypes_8h_html_aed742c436da53c1080638ce6ef7d13de"><div class="ttname"><a href="tamtypes_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a></div><div class="ttdeci">unsigned char u8</div><div class="ttdef"><b>Definition:</b> <a href="tamtypes_8h_source.html#l00023">tamtypes.h:23</a></div></div>
<div class="ttc" id="athsemap_8h_html_aa7a328a6f153f3cbffe8dba78d0b5519"><div class="ttname"><a href="thsemap_8h.html#aa7a328a6f153f3cbffe8dba78d0b5519">SignalSema</a></div><div class="ttdeci">int SignalSema(int semid)</div></div>
<div class="ttc" id="aupsamplers_8h_html_a896f9f55c7cb1f745aba53f7bfffb70e"><div class="ttname"><a href="upsamplers_8h.html#a896f9f55c7cb1f745aba53f7bfffb70e">upsampler_t</a></div><div class="ttdeci">int(* upsampler_t)(struct upsample_t *)</div><div class="ttdef"><b>Definition:</b> <a href="upsamplers_8h_source.html#l00025">upsamplers.h:25</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="audsrv_8c_source.html#l00274">audsrv_available()</a>, <a class="el" href="audsrv__internal_8h_source.html#l00026">AUDSRV_BLOCK_DMA_CH</a>, <a class="el" href="audsrv_8h_source.html#l00052">AUDSRV_FILLBUF_CALLBACK</a>, <a class="el" href="sound_2audsrv_2src_2rpc__client_8c_source.html#l00037">call_client_callback()</a>, <a class="el" href="audsrv_8c_source.html#l00043">core1_bits</a>, <a class="el" href="audsrv_8c_source.html#l00079">core1_buf</a>, <a class="el" href="audsrv_8c_source.html#l00045">core1_channels</a>, <a class="el" href="audsrv_8c_source.html#l00041">core1_freq</a>, <a class="el" href="intrman_8h.html#a030d0fd3089b8cc506fcc9a8c617e589">CpuResumeIntr()</a>, <a class="el" href="intrman_8h.html#aa8739c5782168d4e937ac378e80b1bb9">CpuSuspendIntr()</a>, <a class="el" href="audsrv_8c_source.html#l00073">fillbuf_threshold</a>, <a class="el" href="upsamplers_8c_source.html#l00539">find_upsampler()</a>, <a class="el" href="audsrv_8c_source.html#l00076">format_changed</a>, <a class="el" href="ahx__irx_8c_source.html#l00031">intr_state</a>, <a class="el" href="upsamplers_8h_source.html#l00020">upsample_t::left</a>, <a class="el" href="sysclib_8h.html#ab8dce9c192324f0fd191fd5b85c7bb60">memset()</a>, <a class="el" href="defs_8h_source.html#l00022">NULL</a>, <a class="el" href="audsrv_8c_source.html#l00053">playing</a>, <a class="el" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf()</a>, <a class="el" href="audsrv_8c_source.html#l00069">queue_sema</a>, <a class="el" href="audsrv_8c_source.html#l00062">readpos</a>, <a class="el" href="audsrv_8c_source.html#l00081">rendered_left</a>, <a class="el" href="audsrv_8c_source.html#l00082">rendered_right</a>, <a class="el" href="upsamplers_8h_source.html#l00021">upsample_t::right</a>, <a class="el" href="audsrv_8c_source.html#l00058">ringbuf</a>, <a class="el" href="audsrv_8c_source.html#l00060">ringbuf_size</a>, <a class="el" href="spu2_8c_source.html#l00829">sceSdBlockTransStatus()</a>, <a class="el" href="thsemap_8h.html#aa7a328a6f153f3cbffe8dba78d0b5519">SignalSema()</a>, <a class="el" href="upsamplers_8h_source.html#l00022">upsample_t::src</a>, <a class="el" href="audsrv_8c_source.html#l00071">transfer_sema</a>, <a class="el" href="thsemap_8h.html#aa890eb0239413fa93002f4c3583ad0e3">WaitSema()</a>, and <a class="el" href="ahx__irx_8c.html#ae1977fe02ec05e19fd4cd2601aa49889">wmemcpy()</a>.</p>

<p class="reference">Referenced by <a class="el" href="ahx__irx_8c_source.html#l00324">AHX_Init()</a>, and <a class="el" href="audsrv_8c_source.html#l00215">audsrv_init()</a>.</p>

</div>
</div>
<a id="a8bcbc0994bd2a234b67ba334bba98374"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bcbc0994bd2a234b67ba334bba98374">&#9670;&nbsp;</a></span>transfer_complete()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int transfer_complete </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Transfer complete callback. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">arg</td><td>not used </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>true, always</dd></dl>
<p>Generated by SPU2, when a block was transmitted and now putting to upload a second block to the other buffer. </p>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00097">97</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;{</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <a class="code" href="thsemap_8h.html#a91e7d1084472779ba1d033d5a942b1d4">iSignalSema</a>(<a class="code" href="audsrv_8c.html#ae538f96c6438e7b0ed26269a283afc09">transfer_sema</a>);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;}</div>
<div class="ttc" id="athsemap_8h_html_a91e7d1084472779ba1d033d5a942b1d4"><div class="ttname"><a href="thsemap_8h.html#a91e7d1084472779ba1d033d5a942b1d4">iSignalSema</a></div><div class="ttdeci">int iSignalSema(int semid)</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="thsemap_8h.html#a91e7d1084472779ba1d033d5a942b1d4">iSignalSema()</a>, and <a class="el" href="audsrv_8c_source.html#l00071">transfer_sema</a>.</p>

<p class="reference">Referenced by <a class="el" href="audsrv_8c_source.html#l00215">audsrv_init()</a>.</p>

</div>
</div>
<a id="a48daaa0d3de94863970a8153910775a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48daaa0d3de94863970a8153910775a6">&#9670;&nbsp;</a></span>unittest_start()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void unittest_start </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00528">528</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;{</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <span class="comment">/* override this from a unittest */</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="audsrv_8c_source.html#l00538">_start()</a>.</p>

</div>
</div>
<a id="aa3b9ac75129aa004ecb1215bdc7b6264"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa3b9ac75129aa004ecb1215bdc7b6264">&#9670;&nbsp;</a></span>update_volume()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void update_volume </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Apply volume changes, or keep mute if not playing </p>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00104">104</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;{</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordtype">int</span> vol;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="comment">/* external input */</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <a class="code" href="spu2_8c.html#a8a4ff86cbe964574e8a477a7c63295da">sceSdSetParam</a>(<a class="code" href="ahx__irx_8c.html#afc9a7eb8e611e5c9b93a6b63eb519cfe">SD_CORE_1</a> | <a class="code" href="libsd-common_8h.html#af9d5e1f34d889a681cb8c4f1041209cc">SD_PARAM_AVOLL</a>, 0x7fff);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <a class="code" href="spu2_8c.html#a8a4ff86cbe964574e8a477a7c63295da">sceSdSetParam</a>(<a class="code" href="ahx__irx_8c.html#afc9a7eb8e611e5c9b93a6b63eb519cfe">SD_CORE_1</a> | <a class="code" href="libsd-common_8h.html#af72fc5914d2351f54241246b7e103af2">SD_PARAM_AVOLR</a>, 0x7fff);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="comment">/* core0 input */</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <a class="code" href="spu2_8c.html#a8a4ff86cbe964574e8a477a7c63295da">sceSdSetParam</a>(<a class="code" href="spu_8h.html#a3a6240f1a5a9223621f0cfb65d397160">SD_CORE_0</a> | <a class="code" href="libsd-common_8h.html#af71c3ad0112e2a8e408249d3a27aa629">SD_PARAM_BVOLL</a>, 0);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <a class="code" href="spu2_8c.html#a8a4ff86cbe964574e8a477a7c63295da">sceSdSetParam</a>(<a class="code" href="spu_8h.html#a3a6240f1a5a9223621f0cfb65d397160">SD_CORE_0</a> | <a class="code" href="libsd-common_8h.html#ae7574fd893433ad4b5d786ec7a294b43">SD_PARAM_BVOLR</a>, 0);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="comment">/* core1 input */</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        vol = <a class="code" href="audsrv_8c.html#a35fd1e3b4b7aa595eca11a2b9d953c31">playing</a> ? <a class="code" href="audsrv_8c.html#a69da40149fa83da89f0af9681a6eeeac">core1_volume</a> : 0;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <a class="code" href="spu2_8c.html#a8a4ff86cbe964574e8a477a7c63295da">sceSdSetParam</a>(<a class="code" href="ahx__irx_8c.html#afc9a7eb8e611e5c9b93a6b63eb519cfe">SD_CORE_1</a> | <a class="code" href="libsd-common_8h.html#af71c3ad0112e2a8e408249d3a27aa629">SD_PARAM_BVOLL</a>, vol);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        <a class="code" href="spu2_8c.html#a8a4ff86cbe964574e8a477a7c63295da">sceSdSetParam</a>(<a class="code" href="ahx__irx_8c.html#afc9a7eb8e611e5c9b93a6b63eb519cfe">SD_CORE_1</a> | <a class="code" href="libsd-common_8h.html#ae7574fd893433ad4b5d786ec7a294b43">SD_PARAM_BVOLR</a>, vol);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="comment">/* set master volume for core 0 */</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <a class="code" href="spu2_8c.html#a8a4ff86cbe964574e8a477a7c63295da">sceSdSetParam</a>(<a class="code" href="spu_8h.html#a3a6240f1a5a9223621f0cfb65d397160">SD_CORE_0</a> | <a class="code" href="libsd-common_8h.html#a201502039928ef33533f76c0807ab52d">SD_PARAM_MVOLL</a>, 0);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <a class="code" href="spu2_8c.html#a8a4ff86cbe964574e8a477a7c63295da">sceSdSetParam</a>(<a class="code" href="spu_8h.html#a3a6240f1a5a9223621f0cfb65d397160">SD_CORE_0</a> | <a class="code" href="libsd-common_8h.html#af4f57d0f21b513b2a98307699109eb66">SD_PARAM_MVOLR</a>, 0);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="comment">/* set master volume for core 1 */</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <a class="code" href="spu2_8c.html#a8a4ff86cbe964574e8a477a7c63295da">sceSdSetParam</a>(<a class="code" href="ahx__irx_8c.html#afc9a7eb8e611e5c9b93a6b63eb519cfe">SD_CORE_1</a> | <a class="code" href="libsd-common_8h.html#a201502039928ef33533f76c0807ab52d">SD_PARAM_MVOLL</a>, <a class="code" href="spu_8h.html#a7ed6a6db7ec466a04b820f3de267708a">MAX_VOLUME</a>);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <a class="code" href="spu2_8c.html#a8a4ff86cbe964574e8a477a7c63295da">sceSdSetParam</a>(<a class="code" href="ahx__irx_8c.html#afc9a7eb8e611e5c9b93a6b63eb519cfe">SD_CORE_1</a> | <a class="code" href="libsd-common_8h.html#af4f57d0f21b513b2a98307699109eb66">SD_PARAM_MVOLR</a>, <a class="code" href="spu_8h.html#a7ed6a6db7ec466a04b820f3de267708a">MAX_VOLUME</a>);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;}</div>
<div class="ttc" id="aahx__irx_8c_html_afc9a7eb8e611e5c9b93a6b63eb519cfe"><div class="ttname"><a href="ahx__irx_8c.html#afc9a7eb8e611e5c9b93a6b63eb519cfe">SD_CORE_1</a></div><div class="ttdeci">#define SD_CORE_1</div><div class="ttdef"><b>Definition:</b> <a href="ahx__irx_8c_source.html#l00024">ahx_irx.c:24</a></div></div>
<div class="ttc" id="alibsd-common_8h_html_a201502039928ef33533f76c0807ab52d"><div class="ttname"><a href="libsd-common_8h.html#a201502039928ef33533f76c0807ab52d">SD_PARAM_MVOLL</a></div><div class="ttdeci">#define SD_PARAM_MVOLL</div><div class="ttdef"><b>Definition:</b> <a href="libsd-common_8h_source.html#l00035">libsd-common.h:35</a></div></div>
<div class="ttc" id="alibsd-common_8h_html_ae7574fd893433ad4b5d786ec7a294b43"><div class="ttname"><a href="libsd-common_8h.html#ae7574fd893433ad4b5d786ec7a294b43">SD_PARAM_BVOLR</a></div><div class="ttdeci">#define SD_PARAM_BVOLR</div><div class="ttdef"><b>Definition:</b> <a href="libsd-common_8h_source.html#l00042">libsd-common.h:42</a></div></div>
<div class="ttc" id="alibsd-common_8h_html_af4f57d0f21b513b2a98307699109eb66"><div class="ttname"><a href="libsd-common_8h.html#af4f57d0f21b513b2a98307699109eb66">SD_PARAM_MVOLR</a></div><div class="ttdeci">#define SD_PARAM_MVOLR</div><div class="ttdef"><b>Definition:</b> <a href="libsd-common_8h_source.html#l00036">libsd-common.h:36</a></div></div>
<div class="ttc" id="alibsd-common_8h_html_af71c3ad0112e2a8e408249d3a27aa629"><div class="ttname"><a href="libsd-common_8h.html#af71c3ad0112e2a8e408249d3a27aa629">SD_PARAM_BVOLL</a></div><div class="ttdeci">#define SD_PARAM_BVOLL</div><div class="ttdef"><b>Definition:</b> <a href="libsd-common_8h_source.html#l00041">libsd-common.h:41</a></div></div>
<div class="ttc" id="alibsd-common_8h_html_af72fc5914d2351f54241246b7e103af2"><div class="ttname"><a href="libsd-common_8h.html#af72fc5914d2351f54241246b7e103af2">SD_PARAM_AVOLR</a></div><div class="ttdeci">#define SD_PARAM_AVOLR</div><div class="ttdef"><b>Definition:</b> <a href="libsd-common_8h_source.html#l00040">libsd-common.h:40</a></div></div>
<div class="ttc" id="alibsd-common_8h_html_af9d5e1f34d889a681cb8c4f1041209cc"><div class="ttname"><a href="libsd-common_8h.html#af9d5e1f34d889a681cb8c4f1041209cc">SD_PARAM_AVOLL</a></div><div class="ttdeci">#define SD_PARAM_AVOLL</div><div class="ttdef"><b>Definition:</b> <a href="libsd-common_8h_source.html#l00039">libsd-common.h:39</a></div></div>
<div class="ttc" id="aspu2_8c_html_a8a4ff86cbe964574e8a477a7c63295da"><div class="ttname"><a href="spu2_8c.html#a8a4ff86cbe964574e8a477a7c63295da">sceSdSetParam</a></div><div class="ttdeci">void sceSdSetParam(u16 reg, u16 val)</div><div class="ttdef"><b>Definition:</b> <a href="spu2_8c_source.html#l00525">spu2.c:525</a></div></div>
<div class="ttc" id="aspu_8h_html_a3a6240f1a5a9223621f0cfb65d397160"><div class="ttname"><a href="spu_8h.html#a3a6240f1a5a9223621f0cfb65d397160">SD_CORE_0</a></div><div class="ttdeci">#define SD_CORE_0</div><div class="ttdef"><b>Definition:</b> <a href="spu_8h_source.html#l00027">spu.h:27</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="audsrv_8c_source.html#l00039">core1_volume</a>, <a class="el" href="spu_8h_source.html#l00018">MAX_VOLUME</a>, <a class="el" href="audsrv_8c_source.html#l00053">playing</a>, <a class="el" href="spu2_8c_source.html#l00525">sceSdSetParam()</a>, <a class="el" href="spu_8h_source.html#l00027">SD_CORE_0</a>, <a class="el" href="ahx__irx_8c_source.html#l00024">SD_CORE_1</a>, <a class="el" href="libsd-common_8h_source.html#l00039">SD_PARAM_AVOLL</a>, <a class="el" href="libsd-common_8h_source.html#l00040">SD_PARAM_AVOLR</a>, <a class="el" href="libsd-common_8h_source.html#l00041">SD_PARAM_BVOLL</a>, <a class="el" href="libsd-common_8h_source.html#l00042">SD_PARAM_BVOLR</a>, <a class="el" href="libsd-common_8h_source.html#l00035">SD_PARAM_MVOLL</a>, and <a class="el" href="libsd-common_8h_source.html#l00036">SD_PARAM_MVOLR</a>.</p>

<p class="reference">Referenced by <a class="el" href="audsrv_8c_source.html#l00323">audsrv_play_audio()</a>, <a class="el" href="audsrv_8c_source.html#l00372">audsrv_set_volume()</a>, and <a class="el" href="audsrv_8c_source.html#l00135">audsrv_stop_audio()</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ad23dc209a0ea2d9b3b4db0f4fc741ed1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad23dc209a0ea2d9b3b4db0f4fc741ed1">&#9670;&nbsp;</a></span>_exp_audsrv</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structirx__export__table.html">irx_export_table</a> _exp_audsrv</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>exports table </p>

<p class="reference">Referenced by <a class="el" href="audsrv_8c_source.html#l00538">_start()</a>.</p>

</div>
</div>
<a id="acfe400051687fd6e8c158ac22d509ae6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acfe400051687fd6e8c158ac22d509ae6">&#9670;&nbsp;</a></span>core1_bits</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int core1_bits = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>bits per sample, set by user </p>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00043">43</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="audsrv_8c_source.html#l00174">audsrv_set_format()</a>, and <a class="el" href="audsrv_8c_source.html#l00408">play_thread()</a>.</p>

</div>
</div>
<a id="a8239de91b01b86a813ab98ca78a98930"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8239de91b01b86a813ab98ca78a98930">&#9670;&nbsp;</a></span>core1_buf</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="tamtypes_8h.html#aed742c436da53c1080638ce6ef7d13de">u8</a> core1_buf[0x1000]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>double buffer for streaming </p>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00079">79</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="audsrv_8c_source.html#l00215">audsrv_init()</a>, and <a class="el" href="audsrv_8c_source.html#l00408">play_thread()</a>.</p>

</div>
</div>
<a id="a3168c7f7f22624aa7906c9b47bacbd30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3168c7f7f22624aa7906c9b47bacbd30">&#9670;&nbsp;</a></span>core1_channels</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int core1_channels = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>number of audio channels </p>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00045">45</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="audsrv_8c_source.html#l00174">audsrv_set_format()</a>, and <a class="el" href="audsrv_8c_source.html#l00408">play_thread()</a>.</p>

</div>
</div>
<a id="ac273d1740f99ea0b6a7a4b3735ecdfa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac273d1740f99ea0b6a7a4b3735ecdfa0">&#9670;&nbsp;</a></span>core1_freq</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int core1_freq = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>frequency set by user </p>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00041">41</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="audsrv_8c_source.html#l00174">audsrv_set_format()</a>, and <a class="el" href="audsrv_8c_source.html#l00408">play_thread()</a>.</p>

</div>
</div>
<a id="a78383d9f30a7cb3d6f4fe07973c7d69a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78383d9f30a7cb3d6f4fe07973c7d69a">&#9670;&nbsp;</a></span>core1_sample_shift</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int core1_sample_shift = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>shift count from bytes to samples </p>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00047">47</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="audsrv_8c_source.html#l00174">audsrv_set_format()</a>.</p>

</div>
</div>
<a id="a69da40149fa83da89f0af9681a6eeeac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69da40149fa83da89f0af9681a6eeeac">&#9670;&nbsp;</a></span>core1_volume</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int core1_volume = <a class="el" href="spu_8h.html#a7ed6a6db7ec466a04b820f3de267708a">MAX_VOLUME</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>core1 (sfx) volume </p>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00039">39</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="audsrv_8c_source.html#l00372">audsrv_set_volume()</a>, and <a class="el" href="audsrv_8c_source.html#l00104">update_volume()</a>.</p>

</div>
</div>
<a id="a56a7783a6416e54a779e0e2ffc31fadd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56a7783a6416e54a779e0e2ffc31fadd">&#9670;&nbsp;</a></span>fillbuf_threshold</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int fillbuf_threshold = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>threshold to initiate a callback </p>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00073">73</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="audsrv_8c_source.html#l00385">audsrv_set_threshold()</a>, <a class="el" href="audsrv_8c_source.html#l00135">audsrv_stop_audio()</a>, and <a class="el" href="audsrv_8c_source.html#l00408">play_thread()</a>.</p>

</div>
</div>
<a id="aaeab2fdb9a7b3830fdfa6cdc781c1f9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaeab2fdb9a7b3830fdfa6cdc781c1f9e">&#9670;&nbsp;</a></span>format_changed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int format_changed = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>boolean to notify when format has changed </p>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00076">76</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="audsrv_8c_source.html#l00174">audsrv_set_format()</a>, and <a class="el" href="audsrv_8c_source.html#l00408">play_thread()</a>.</p>

</div>
</div>
<a id="ad06983e7f6e71b233ea7ff3dee1952f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad06983e7f6e71b233ea7ff3dee1952f2">&#9670;&nbsp;</a></span>initialized</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int initialized = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>initialization status </p>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00051">51</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="audsrv_8c_source.html#l00215">audsrv_init()</a>, and <a class="el" href="audsrv_8c_source.html#l00323">audsrv_play_audio()</a>.</p>

</div>
</div>
<a id="a0e9d895d9f970505d574ee19c1d26d19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e9d895d9f970505d574ee19c1d26d19">&#9670;&nbsp;</a></span>play_tid</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int play_tid = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>playing thread id </p>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00067">67</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="audsrv_8c_source.html#l00215">audsrv_init()</a>, and <a class="el" href="audsrv_8c_source.html#l00488">audsrv_quit()</a>.</p>

</div>
</div>
<a id="a35fd1e3b4b7aa595eca11a2b9d953c31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35fd1e3b4b7aa595eca11a2b9d953c31">&#9670;&nbsp;</a></span>playing</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int playing = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>playing (not mute) status </p>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00053">53</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="audsrv_8c_source.html#l00323">audsrv_play_audio()</a>, <a class="el" href="audsrv_8c_source.html#l00135">audsrv_stop_audio()</a>, <a class="el" href="audsrv_8c_source.html#l00408">play_thread()</a>, and <a class="el" href="audsrv_8c_source.html#l00104">update_volume()</a>.</p>

</div>
</div>
<a id="a7cd0ef0a782e1c8ca8147796e538a26a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cd0ef0a782e1c8ca8147796e538a26a">&#9670;&nbsp;</a></span>queue_sema</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int queue_sema = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>semaphore for wait_audio() </p>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00069">69</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="audsrv_8c_source.html#l00215">audsrv_init()</a>, <a class="el" href="audsrv_8c_source.html#l00488">audsrv_quit()</a>, <a class="el" href="audsrv_8c_source.html#l00293">audsrv_wait_audio()</a>, and <a class="el" href="audsrv_8c_source.html#l00408">play_thread()</a>.</p>

</div>
</div>
<a id="a6bf189efc18e1f2c352c562b85bf851f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bf189efc18e1f2c352c562b85bf851f">&#9670;&nbsp;</a></span>readpos</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int readpos</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>reading head pointer </p>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00062">62</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="audsrv_8c_source.html#l00274">audsrv_available()</a>, <a class="el" href="audsrv_8c_source.html#l00215">audsrv_init()</a>, <a class="el" href="audsrv_8c_source.html#l00323">audsrv_play_audio()</a>, <a class="el" href="audsrv_8c_source.html#l00174">audsrv_set_format()</a>, and <a class="el" href="audsrv_8c_source.html#l00408">play_thread()</a>.</p>

</div>
</div>
<a id="ab524ac072670ad66c54fa64539fad503"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab524ac072670ad66c54fa64539fad503">&#9670;&nbsp;</a></span>rendered_left</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">short rendered_left[512]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00081">81</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="audsrv_8c_source.html#l00408">play_thread()</a>.</p>

</div>
</div>
<a id="aacdc06af33627c2816d728e4ae45f3c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacdc06af33627c2816d728e4ae45f3c1">&#9670;&nbsp;</a></span>rendered_right</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">short rendered_right[512]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00082">82</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="audsrv_8c_source.html#l00408">play_thread()</a>.</p>

</div>
</div>
<a id="a5b54b44595bb0afc505dba9ddc6a4e26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b54b44595bb0afc505dba9ddc6a4e26">&#9670;&nbsp;</a></span>ringbuf</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char ringbuf[20480]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>ring buffer itself </p>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00058">58</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="audsrv_8c_source.html#l00323">audsrv_play_audio()</a>, and <a class="el" href="audsrv_8c_source.html#l00408">play_thread()</a>.</p>

</div>
</div>
<a id="aa2fb3a6b652ed6dda27b5672372183ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2fb3a6b652ed6dda27b5672372183ca">&#9670;&nbsp;</a></span>ringbuf_size</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int ringbuf_size = sizeof(<a class="el" href="audsrv_8c.html#a5b54b44595bb0afc505dba9ddc6a4e26">ringbuf</a>)</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>size of ring buffer in bytes </p>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00060">60</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="audsrv_8c_source.html#l00274">audsrv_available()</a>, <a class="el" href="audsrv_8c_source.html#l00323">audsrv_play_audio()</a>, <a class="el" href="audsrv_8c_source.html#l00174">audsrv_set_format()</a>, <a class="el" href="audsrv_8c_source.html#l00385">audsrv_set_threshold()</a>, <a class="el" href="audsrv_8c_source.html#l00293">audsrv_wait_audio()</a>, and <a class="el" href="audsrv_8c_source.html#l00408">play_thread()</a>.</p>

</div>
</div>
<a id="ae538f96c6438e7b0ed26269a283afc09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae538f96c6438e7b0ed26269a283afc09">&#9670;&nbsp;</a></span>transfer_sema</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int transfer_sema = 0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>SPU2 transfer complete semaphore </p>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00071">71</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="audsrv_8c_source.html#l00215">audsrv_init()</a>, <a class="el" href="audsrv_8c_source.html#l00488">audsrv_quit()</a>, <a class="el" href="audsrv_8c_source.html#l00408">play_thread()</a>, and <a class="el" href="audsrv_8c_source.html#l00097">transfer_complete()</a>.</p>

</div>
</div>
<a id="a4f6eda090a2a7d35f235aa0db908ed15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f6eda090a2a7d35f235aa0db908ed15">&#9670;&nbsp;</a></span>writepos</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int writepos</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>writing head pointer </p>

<p class="definition">Definition at line <a class="el" href="audsrv_8c_source.html#l00064">64</a> of file <a class="el" href="audsrv_8c_source.html">audsrv.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="audsrv_8c_source.html#l00274">audsrv_available()</a>, <a class="el" href="audsrv_8c_source.html#l00215">audsrv_init()</a>, <a class="el" href="audsrv_8c_source.html#l00323">audsrv_play_audio()</a>, and <a class="el" href="audsrv_8c_source.html#l00174">audsrv_set_format()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_0981ace215aa2029f526b70c145b9fbe.html">iop</a></li><li class="navelem"><a class="el" href="dir_838e88315325ec0d843359dcae22d639.html">sound</a></li><li class="navelem"><a class="el" href="dir_c224f8f6f41c46dc69cc573710289bc0.html">audsrv</a></li><li class="navelem"><a class="el" href="dir_4304e6a09d2ca52231132d217435644b.html">src</a></li><li class="navelem"><a class="el" href="audsrv_8c.html">audsrv.c</a></li>
    <li class="footer">Generated on Thu Feb 11 2021 11:42:45 for ps2sdk by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
</body>
</html>
