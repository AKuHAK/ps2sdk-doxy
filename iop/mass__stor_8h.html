<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ps2sdk: iop/usb/usbhdfsd/src/include/mass_stor.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="code.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ps2sdk
   &#160;<span id="projectnumber">1.1</span>
   </div>
   <div id="projectbrief">A collection of Open Source libraries used for developing applications on Sony&#39;s PlayStation 2Â® (PS2).</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('mass__stor_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">mass_stor.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="mass__stor_8h__dep__incl.svg" width="100%" height="406"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
</div>
<p><a href="mass__stor_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aec731c2ebcc455981c081886e09df9ac"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mass__stor_8h.html#aec731c2ebcc455981c081886e09df9ac">InitUSB</a> (void)</td></tr>
<tr class="separator:aec731c2ebcc455981c081886e09df9ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4810a9f44bac8abf9a7264ad6738ff62"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mass__stor_8h.html#a4810a9f44bac8abf9a7264ad6738ff62">mass_stor_disconnect</a> (int devId)</td></tr>
<tr class="separator:a4810a9f44bac8abf9a7264ad6738ff62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ff55f48cdae5bca89ba8e3b20d22e5a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mass__stor_8h.html#a0ff55f48cdae5bca89ba8e3b20d22e5a">mass_stor_connect</a> (int devId)</td></tr>
<tr class="separator:a0ff55f48cdae5bca89ba8e3b20d22e5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2122a50e649036393e86bcf03c95c0ec"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mass__stor_8h.html#a2122a50e649036393e86bcf03c95c0ec">mass_stor_probe</a> (int devId)</td></tr>
<tr class="separator:a2122a50e649036393e86bcf03c95c0ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad018ebccc3b00d1692c6d82f651a841"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mass__stor_8h.html#aad018ebccc3b00d1692c6d82f651a841">mass_stor_readSector</a> (<a class="el" href="structmass__dev.html">mass_dev</a> *dev, unsigned int sector, unsigned char *<a class="el" href="ahx__irx_8c.html#a2e259c96eeae9c2c3832d3dd54fd26a3">buffer</a>, unsigned short int count)</td></tr>
<tr class="separator:aad018ebccc3b00d1692c6d82f651a841"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34f0975260907a88be14dafd4f392d48"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mass__stor_8h.html#a34f0975260907a88be14dafd4f392d48">mass_stor_writeSector</a> (<a class="el" href="structmass__dev.html">mass_dev</a> *dev, unsigned int sector, const unsigned char *<a class="el" href="ahx__irx_8c.html#a2e259c96eeae9c2c3832d3dd54fd26a3">buffer</a>, unsigned short int count)</td></tr>
<tr class="separator:a34f0975260907a88be14dafd4f392d48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad87a0650abc4dc2c1104e1a57e141c52"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mass__stor_8h.html#ad87a0650abc4dc2c1104e1a57e141c52">mass_stor_configureNextDevice</a> (void)</td></tr>
<tr class="separator:ad87a0650abc4dc2c1104e1a57e141c52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0813700a4e08c14f8e6e813017933266"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mass__stor_8h.html#a0813700a4e08c14f8e6e813017933266">mass_stor_stop_unit</a> (<a class="el" href="structmass__dev.html">mass_dev</a> *dev)</td></tr>
<tr class="separator:a0813700a4e08c14f8e6e813017933266"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94799aabb4160efa5fe7a64b9b0fe8a4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="mass__stor_8h.html#a94799aabb4160efa5fe7a64b9b0fe8a4">mass_store_stop_all</a> (void)</td></tr>
<tr class="separator:a94799aabb4160efa5fe7a64b9b0fe8a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="aec731c2ebcc455981c081886e09df9ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec731c2ebcc455981c081886e09df9ac">&#9670;&nbsp;</a></span>InitUSB()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int InitUSB </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="usb__driver_8c_source.html#l01123">1123</a> of file <a class="el" href="usb__driver_8c_source.html">usb_driver.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;{</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        <span class="keywordtype">int</span> ret = 0;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="usb__driver_8c.html#a7020e20a18e8488cd19315887c473ce2">NUM_DEVICES</a>; ++i)</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        {</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;                <a class="code" href="usb__driver_8c.html#a83eb6082c41fc8330020e4ef4dbffa9a">g_mass_device</a>[i].<a class="code" href="structmass__dev.html#a6be7575bf966a660f803dac1a3ea93a8">status</a> = 0;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;                <a class="code" href="usb__driver_8c.html#a83eb6082c41fc8330020e4ef4dbffa9a">g_mass_device</a>[i].<a class="code" href="structmass__dev.html#afe3c44bc7f3dace3dcb0c55df1ba5910">devId</a> = -1;</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        }</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160; </div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        <a class="code" href="usb__driver_8c.html#ad7b604544aff4d6d8945fcb17e533f5c">driver</a>.<a class="code" href="structsceUsbdLddOps.html#a46c664699aa516e71013ec5fa1af342e">next</a>             = <a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        <a class="code" href="usb__driver_8c.html#ad7b604544aff4d6d8945fcb17e533f5c">driver</a>.<a class="code" href="structsceUsbdLddOps.html#a5038338b76f9ed20aef096bced0b9ce4">prev</a>             = <a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        <a class="code" href="usb__driver_8c.html#ad7b604544aff4d6d8945fcb17e533f5c">driver</a>.<a class="code" href="structsceUsbdLddOps.html#a191f6dc6c65b870000498756c8ed112f">name</a>             = <span class="stringliteral">&quot;mass-stor&quot;</span>;</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        <a class="code" href="usb__driver_8c.html#ad7b604544aff4d6d8945fcb17e533f5c">driver</a>.<a class="code" href="structsceUsbdLddOps.html#a385e8f7d9a511fe4862ce99fa3e483ca">probe</a>            = <a class="code" href="usb__driver_8c.html#a2122a50e649036393e86bcf03c95c0ec">mass_stor_probe</a>;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        <a class="code" href="usb__driver_8c.html#ad7b604544aff4d6d8945fcb17e533f5c">driver</a>.<a class="code" href="structsceUsbdLddOps.html#a5dd2831c693c3853d2384bab07d7cc02">connect</a>          = <a class="code" href="usb__driver_8c.html#a0ff55f48cdae5bca89ba8e3b20d22e5a">mass_stor_connect</a>;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        <a class="code" href="usb__driver_8c.html#ad7b604544aff4d6d8945fcb17e533f5c">driver</a>.<a class="code" href="structsceUsbdLddOps.html#a19f269b934c4507c0f180ca5f27f1e33">disconnect</a>       = <a class="code" href="usb__driver_8c.html#a4810a9f44bac8abf9a7264ad6738ff62">mass_stor_disconnect</a>;</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160; </div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        ret = <a class="code" href="usbd_8h.html#abf14cd7f070da71e3ad523bbaa57a378">sceUsbdRegisterLdd</a>(&amp;<a class="code" href="usb__driver_8c.html#ad7b604544aff4d6d8945fcb17e533f5c">driver</a>);</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        <a class="code" href="iLink_2IEEE1394__disk_2src_2include_2mass__debug_8h.html#a730a51a001461c80e0268109f4bdf849">XPRINTF</a>(<span class="stringliteral">&quot;USBHDFSD: registerDriver=%i \n&quot;</span>, ret);</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        {</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;                <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;USBHDFSD: register driver failed! ret=%d\n&quot;</span>, ret);</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                <span class="keywordflow">return</span>(-1);</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        }</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160; </div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        <span class="keywordflow">return</span>(0);</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;}</div>
<div class="ttc" id="adefs_8h_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="defs_8h_source.html#l00022">defs.h:22</a></div></div>
<div class="ttc" id="aiLink_2IEEE1394__disk_2src_2include_2mass__debug_8h_html_a730a51a001461c80e0268109f4bdf849"><div class="ttname"><a href="iLink_2IEEE1394__disk_2src_2include_2mass__debug_8h.html#a730a51a001461c80e0268109f4bdf849">XPRINTF</a></div><div class="ttdeci">#define XPRINTF(args...)</div><div class="ttdef"><b>Definition:</b> <a href="iLink_2IEEE1394__disk_2src_2include_2mass__debug_8h_source.html#l00008">mass_debug.h:8</a></div></div>
<div class="ttc" id="astdio_8h_html_a98631211a4a8aee62f572375d5b637be"><div class="ttname"><a href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a></div><div class="ttdeci">int printf(const char *format,...)</div></div>
<div class="ttc" id="astructmass__dev_html_a6be7575bf966a660f803dac1a3ea93a8"><div class="ttname"><a href="structmass__dev.html#a6be7575bf966a660f803dac1a3ea93a8">mass_dev::status</a></div><div class="ttdeci">unsigned char status</div><div class="ttdef"><b>Definition:</b> <a href="usb__mass_8c_source.html#l00045">usb_mass.c:45</a></div></div>
<div class="ttc" id="astructmass__dev_html_afe3c44bc7f3dace3dcb0c55df1ba5910"><div class="ttname"><a href="structmass__dev.html#afe3c44bc7f3dace3dcb0c55df1ba5910">mass_dev::devId</a></div><div class="ttdeci">int devId</div><div class="ttdef"><b>Definition:</b> <a href="usb__mass_8c_source.html#l00043">usb_mass.c:43</a></div></div>
<div class="ttc" id="astructsceUsbdLddOps_html_a191f6dc6c65b870000498756c8ed112f"><div class="ttname"><a href="structsceUsbdLddOps.html#a191f6dc6c65b870000498756c8ed112f">sceUsbdLddOps::name</a></div><div class="ttdeci">char * name</div><div class="ttdef"><b>Definition:</b> <a href="usbd_8h_source.html#l00048">usbd.h:48</a></div></div>
<div class="ttc" id="astructsceUsbdLddOps_html_a19f269b934c4507c0f180ca5f27f1e33"><div class="ttname"><a href="structsceUsbdLddOps.html#a19f269b934c4507c0f180ca5f27f1e33">sceUsbdLddOps::disconnect</a></div><div class="ttdeci">int(* disconnect)(int devID)</div><div class="ttdef"><b>Definition:</b> <a href="usbd_8h_source.html#l00051">usbd.h:51</a></div></div>
<div class="ttc" id="astructsceUsbdLddOps_html_a385e8f7d9a511fe4862ce99fa3e483ca"><div class="ttname"><a href="structsceUsbdLddOps.html#a385e8f7d9a511fe4862ce99fa3e483ca">sceUsbdLddOps::probe</a></div><div class="ttdeci">int(* probe)(int devID)</div><div class="ttdef"><b>Definition:</b> <a href="usbd_8h_source.html#l00049">usbd.h:49</a></div></div>
<div class="ttc" id="astructsceUsbdLddOps_html_a46c664699aa516e71013ec5fa1af342e"><div class="ttname"><a href="structsceUsbdLddOps.html#a46c664699aa516e71013ec5fa1af342e">sceUsbdLddOps::next</a></div><div class="ttdeci">struct _UsbDriver * next</div><div class="ttdef"><b>Definition:</b> <a href="usbd_8h_source.html#l00046">usbd.h:46</a></div></div>
<div class="ttc" id="astructsceUsbdLddOps_html_a5038338b76f9ed20aef096bced0b9ce4"><div class="ttname"><a href="structsceUsbdLddOps.html#a5038338b76f9ed20aef096bced0b9ce4">sceUsbdLddOps::prev</a></div><div class="ttdeci">struct _UsbDriver * prev</div><div class="ttdef"><b>Definition:</b> <a href="usbd_8h_source.html#l00046">usbd.h:46</a></div></div>
<div class="ttc" id="astructsceUsbdLddOps_html_a5dd2831c693c3853d2384bab07d7cc02"><div class="ttname"><a href="structsceUsbdLddOps.html#a5dd2831c693c3853d2384bab07d7cc02">sceUsbdLddOps::connect</a></div><div class="ttdeci">int(* connect)(int devID)</div><div class="ttdef"><b>Definition:</b> <a href="usbd_8h_source.html#l00050">usbd.h:50</a></div></div>
<div class="ttc" id="ausb__driver_8c_html_a0ff55f48cdae5bca89ba8e3b20d22e5a"><div class="ttname"><a href="usb__driver_8c.html#a0ff55f48cdae5bca89ba8e3b20d22e5a">mass_stor_connect</a></div><div class="ttdeci">int mass_stor_connect(int devId)</div><div class="ttdef"><b>Definition:</b> <a href="usb__driver_8c_source.html#l00866">usb_driver.c:866</a></div></div>
<div class="ttc" id="ausb__driver_8c_html_a2122a50e649036393e86bcf03c95c0ec"><div class="ttname"><a href="usb__driver_8c.html#a2122a50e649036393e86bcf03c95c0ec">mass_stor_probe</a></div><div class="ttdeci">int mass_stor_probe(int devId)</div><div class="ttdef"><b>Definition:</b> <a href="usb__driver_8c_source.html#l00811">usb_driver.c:811</a></div></div>
<div class="ttc" id="ausb__driver_8c_html_a4810a9f44bac8abf9a7264ad6738ff62"><div class="ttname"><a href="usb__driver_8c.html#a4810a9f44bac8abf9a7264ad6738ff62">mass_stor_disconnect</a></div><div class="ttdeci">int mass_stor_disconnect(int devId)</div><div class="ttdef"><b>Definition:</b> <a href="usb__driver_8c_source.html#l00966">usb_driver.c:966</a></div></div>
<div class="ttc" id="ausb__driver_8c_html_a7020e20a18e8488cd19315887c473ce2"><div class="ttname"><a href="usb__driver_8c.html#a7020e20a18e8488cd19315887c473ce2">NUM_DEVICES</a></div><div class="ttdeci">#define NUM_DEVICES</div><div class="ttdef"><b>Definition:</b> <a href="usb__driver_8c_source.html#l00116">usb_driver.c:116</a></div></div>
<div class="ttc" id="ausb__driver_8c_html_a83eb6082c41fc8330020e4ef4dbffa9a"><div class="ttname"><a href="usb__driver_8c.html#a83eb6082c41fc8330020e4ef4dbffa9a">g_mass_device</a></div><div class="ttdeci">static mass_dev g_mass_device[NUM_DEVICES]</div><div class="ttdef"><b>Definition:</b> <a href="usb__driver_8c_source.html#l00117">usb_driver.c:117</a></div></div>
<div class="ttc" id="ausb__driver_8c_html_ad7b604544aff4d6d8945fcb17e533f5c"><div class="ttname"><a href="usb__driver_8c.html#ad7b604544aff4d6d8945fcb17e533f5c">driver</a></div><div class="ttdeci">static sceUsbdLddOps driver</div><div class="ttdef"><b>Definition:</b> <a href="usb__driver_8c_source.html#l00098">usb_driver.c:98</a></div></div>
<div class="ttc" id="ausbd_8h_html_abf14cd7f070da71e3ad523bbaa57a378"><div class="ttname"><a href="usbd_8h.html#abf14cd7f070da71e3ad523bbaa57a378">sceUsbdRegisterLdd</a></div><div class="ttdeci">int sceUsbdRegisterLdd(sceUsbdLddOps *driver)</div><div class="ttdef"><b>Definition:</b> <a href="interface_8c_source.html#l00029">interface.c:29</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="usbd_8h_source.html#l00050">sceUsbdLddOps::connect</a>, <a class="el" href="usb__mass_8c_source.html#l00043">mass_dev::devId</a>, <a class="el" href="usbd_8h_source.html#l00051">sceUsbdLddOps::disconnect</a>, <a class="el" href="usb__driver_8c_source.html#l00098">driver</a>, <a class="el" href="usb__driver_8c_source.html#l00117">g_mass_device</a>, <a class="el" href="usb__driver_8c_source.html#l00866">mass_stor_connect()</a>, <a class="el" href="usb__driver_8c_source.html#l00966">mass_stor_disconnect()</a>, <a class="el" href="usb__driver_8c_source.html#l00811">mass_stor_probe()</a>, <a class="el" href="usbd_8h_source.html#l00048">sceUsbdLddOps::name</a>, <a class="el" href="usbd_8h_source.html#l00046">sceUsbdLddOps::next</a>, <a class="el" href="defs_8h_source.html#l00022">NULL</a>, <a class="el" href="usb__driver_8c_source.html#l00116">NUM_DEVICES</a>, <a class="el" href="usbd_8h_source.html#l00046">sceUsbdLddOps::prev</a>, <a class="el" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf()</a>, <a class="el" href="usbd_8h_source.html#l00049">sceUsbdLddOps::probe</a>, <a class="el" href="interface_8c_source.html#l00029">sceUsbdRegisterLdd()</a>, <a class="el" href="usb__mass_8c_source.html#l00045">mass_dev::status</a>, and <a class="el" href="iLink_2IEEE1394__disk_2src_2include_2mass__debug_8h_source.html#l00008">XPRINTF</a>.</p>

</div>
</div>
<a id="ad87a0650abc4dc2c1104e1a57e141c52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad87a0650abc4dc2c1104e1a57e141c52">&#9670;&nbsp;</a></span>mass_stor_configureNextDevice()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mass_stor_configureNextDevice </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="usb__driver_8c_source.html#l01081">1081</a> of file <a class="el" href="usb__driver_8c_source.html">usb_driver.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;{</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160; </div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        <a class="code" href="iLink_2IEEE1394__disk_2src_2include_2mass__debug_8h.html#a730a51a001461c80e0268109f4bdf849">XPRINTF</a>(<span class="stringliteral">&quot;USBHDFSD: configuring devices... \n&quot;</span>);</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160; </div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="usb__driver_8c.html#a7020e20a18e8488cd19315887c473ce2">NUM_DEVICES</a>; ++i)</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        {</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                <a class="code" href="structmass__dev.html">mass_dev</a> *dev = &amp;<a class="code" href="usb__driver_8c.html#a83eb6082c41fc8330020e4ef4dbffa9a">g_mass_device</a>[i];</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                <span class="keywordflow">if</span> (dev-&gt;<a class="code" href="structmass__dev.html#afe3c44bc7f3dace3dcb0c55df1ba5910">devId</a> != -1 &amp;&amp; (dev-&gt;<a class="code" href="structmass__dev.html#a6be7575bf966a660f803dac1a3ea93a8">status</a> &amp; <a class="code" href="usbhdfsd-common_8h.html#aa5c99685aa651d8ce438c6a9f0cd3152">USBMASS_DEV_STAT_CONN</a>) &amp;&amp; !(dev-&gt;<a class="code" href="structmass__dev.html#a6be7575bf966a660f803dac1a3ea93a8">status</a> &amp; <a class="code" href="usbhdfsd-common_8h.html#af2a46b2bb1f8bf8aaae7fb2578328540">USBMASS_DEV_STAT_CONF</a>))</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                {</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;                        <span class="keywordtype">int</span> ret;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;                        ret = <a class="code" href="usb__driver_8c.html#aed1ce7a5a6c88412c4c29698e59fe19f">mass_store_configureDevice</a>(dev);</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                        <span class="keywordflow">if</span> (ret != <a class="code" href="usbd_8h.html#a3b8b9136f0f637fbcc6295a7862051b4">USB_RC_OK</a>)</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;                        {</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;                                <a class="code" href="usb__driver_8c.html#a5748452cf98cd5f27246f1a368bb0625">mass_stor_release</a>(dev);</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;                        }</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;                        dev-&gt;<a class="code" href="structmass__dev.html#a6be7575bf966a660f803dac1a3ea93a8">status</a> |= <a class="code" href="usbhdfsd-common_8h.html#af2a46b2bb1f8bf8aaae7fb2578328540">USBMASS_DEV_STAT_CONF</a>;</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160; </div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;                        ret = <a class="code" href="usb__driver_8c.html#ac5f50557bc4ff33b185d8462f65b7c5f">mass_stor_warmup</a>(dev);</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                        <span class="keywordflow">if</span> (ret &lt; 0)</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                        {</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                                <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;USBHDFSD: Error - failed to warmup device %d\n&quot;</span>, dev-&gt;<a class="code" href="structmass__dev.html#afe3c44bc7f3dace3dcb0c55df1ba5910">devId</a>);</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;                                <a class="code" href="usb__driver_8c.html#a5748452cf98cd5f27246f1a368bb0625">mass_stor_release</a>(dev);</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;                                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;                        }</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160; </div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                        dev-&gt;cache = <a class="code" href="fs_2bdmfs__vfat_2src_2include_2scache_8h.html#ae63d9affeef2010a490b995331f34ec0">scache_init</a>(dev, dev-&gt;sectorSize); <span class="comment">// modified by Hermes</span></div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;                        <span class="keywordflow">if</span> (dev-&gt;cache == <a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;                                <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;USBHDFSD: Error - scache_init failed \n&quot;</span> );</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                                <a class="code" href="usb__driver_8c.html#a5748452cf98cd5f27246f1a368bb0625">mass_stor_release</a>(dev);</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                                <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                        }</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160; </div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                        <span class="keywordflow">return</span> <a class="code" href="fs_2bdm_2src_2part__driver_8c.html#a316de2cfc994b3c5d362bb0cd836b867">part_connect</a>(dev) &gt;= 0;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                }</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        }</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;}</div>
<div class="ttc" id="afs_2bdm_2src_2part__driver_8c_html_a316de2cfc994b3c5d362bb0cd836b867"><div class="ttname"><a href="fs_2bdm_2src_2part__driver_8c.html#a316de2cfc994b3c5d362bb0cd836b867">part_connect</a></div><div class="ttdeci">int part_connect(struct block_device *bd)</div><div class="ttdef"><b>Definition:</b> <a href="fs_2bdm_2src_2part__driver_8c_source.html#l00118">part_driver.c:118</a></div></div>
<div class="ttc" id="afs_2bdmfs__vfat_2src_2include_2scache_8h_html_ae63d9affeef2010a490b995331f34ec0"><div class="ttname"><a href="fs_2bdmfs__vfat_2src_2include_2scache_8h.html#ae63d9affeef2010a490b995331f34ec0">scache_init</a></div><div class="ttdeci">cache_set * scache_init(struct block_device *bd)</div><div class="ttdef"><b>Definition:</b> <a href="fs_2bdmfs__vfat_2src_2scache_8c_source.html#l00277">scache.c:277</a></div></div>
<div class="ttc" id="astructmass__dev_html"><div class="ttname"><a href="structmass__dev.html">mass_dev</a></div><div class="ttdef"><b>Definition:</b> <a href="usb__mass_8c_source.html#l00039">usb_mass.c:39</a></div></div>
<div class="ttc" id="ausb__driver_8c_html_a5748452cf98cd5f27246f1a368bb0625"><div class="ttname"><a href="usb__driver_8c.html#a5748452cf98cd5f27246f1a368bb0625">mass_stor_release</a></div><div class="ttdeci">static void mass_stor_release(mass_dev *dev)</div><div class="ttdef"><b>Definition:</b> <a href="usb__driver_8c_source.html#l00948">usb_driver.c:948</a></div></div>
<div class="ttc" id="ausb__driver_8c_html_ac5f50557bc4ff33b185d8462f65b7c5f"><div class="ttname"><a href="usb__driver_8c.html#ac5f50557bc4ff33b185d8462f65b7c5f">mass_stor_warmup</a></div><div class="ttdeci">static int mass_stor_warmup(mass_dev *dev)</div><div class="ttdef"><b>Definition:</b> <a href="usb__driver_8c_source.html#l00994">usb_driver.c:994</a></div></div>
<div class="ttc" id="ausb__driver_8c_html_aed1ce7a5a6c88412c4c29698e59fe19f"><div class="ttname"><a href="usb__driver_8c.html#aed1ce7a5a6c88412c4c29698e59fe19f">mass_store_configureDevice</a></div><div class="ttdeci">static int mass_store_configureDevice(mass_dev *dev)</div><div class="ttdef"><b>Definition:</b> <a href="usb__driver_8c_source.html#l01055">usb_driver.c:1055</a></div></div>
<div class="ttc" id="ausbd_8h_html_a3b8b9136f0f637fbcc6295a7862051b4"><div class="ttname"><a href="usbd_8h.html#a3b8b9136f0f637fbcc6295a7862051b4">USB_RC_OK</a></div><div class="ttdeci">#define USB_RC_OK</div><div class="ttdef"><b>Definition:</b> <a href="usbd_8h_source.html#l00211">usbd.h:211</a></div></div>
<div class="ttc" id="ausbhdfsd-common_8h_html_aa5c99685aa651d8ce438c6a9f0cd3152"><div class="ttname"><a href="usbhdfsd-common_8h.html#aa5c99685aa651d8ce438c6a9f0cd3152">USBMASS_DEV_STAT_CONN</a></div><div class="ttdeci">#define USBMASS_DEV_STAT_CONN</div><div class="ttdef"><b>Definition:</b> <a href="usbhdfsd-common_8h_source.html#l00036">usbhdfsd-common.h:36</a></div></div>
<div class="ttc" id="ausbhdfsd-common_8h_html_af2a46b2bb1f8bf8aaae7fb2578328540"><div class="ttname"><a href="usbhdfsd-common_8h.html#af2a46b2bb1f8bf8aaae7fb2578328540">USBMASS_DEV_STAT_CONF</a></div><div class="ttdeci">#define USBMASS_DEV_STAT_CONF</div><div class="ttdef"><b>Definition:</b> <a href="usbhdfsd-common_8h_source.html#l00038">usbhdfsd-common.h:38</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="usb__mass_8c_source.html#l00043">mass_dev::devId</a>, <a class="el" href="usb__driver_8c_source.html#l00117">g_mass_device</a>, <a class="el" href="usb__driver_8c_source.html#l00948">mass_stor_release()</a>, <a class="el" href="usb__driver_8c_source.html#l00994">mass_stor_warmup()</a>, <a class="el" href="usb__driver_8c_source.html#l01055">mass_store_configureDevice()</a>, <a class="el" href="defs_8h_source.html#l00022">NULL</a>, <a class="el" href="usb__driver_8c_source.html#l00116">NUM_DEVICES</a>, <a class="el" href="fs_2bdm_2src_2part__driver_8c_source.html#l00118">part_connect()</a>, <a class="el" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf()</a>, <a class="el" href="fs_2bdmfs__vfat_2src_2scache_8c_source.html#l00277">scache_init()</a>, <a class="el" href="usb__mass_8c_source.html#l00045">mass_dev::status</a>, <a class="el" href="usbd_8h_source.html#l00211">USB_RC_OK</a>, <a class="el" href="usbhdfsd-common_8h_source.html#l00038">USBMASS_DEV_STAT_CONF</a>, <a class="el" href="usbhdfsd-common_8h_source.html#l00036">USBMASS_DEV_STAT_CONN</a>, and <a class="el" href="iLink_2IEEE1394__disk_2src_2include_2mass__debug_8h_source.html#l00008">XPRINTF</a>.</p>

<p class="reference">Referenced by <a class="el" href="usb_2usbhdfsd_2src_2fat__driver_8c_source.html#l01044">fat_getData()</a>.</p>

</div>
</div>
<a id="a0ff55f48cdae5bca89ba8e3b20d22e5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ff55f48cdae5bca89ba8e3b20d22e5a">&#9670;&nbsp;</a></span>mass_stor_connect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mass_stor_connect </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>devId</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="usb__driver_8c_source.html#l00866">866</a> of file <a class="el" href="usb__driver_8c_source.html">usb_driver.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;{</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        <span class="keywordtype">int</span> epCount;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        <a class="code" href="structUsbDeviceDescriptor.html">UsbDeviceDescriptor</a> *device;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        <a class="code" href="structUsbConfigDescriptor.html">UsbConfigDescriptor</a> *config;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <a class="code" href="structUsbInterfaceDescriptor.html">UsbInterfaceDescriptor</a> *interface;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        <a class="code" href="structUsbEndpointDescriptor.html">UsbEndpointDescriptor</a> *endpoint;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        <a class="code" href="structiop__sema__t.html">iop_sema_t</a> SemaData;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        <a class="code" href="structmass__dev.html">mass_dev</a>* dev;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160; </div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;USBHDFSD: connect: devId=%i\n&quot;</span>, devId);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        dev = <a class="code" href="usb__driver_8c.html#acb565e6e69a6f2bb093c984f2f8c4c85">mass_stor_findDevice</a>(devId, 1);</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160; </div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        <span class="keywordflow">if</span> (dev == <a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;USBHDFSD: Error - no free device descriptors!\n&quot;</span>);</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;                <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        }</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        <span class="comment">/* Device cannot be registered twice. */</span></div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        <span class="keywordflow">if</span> (dev-&gt;<a class="code" href="structmass__dev.html#afe3c44bc7f3dace3dcb0c55df1ba5910">devId</a> != -1) {</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;USBHDFSD: Error - device descriptor in use!\n&quot;</span>);</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        }</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160; </div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        dev-&gt;<a class="code" href="structmass__dev.html#a6be7575bf966a660f803dac1a3ea93a8">status</a> = 0;</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        dev-&gt;sectorSize = 0;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160; </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        dev-&gt;<a class="code" href="structmass__dev.html#af8a785c191fd80fe2edca38345626a35">bulkEpI</a> = -1;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        dev-&gt;<a class="code" href="structmass__dev.html#a195cac53a5dda42d1d2c4ca8ea89b8a8">bulkEpO</a> = -1;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160; </div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <span class="comment">/* open the config endpoint */</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        dev-&gt;<a class="code" href="structmass__dev.html#a17dea29a36068a39dc234f8e0f3dc831">controlEp</a> = <a class="code" href="usbd_8h.html#a0d95474f7a416aab8d90540d054ff810">sceUsbdOpenPipe</a>(devId, <a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160; </div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        device = (<a class="code" href="structUsbDeviceDescriptor.html">UsbDeviceDescriptor</a>*)<a class="code" href="usbd_8h.html#a493e4798fe5bfedc234585d07aba775c">sceUsbdScanStaticDescriptor</a>(devId, <a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="usbd_8h.html#a906ba0fa4d6863d2035b57c95e47d85a">USB_DT_DEVICE</a>);</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160; </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        config = (<a class="code" href="structUsbConfigDescriptor.html">UsbConfigDescriptor</a>*)<a class="code" href="usbd_8h.html#a493e4798fe5bfedc234585d07aba775c">sceUsbdScanStaticDescriptor</a>(devId, device, <a class="code" href="usbd_8h.html#acb09b89c4c238b966761f3d6b22a115d">USB_DT_CONFIG</a>);</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160; </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        <span class="keyword">interface </span>= (<a class="code" href="structUsbInterfaceDescriptor.html">UsbInterfaceDescriptor</a> *) ((<span class="keywordtype">char</span> *) config + config-&gt;<a class="code" href="structUsbConfigDescriptor.html#af9acfe2365b370b35f149c6289789d7b">bLength</a>); <span class="comment">/* Get first interface */</span></div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160; </div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        <span class="comment">// store interface numbers</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        dev-&gt;<a class="code" href="structmass__dev.html#ad7347c41ce3e2682406760cb4de70582">interfaceNumber</a> = interface-&gt;<a class="code" href="structUsbInterfaceDescriptor.html#aa47b389e8f86314fe740be1870792825">bInterfaceNumber</a>;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        dev-&gt;<a class="code" href="structmass__dev.html#a5cfa9401b37765141c3036acc4f22a2a">interfaceAlt</a>    = interface-&gt;<a class="code" href="structUsbInterfaceDescriptor.html#ae33f8ea295bd9b1c94e66b1786f4b5cc">bAlternateSetting</a>;</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        epCount = interface-&gt;<a class="code" href="structUsbInterfaceDescriptor.html#a322bc68b5bd492e76359d64f738332b5">bNumEndpoints</a>;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        endpoint = (<a class="code" href="structUsbEndpointDescriptor.html">UsbEndpointDescriptor</a>*)<a class="code" href="usbd_8h.html#a493e4798fe5bfedc234585d07aba775c">sceUsbdScanStaticDescriptor</a>(devId, <a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="usbd_8h.html#a0ff819fc4805498bea95488270afca76">USB_DT_ENDPOINT</a>);</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <a class="code" href="usb__driver_8c.html#a47666dc7315b55a8e0874bde032609c6">usb_bulk_probeEndpoint</a>(devId, dev, endpoint);</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160; </div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        <span class="keywordflow">for</span> (i = 1; i &lt; epCount; i++)</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        {</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                endpoint = (<a class="code" href="structUsbEndpointDescriptor.html">UsbEndpointDescriptor</a>*) ((<span class="keywordtype">char</span> *) endpoint + endpoint-&gt;<a class="code" href="structUsbEndpointDescriptor.html#af964bb56cf28e6d2cc67f8f28bafdc1b">bLength</a>);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                <a class="code" href="usb__driver_8c.html#a47666dc7315b55a8e0874bde032609c6">usb_bulk_probeEndpoint</a>(devId, dev, endpoint);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        }</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        <span class="comment">// Bail out if we do NOT have enough bulk endpoints.</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        <span class="keywordflow">if</span> (dev-&gt;<a class="code" href="structmass__dev.html#af8a785c191fd80fe2edca38345626a35">bulkEpI</a> &lt; 0 || dev-&gt;<a class="code" href="structmass__dev.html#a195cac53a5dda42d1d2c4ca8ea89b8a8">bulkEpO</a> &lt; 0) {</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                <a class="code" href="usb__driver_8c.html#a5748452cf98cd5f27246f1a368bb0625">mass_stor_release</a>(dev);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;USBHDFSD: Error - connect failed: not enough bulk endpoints! \n&quot;</span>);</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        }</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        SemaData.<a class="code" href="structiop__sema__t.html#a2fbb81e301225c49434581c55456a97d">initial</a> = 0;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        SemaData.<a class="code" href="structiop__sema__t.html#a48acf177ef0aa3533102fbf3ded3807e">max</a> = 1;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        SemaData.<a class="code" href="structiop__sema__t.html#a7024b4d5f758838126e1c2c0b29e839d">option</a> = 0;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        SemaData.<a class="code" href="structiop__sema__t.html#a9d36f543cdbb61037adf7a95c52ad6eb">attr</a> = 0;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        <span class="keywordflow">if</span>((dev-&gt;<a class="code" href="structmass__dev.html#ab2dc237d4a84c1315d643d9655318a74">ioSema</a> = <a class="code" href="thsemap_8h.html#a89f81196e12e85533aef2886340207b7">CreateSema</a>(&amp;SemaData)) &lt;0){</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;                <a class="code" href="usb__driver_8c.html#a5748452cf98cd5f27246f1a368bb0625">mass_stor_release</a>(dev);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;USBHDFSD: Failed to allocate I/O semaphore.\n&quot;</span>);</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        }</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160; </div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        <span class="comment">/*store current configuration id - can&#39;t call set_configuration here */</span></div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        dev-&gt;<a class="code" href="structmass__dev.html#afe3c44bc7f3dace3dcb0c55df1ba5910">devId</a> = devId;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        dev-&gt;<a class="code" href="structmass__dev.html#afdc7211624f24172d6caf7a4552e8442">configId</a> = config-&gt;<a class="code" href="structUsbConfigDescriptor.html#aa248c8963c33382fd945113bf54919bb">bConfigurationValue</a>;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        dev-&gt;<a class="code" href="structmass__dev.html#a6be7575bf966a660f803dac1a3ea93a8">status</a> = <a class="code" href="usbhdfsd-common_8h.html#aa5c99685aa651d8ce438c6a9f0cd3152">USBMASS_DEV_STAT_CONN</a>;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        <a class="code" href="iLink_2IEEE1394__disk_2src_2include_2mass__debug_8h.html#a730a51a001461c80e0268109f4bdf849">XPRINTF</a>(<span class="stringliteral">&quot;USBHDFSD: connect ok: epI=%i, epO=%i \n&quot;</span>, dev-&gt;<a class="code" href="structmass__dev.html#af8a785c191fd80fe2edca38345626a35">bulkEpI</a>, dev-&gt;<a class="code" href="structmass__dev.html#a195cac53a5dda42d1d2c4ca8ea89b8a8">bulkEpO</a>);</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160; </div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        <span class="keywordflow">if</span>(dev-&gt;callback != <a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) dev-&gt;callback(<a class="code" href="usbhdfsd-common_8h.html#a7efe7ec1bc89066873492ec5803258e4ae7b1c8dae1f140c18f3f25f803b2559f">USBMASS_DEV_EV_CONN</a>);</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160; </div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;}</div>
<div class="ttc" id="astructUsbConfigDescriptor_html"><div class="ttname"><a href="structUsbConfigDescriptor.html">UsbConfigDescriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="usbd_8h_source.html#l00077">usbd.h:77</a></div></div>
<div class="ttc" id="astructUsbConfigDescriptor_html_aa248c8963c33382fd945113bf54919bb"><div class="ttname"><a href="structUsbConfigDescriptor.html#aa248c8963c33382fd945113bf54919bb">UsbConfigDescriptor::bConfigurationValue</a></div><div class="ttdeci">u8 bConfigurationValue</div><div class="ttdef"><b>Definition:</b> <a href="usbd_8h_source.html#l00084">usbd.h:84</a></div></div>
<div class="ttc" id="astructUsbConfigDescriptor_html_af9acfe2365b370b35f149c6289789d7b"><div class="ttname"><a href="structUsbConfigDescriptor.html#af9acfe2365b370b35f149c6289789d7b">UsbConfigDescriptor::bLength</a></div><div class="ttdeci">u8 bLength</div><div class="ttdef"><b>Definition:</b> <a href="usbd_8h_source.html#l00078">usbd.h:78</a></div></div>
<div class="ttc" id="astructUsbDeviceDescriptor_html"><div class="ttname"><a href="structUsbDeviceDescriptor.html">UsbDeviceDescriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="usbd_8h_source.html#l00060">usbd.h:60</a></div></div>
<div class="ttc" id="astructUsbEndpointDescriptor_html"><div class="ttname"><a href="structUsbEndpointDescriptor.html">UsbEndpointDescriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="usbd_8h_source.html#l00102">usbd.h:102</a></div></div>
<div class="ttc" id="astructUsbEndpointDescriptor_html_af964bb56cf28e6d2cc67f8f28bafdc1b"><div class="ttname"><a href="structUsbEndpointDescriptor.html#af964bb56cf28e6d2cc67f8f28bafdc1b">UsbEndpointDescriptor::bLength</a></div><div class="ttdeci">u8 bLength</div><div class="ttdef"><b>Definition:</b> <a href="usbd_8h_source.html#l00103">usbd.h:103</a></div></div>
<div class="ttc" id="astructUsbInterfaceDescriptor_html"><div class="ttname"><a href="structUsbInterfaceDescriptor.html">UsbInterfaceDescriptor</a></div><div class="ttdef"><b>Definition:</b> <a href="usbd_8h_source.html#l00090">usbd.h:90</a></div></div>
<div class="ttc" id="astructUsbInterfaceDescriptor_html_a322bc68b5bd492e76359d64f738332b5"><div class="ttname"><a href="structUsbInterfaceDescriptor.html#a322bc68b5bd492e76359d64f738332b5">UsbInterfaceDescriptor::bNumEndpoints</a></div><div class="ttdeci">u8 bNumEndpoints</div><div class="ttdef"><b>Definition:</b> <a href="usbd_8h_source.html#l00095">usbd.h:95</a></div></div>
<div class="ttc" id="astructUsbInterfaceDescriptor_html_aa47b389e8f86314fe740be1870792825"><div class="ttname"><a href="structUsbInterfaceDescriptor.html#aa47b389e8f86314fe740be1870792825">UsbInterfaceDescriptor::bInterfaceNumber</a></div><div class="ttdeci">u8 bInterfaceNumber</div><div class="ttdef"><b>Definition:</b> <a href="usbd_8h_source.html#l00093">usbd.h:93</a></div></div>
<div class="ttc" id="astructUsbInterfaceDescriptor_html_ae33f8ea295bd9b1c94e66b1786f4b5cc"><div class="ttname"><a href="structUsbInterfaceDescriptor.html#ae33f8ea295bd9b1c94e66b1786f4b5cc">UsbInterfaceDescriptor::bAlternateSetting</a></div><div class="ttdeci">u8 bAlternateSetting</div><div class="ttdef"><b>Definition:</b> <a href="usbd_8h_source.html#l00094">usbd.h:94</a></div></div>
<div class="ttc" id="astructiop__sema__t_html"><div class="ttname"><a href="structiop__sema__t.html">iop_sema_t</a></div><div class="ttdef"><b>Definition:</b> <a href="thsemap_8h_source.html#l00034">thsemap.h:34</a></div></div>
<div class="ttc" id="astructiop__sema__t_html_a2fbb81e301225c49434581c55456a97d"><div class="ttname"><a href="structiop__sema__t.html#a2fbb81e301225c49434581c55456a97d">iop_sema_t::initial</a></div><div class="ttdeci">int initial</div><div class="ttdef"><b>Definition:</b> <a href="thsemap_8h_source.html#l00037">thsemap.h:37</a></div></div>
<div class="ttc" id="astructiop__sema__t_html_a48acf177ef0aa3533102fbf3ded3807e"><div class="ttname"><a href="structiop__sema__t.html#a48acf177ef0aa3533102fbf3ded3807e">iop_sema_t::max</a></div><div class="ttdeci">int max</div><div class="ttdef"><b>Definition:</b> <a href="thsemap_8h_source.html#l00038">thsemap.h:38</a></div></div>
<div class="ttc" id="astructiop__sema__t_html_a7024b4d5f758838126e1c2c0b29e839d"><div class="ttname"><a href="structiop__sema__t.html#a7024b4d5f758838126e1c2c0b29e839d">iop_sema_t::option</a></div><div class="ttdeci">u32 option</div><div class="ttdef"><b>Definition:</b> <a href="thsemap_8h_source.html#l00036">thsemap.h:36</a></div></div>
<div class="ttc" id="astructiop__sema__t_html_a9d36f543cdbb61037adf7a95c52ad6eb"><div class="ttname"><a href="structiop__sema__t.html#a9d36f543cdbb61037adf7a95c52ad6eb">iop_sema_t::attr</a></div><div class="ttdeci">u32 attr</div><div class="ttdef"><b>Definition:</b> <a href="thsemap_8h_source.html#l00035">thsemap.h:35</a></div></div>
<div class="ttc" id="astructmass__dev_html_a17dea29a36068a39dc234f8e0f3dc831"><div class="ttname"><a href="structmass__dev.html#a17dea29a36068a39dc234f8e0f3dc831">mass_dev::controlEp</a></div><div class="ttdeci">int controlEp</div><div class="ttdef"><b>Definition:</b> <a href="usb__mass_8c_source.html#l00040">usb_mass.c:40</a></div></div>
<div class="ttc" id="astructmass__dev_html_a195cac53a5dda42d1d2c4ca8ea89b8a8"><div class="ttname"><a href="structmass__dev.html#a195cac53a5dda42d1d2c4ca8ea89b8a8">mass_dev::bulkEpO</a></div><div class="ttdeci">int bulkEpO</div><div class="ttdef"><b>Definition:</b> <a href="usb__mass_8c_source.html#l00042">usb_mass.c:42</a></div></div>
<div class="ttc" id="astructmass__dev_html_a5cfa9401b37765141c3036acc4f22a2a"><div class="ttname"><a href="structmass__dev.html#a5cfa9401b37765141c3036acc4f22a2a">mass_dev::interfaceAlt</a></div><div class="ttdeci">unsigned char interfaceAlt</div><div class="ttdef"><b>Definition:</b> <a href="usb__mass_8c_source.html#l00047">usb_mass.c:47</a></div></div>
<div class="ttc" id="astructmass__dev_html_ab2dc237d4a84c1315d643d9655318a74"><div class="ttname"><a href="structmass__dev.html#ab2dc237d4a84c1315d643d9655318a74">mass_dev::ioSema</a></div><div class="ttdeci">int ioSema</div><div class="ttdef"><b>Definition:</b> <a href="usb__mass_8c_source.html#l00048">usb_mass.c:48</a></div></div>
<div class="ttc" id="astructmass__dev_html_ad7347c41ce3e2682406760cb4de70582"><div class="ttname"><a href="structmass__dev.html#ad7347c41ce3e2682406760cb4de70582">mass_dev::interfaceNumber</a></div><div class="ttdeci">unsigned char interfaceNumber</div><div class="ttdef"><b>Definition:</b> <a href="usb__mass_8c_source.html#l00046">usb_mass.c:46</a></div></div>
<div class="ttc" id="astructmass__dev_html_af8a785c191fd80fe2edca38345626a35"><div class="ttname"><a href="structmass__dev.html#af8a785c191fd80fe2edca38345626a35">mass_dev::bulkEpI</a></div><div class="ttdeci">int bulkEpI</div><div class="ttdef"><b>Definition:</b> <a href="usb__mass_8c_source.html#l00041">usb_mass.c:41</a></div></div>
<div class="ttc" id="astructmass__dev_html_afdc7211624f24172d6caf7a4552e8442"><div class="ttname"><a href="structmass__dev.html#afdc7211624f24172d6caf7a4552e8442">mass_dev::configId</a></div><div class="ttdeci">unsigned char configId</div><div class="ttdef"><b>Definition:</b> <a href="usb__mass_8c_source.html#l00044">usb_mass.c:44</a></div></div>
<div class="ttc" id="athsemap_8h_html_a89f81196e12e85533aef2886340207b7"><div class="ttname"><a href="thsemap_8h.html#a89f81196e12e85533aef2886340207b7">CreateSema</a></div><div class="ttdeci">int CreateSema(iop_sema_t *sema)</div></div>
<div class="ttc" id="ausb__driver_8c_html_a47666dc7315b55a8e0874bde032609c6"><div class="ttname"><a href="usb__driver_8c.html#a47666dc7315b55a8e0874bde032609c6">usb_bulk_probeEndpoint</a></div><div class="ttdeci">static void usb_bulk_probeEndpoint(int devId, mass_dev *dev, UsbEndpointDescriptor *endpoint)</div><div class="ttdef"><b>Definition:</b> <a href="usb__driver_8c_source.html#l00790">usb_driver.c:790</a></div></div>
<div class="ttc" id="ausb__driver_8c_html_acb565e6e69a6f2bb093c984f2f8c4c85"><div class="ttname"><a href="usb__driver_8c.html#acb565e6e69a6f2bb093c984f2f8c4c85">mass_stor_findDevice</a></div><div class="ttdeci">static mass_dev * mass_stor_findDevice(int devId, int create)</div><div class="ttdef"><b>Definition:</b> <a href="usb__driver_8c_source.html#l00741">usb_driver.c:741</a></div></div>
<div class="ttc" id="ausbd_8h_html_a0d95474f7a416aab8d90540d054ff810"><div class="ttname"><a href="usbd_8h.html#a0d95474f7a416aab8d90540d054ff810">sceUsbdOpenPipe</a></div><div class="ttdeci">int sceUsbdOpenPipe(int devId, UsbEndpointDescriptor *desc)</div><div class="ttdef"><b>Definition:</b> <a href="interface_8c_source.html#l00186">interface.c:186</a></div></div>
<div class="ttc" id="ausbd_8h_html_a0ff819fc4805498bea95488270afca76"><div class="ttname"><a href="usbd_8h.html#a0ff819fc4805498bea95488270afca76">USB_DT_ENDPOINT</a></div><div class="ttdeci">#define USB_DT_ENDPOINT</div><div class="ttdef"><b>Definition:</b> <a href="usbd_8h_source.html#l00190">usbd.h:190</a></div></div>
<div class="ttc" id="ausbd_8h_html_a493e4798fe5bfedc234585d07aba775c"><div class="ttname"><a href="usbd_8h.html#a493e4798fe5bfedc234585d07aba775c">sceUsbdScanStaticDescriptor</a></div><div class="ttdeci">void * sceUsbdScanStaticDescriptor(int devId, void *data, u8 type)</div><div class="ttdef"><b>Definition:</b> <a href="interface_8c_source.html#l00101">interface.c:101</a></div></div>
<div class="ttc" id="ausbd_8h_html_a906ba0fa4d6863d2035b57c95e47d85a"><div class="ttname"><a href="usbd_8h.html#a906ba0fa4d6863d2035b57c95e47d85a">USB_DT_DEVICE</a></div><div class="ttdeci">#define USB_DT_DEVICE</div><div class="ttdef"><b>Definition:</b> <a href="usbd_8h_source.html#l00186">usbd.h:186</a></div></div>
<div class="ttc" id="ausbd_8h_html_acb09b89c4c238b966761f3d6b22a115d"><div class="ttname"><a href="usbd_8h.html#acb09b89c4c238b966761f3d6b22a115d">USB_DT_CONFIG</a></div><div class="ttdeci">#define USB_DT_CONFIG</div><div class="ttdef"><b>Definition:</b> <a href="usbd_8h_source.html#l00187">usbd.h:187</a></div></div>
<div class="ttc" id="ausbhdfsd-common_8h_html_a7efe7ec1bc89066873492ec5803258e4ae7b1c8dae1f140c18f3f25f803b2559f"><div class="ttname"><a href="usbhdfsd-common_8h.html#a7efe7ec1bc89066873492ec5803258e4ae7b1c8dae1f140c18f3f25f803b2559f">USBMASS_DEV_EV_CONN</a></div><div class="ttdeci">@ USBMASS_DEV_EV_CONN</div><div class="ttdef"><b>Definition:</b> <a href="usbhdfsd-common_8h_source.html#l00044">usbhdfsd-common.h:44</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="thsemap_8h_source.html#l00035">iop_sema_t::attr</a>, <a class="el" href="usbd_8h_source.html#l00094">UsbInterfaceDescriptor::bAlternateSetting</a>, <a class="el" href="usbd_8h_source.html#l00084">UsbConfigDescriptor::bConfigurationValue</a>, <a class="el" href="usbd_8h_source.html#l00093">UsbInterfaceDescriptor::bInterfaceNumber</a>, <a class="el" href="usbd_8h_source.html#l00078">UsbConfigDescriptor::bLength</a>, <a class="el" href="usbd_8h_source.html#l00103">UsbEndpointDescriptor::bLength</a>, <a class="el" href="usbd_8h_source.html#l00095">UsbInterfaceDescriptor::bNumEndpoints</a>, <a class="el" href="usb__mass_8c_source.html#l00041">mass_dev::bulkEpI</a>, <a class="el" href="usb__mass_8c_source.html#l00042">mass_dev::bulkEpO</a>, <a class="el" href="usb__mass_8c_source.html#l00044">mass_dev::configId</a>, <a class="el" href="usb__mass_8c_source.html#l00040">mass_dev::controlEp</a>, <a class="el" href="thsemap_8h.html#a89f81196e12e85533aef2886340207b7">CreateSema()</a>, <a class="el" href="usb__mass_8c_source.html#l00043">mass_dev::devId</a>, <a class="el" href="thsemap_8h_source.html#l00037">iop_sema_t::initial</a>, <a class="el" href="usb__mass_8c_source.html#l00047">mass_dev::interfaceAlt</a>, <a class="el" href="usb__mass_8c_source.html#l00046">mass_dev::interfaceNumber</a>, <a class="el" href="usb__mass_8c_source.html#l00048">mass_dev::ioSema</a>, <a class="el" href="usb__driver_8c_source.html#l00741">mass_stor_findDevice()</a>, <a class="el" href="usb__driver_8c_source.html#l00948">mass_stor_release()</a>, <a class="el" href="thsemap_8h_source.html#l00038">iop_sema_t::max</a>, <a class="el" href="defs_8h_source.html#l00022">NULL</a>, <a class="el" href="thsemap_8h_source.html#l00036">iop_sema_t::option</a>, <a class="el" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf()</a>, <a class="el" href="interface_8c_source.html#l00186">sceUsbdOpenPipe()</a>, <a class="el" href="interface_8c_source.html#l00101">sceUsbdScanStaticDescriptor()</a>, <a class="el" href="usb__mass_8c_source.html#l00045">mass_dev::status</a>, <a class="el" href="usb__driver_8c_source.html#l00790">usb_bulk_probeEndpoint()</a>, <a class="el" href="usbd_8h_source.html#l00187">USB_DT_CONFIG</a>, <a class="el" href="usbd_8h_source.html#l00186">USB_DT_DEVICE</a>, <a class="el" href="usbd_8h_source.html#l00190">USB_DT_ENDPOINT</a>, <a class="el" href="usbhdfsd-common_8h_source.html#l00044">USBMASS_DEV_EV_CONN</a>, <a class="el" href="usbhdfsd-common_8h_source.html#l00036">USBMASS_DEV_STAT_CONN</a>, and <a class="el" href="iLink_2IEEE1394__disk_2src_2include_2mass__debug_8h_source.html#l00008">XPRINTF</a>.</p>

<p class="reference">Referenced by <a class="el" href="usb__driver_8c_source.html#l01123">InitUSB()</a>.</p>

</div>
</div>
<a id="a4810a9f44bac8abf9a7264ad6738ff62"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4810a9f44bac8abf9a7264ad6738ff62">&#9670;&nbsp;</a></span>mass_stor_disconnect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mass_stor_disconnect </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>devId</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="usb__driver_8c_source.html#l00966">966</a> of file <a class="el" href="usb__driver_8c_source.html">usb_driver.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;                                    {</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <a class="code" href="structmass__dev.html">mass_dev</a>* dev;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        dev = <a class="code" href="usb__driver_8c.html#acb565e6e69a6f2bb093c984f2f8c4c85">mass_stor_findDevice</a>(devId, 0);</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160; </div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;USBHDFSD: disconnect: devId=%i\n&quot;</span>, devId);</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160; </div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <span class="keywordflow">if</span> (dev == <a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        {</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;USBHDFSD: Error - disconnect: no device storage!\n&quot;</span>);</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        }</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160; </div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        <span class="keywordflow">if</span> (dev-&gt;<a class="code" href="structmass__dev.html#a6be7575bf966a660f803dac1a3ea93a8">status</a> &amp; <a class="code" href="usbhdfsd-common_8h.html#aa5c99685aa651d8ce438c6a9f0cd3152">USBMASS_DEV_STAT_CONN</a>)</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        {</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                <a class="code" href="usb__driver_8c.html#a5748452cf98cd5f27246f1a368bb0625">mass_stor_release</a>(dev);</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                <a class="code" href="fs_2bdm_2src_2part__driver_8c.html#ad4a0422cb20d85aeb27bc544b0b8be39">part_disconnect</a>(dev);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;                <a class="code" href="fs_2bdmfs__vfat_2src_2include_2scache_8h.html#a0b459f243044c89735349c2b79a0485d">scache_kill</a>(dev-&gt;cache);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                dev-&gt;cache = <a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;                dev-&gt;<a class="code" href="structmass__dev.html#afe3c44bc7f3dace3dcb0c55df1ba5910">devId</a> = -1;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160; </div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;                <a class="code" href="thsemap_8h.html#aee7ad551c1fe522d76e545cfc2ac046c">DeleteSema</a>(dev-&gt;<a class="code" href="structmass__dev.html#ab2dc237d4a84c1315d643d9655318a74">ioSema</a>);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160; </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                <span class="keywordflow">if</span>(dev-&gt;callback != <a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) dev-&gt;callback(<a class="code" href="usbhdfsd-common_8h.html#a7efe7ec1bc89066873492ec5803258e4a5ba4d329b31bcc6f4a29572e2a26c9b4">USBMASS_DEV_EV_DISCONN</a>);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        }</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160; </div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;}</div>
<div class="ttc" id="afs_2bdm_2src_2part__driver_8c_html_ad4a0422cb20d85aeb27bc544b0b8be39"><div class="ttname"><a href="fs_2bdm_2src_2part__driver_8c.html#ad4a0422cb20d85aeb27bc544b0b8be39">part_disconnect</a></div><div class="ttdeci">void part_disconnect(struct block_device *bd)</div><div class="ttdef"><b>Definition:</b> <a href="fs_2bdm_2src_2part__driver_8c_source.html#l00142">part_driver.c:142</a></div></div>
<div class="ttc" id="afs_2bdmfs__vfat_2src_2include_2scache_8h_html_a0b459f243044c89735349c2b79a0485d"><div class="ttname"><a href="fs_2bdmfs__vfat_2src_2include_2scache_8h.html#a0b459f243044c89735349c2b79a0485d">scache_kill</a></div><div class="ttdeci">void scache_kill(cache_set *cache)</div><div class="ttdef"><b>Definition:</b> <a href="fs_2bdmfs__vfat_2src_2scache_8c_source.html#l00320">scache.c:320</a></div></div>
<div class="ttc" id="athsemap_8h_html_aee7ad551c1fe522d76e545cfc2ac046c"><div class="ttname"><a href="thsemap_8h.html#aee7ad551c1fe522d76e545cfc2ac046c">DeleteSema</a></div><div class="ttdeci">int DeleteSema(int semid)</div></div>
<div class="ttc" id="ausbhdfsd-common_8h_html_a7efe7ec1bc89066873492ec5803258e4a5ba4d329b31bcc6f4a29572e2a26c9b4"><div class="ttname"><a href="usbhdfsd-common_8h.html#a7efe7ec1bc89066873492ec5803258e4a5ba4d329b31bcc6f4a29572e2a26c9b4">USBMASS_DEV_EV_DISCONN</a></div><div class="ttdeci">@ USBMASS_DEV_EV_DISCONN</div><div class="ttdef"><b>Definition:</b> <a href="usbhdfsd-common_8h_source.html#l00046">usbhdfsd-common.h:45</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="thsemap_8h.html#aee7ad551c1fe522d76e545cfc2ac046c">DeleteSema()</a>, <a class="el" href="usb__mass_8c_source.html#l00043">mass_dev::devId</a>, <a class="el" href="usb__mass_8c_source.html#l00048">mass_dev::ioSema</a>, <a class="el" href="usb__driver_8c_source.html#l00741">mass_stor_findDevice()</a>, <a class="el" href="usb__driver_8c_source.html#l00948">mass_stor_release()</a>, <a class="el" href="defs_8h_source.html#l00022">NULL</a>, <a class="el" href="fs_2bdm_2src_2part__driver_8c_source.html#l00142">part_disconnect()</a>, <a class="el" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf()</a>, <a class="el" href="fs_2bdmfs__vfat_2src_2scache_8c_source.html#l00320">scache_kill()</a>, <a class="el" href="usb__mass_8c_source.html#l00045">mass_dev::status</a>, <a class="el" href="usbhdfsd-common_8h_source.html#l00045">USBMASS_DEV_EV_DISCONN</a>, and <a class="el" href="usbhdfsd-common_8h_source.html#l00036">USBMASS_DEV_STAT_CONN</a>.</p>

<p class="reference">Referenced by <a class="el" href="usb__driver_8c_source.html#l01123">InitUSB()</a>.</p>

</div>
</div>
<a id="a2122a50e649036393e86bcf03c95c0ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2122a50e649036393e86bcf03c95c0ec">&#9670;&nbsp;</a></span>mass_stor_probe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mass_stor_probe </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>devId</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="usb__driver_8c_source.html#l00811">811</a> of file <a class="el" href="usb__driver_8c_source.html">usb_driver.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;{</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        <a class="code" href="structUsbDeviceDescriptor.html">UsbDeviceDescriptor</a> *device = <a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        <a class="code" href="structUsbConfigDescriptor.html">UsbConfigDescriptor</a> *config = <a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        <a class="code" href="structUsbInterfaceDescriptor.html">UsbInterfaceDescriptor</a> *intf = <a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160; </div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        <a class="code" href="iLink_2IEEE1394__disk_2src_2include_2mass__debug_8h.html#a730a51a001461c80e0268109f4bdf849">XPRINTF</a>(<span class="stringliteral">&quot;USBHDFSD: probe: devId=%i\n&quot;</span>, devId);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        <a class="code" href="structmass__dev.html">mass_dev</a>* mass_device = <a class="code" href="usb__driver_8c.html#acb565e6e69a6f2bb093c984f2f8c4c85">mass_stor_findDevice</a>(devId, 0);</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160; </div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        <span class="comment">/* Check that a device descriptor was successfully allocated and the device was not already connected. */</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <span class="keywordflow">if</span> ((mass_device != <a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) &amp;&amp; (mass_device-&gt;<a class="code" href="structmass__dev.html#a6be7575bf966a660f803dac1a3ea93a8">status</a> &amp; <a class="code" href="usbhdfsd-common_8h.html#aa5c99685aa651d8ce438c6a9f0cd3152">USBMASS_DEV_STAT_CONN</a>))</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        {</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;USBHDFSD: Error - no free device descriptors!\n&quot;</span>);</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        }</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160; </div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;        <span class="comment">/* get device descriptor */</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        device = (<a class="code" href="structUsbDeviceDescriptor.html">UsbDeviceDescriptor</a>*)<a class="code" href="usbd_8h.html#a493e4798fe5bfedc234585d07aba775c">sceUsbdScanStaticDescriptor</a>(devId, <a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="usbd_8h.html#a906ba0fa4d6863d2035b57c95e47d85a">USB_DT_DEVICE</a>);</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        <span class="keywordflow">if</span> (device == <a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)  {</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;USBHDFSD: Error - Couldn&#39;t get device descriptor\n&quot;</span>);</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;        }</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160; </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <span class="comment">/* Check if the device has at least one configuration */</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <span class="keywordflow">if</span> (device-&gt;<a class="code" href="structUsbDeviceDescriptor.html#ac2f85bb3a491aae80351e3418b09f7f6">bNumConfigurations</a> &lt; 1) { <span class="keywordflow">return</span> 0; }</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160; </div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        <span class="comment">/* read configuration */</span></div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        config = (<a class="code" href="structUsbConfigDescriptor.html">UsbConfigDescriptor</a>*)<a class="code" href="usbd_8h.html#a493e4798fe5bfedc234585d07aba775c">sceUsbdScanStaticDescriptor</a>(devId, device, <a class="code" href="usbd_8h.html#acb09b89c4c238b966761f3d6b22a115d">USB_DT_CONFIG</a>);</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        <span class="keywordflow">if</span> (config == <a class="code" href="defs_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) {</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;USBHDFSD: Error - Couldn&#39;t get configuration descriptor\n&quot;</span>);</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;        }</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        <span class="comment">/* check that at least one interface exists */</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        <a class="code" href="iLink_2IEEE1394__disk_2src_2include_2mass__debug_8h.html#a730a51a001461c80e0268109f4bdf849">XPRINTF</a>(<span class="stringliteral">&quot;USBHDFSD: bNumInterfaces %d\n&quot;</span>, config-&gt;<a class="code" href="structUsbConfigDescriptor.html#a22a8e7799cfe461babad4955304e68d7">bNumInterfaces</a>);</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        <span class="keywordflow">if</span> ((config-&gt;<a class="code" href="structUsbConfigDescriptor.html#a22a8e7799cfe461babad4955304e68d7">bNumInterfaces</a> &lt; 1) ||</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                (config-&gt;<a class="code" href="structUsbConfigDescriptor.html#a0b82a3d35c7ea0e3766478402d48e43a">wTotalLength</a> &lt; (<span class="keyword">sizeof</span>(<a class="code" href="structUsbConfigDescriptor.html">UsbConfigDescriptor</a>) + <span class="keyword">sizeof</span>(<a class="code" href="structUsbInterfaceDescriptor.html">UsbInterfaceDescriptor</a>)))) {</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                        <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;USBHDFSD: Error - No interfaces available\n&quot;</span>);</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;        }</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        <span class="comment">/* get interface */</span></div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        intf = (<a class="code" href="structUsbInterfaceDescriptor.html">UsbInterfaceDescriptor</a> *) ((<span class="keywordtype">char</span> *) config + config-&gt;<a class="code" href="structUsbConfigDescriptor.html#af9acfe2365b370b35f149c6289789d7b">bLength</a>); <span class="comment">/* Get first interface */</span></div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        <a class="code" href="iLink_2IEEE1394__disk_2src_2include_2mass__debug_8h.html#a730a51a001461c80e0268109f4bdf849">XPRINTF</a>(<span class="stringliteral">&quot;USBHDFSD: bInterfaceClass %X bInterfaceSubClass %X bInterfaceProtocol %X\n&quot;</span>,</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        intf-&gt;<a class="code" href="structUsbInterfaceDescriptor.html#a33e9148593d8cf426208f844a978e6e9">bInterfaceClass</a>, intf-&gt;<a class="code" href="structUsbInterfaceDescriptor.html#adb9e76d3ba09d655defce155fed43a87">bInterfaceSubClass</a>, intf-&gt;<a class="code" href="structUsbInterfaceDescriptor.html#a52137693093efad4878952a943cb9a27">bInterfaceProtocol</a>);</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160; </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        <span class="keywordflow">if</span> ((intf-&gt;<a class="code" href="structUsbInterfaceDescriptor.html#a33e9148593d8cf426208f844a978e6e9">bInterfaceClass</a>              != <a class="code" href="usbd_8h.html#aa99b73e335df09e6545fc44798a3c1f2">USB_CLASS_MASS_STORAGE</a>) ||</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                (intf-&gt;<a class="code" href="structUsbInterfaceDescriptor.html#adb9e76d3ba09d655defce155fed43a87">bInterfaceSubClass</a>       != <a class="code" href="usb__driver_8c.html#ae2835e96e62e9592c4beb40d87839775">USB_SUBCLASS_MASS_SCSI</a>  &amp;&amp;</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                 intf-&gt;<a class="code" href="structUsbInterfaceDescriptor.html#adb9e76d3ba09d655defce155fed43a87">bInterfaceSubClass</a>       != <a class="code" href="usb__driver_8c.html#a8a366d2bb2a83af0a4e251186e51b123">USB_SUBCLASS_MASS_SFF_8070I</a>) ||</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                (intf-&gt;<a class="code" href="structUsbInterfaceDescriptor.html#a52137693093efad4878952a943cb9a27">bInterfaceProtocol</a>       != <a class="code" href="usb__driver_8c.html#aed35669bb866993c4dca2d7eac7b0e45">USB_PROTOCOL_MASS_BULK_ONLY</a>) ||</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                (intf-&gt;<a class="code" href="structUsbInterfaceDescriptor.html#a322bc68b5bd492e76359d64f738332b5">bNumEndpoints</a> &lt; 2))    { <span class="comment">//4.3: There shall be at least 2 endpoints, for bulk in and bulk out.</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        }</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;}</div>
<div class="ttc" id="astructUsbConfigDescriptor_html_a0b82a3d35c7ea0e3766478402d48e43a"><div class="ttname"><a href="structUsbConfigDescriptor.html#a0b82a3d35c7ea0e3766478402d48e43a">UsbConfigDescriptor::wTotalLength</a></div><div class="ttdeci">u16 wTotalLength</div><div class="ttdef"><b>Definition:</b> <a href="usbd_8h_source.html#l00082">usbd.h:82</a></div></div>
<div class="ttc" id="astructUsbConfigDescriptor_html_a22a8e7799cfe461babad4955304e68d7"><div class="ttname"><a href="structUsbConfigDescriptor.html#a22a8e7799cfe461babad4955304e68d7">UsbConfigDescriptor::bNumInterfaces</a></div><div class="ttdeci">u8 bNumInterfaces</div><div class="ttdef"><b>Definition:</b> <a href="usbd_8h_source.html#l00083">usbd.h:83</a></div></div>
<div class="ttc" id="astructUsbDeviceDescriptor_html_ac2f85bb3a491aae80351e3418b09f7f6"><div class="ttname"><a href="structUsbDeviceDescriptor.html#ac2f85bb3a491aae80351e3418b09f7f6">UsbDeviceDescriptor::bNumConfigurations</a></div><div class="ttdeci">u8 bNumConfigurations</div><div class="ttdef"><b>Definition:</b> <a href="usbd_8h_source.html#l00074">usbd.h:74</a></div></div>
<div class="ttc" id="astructUsbInterfaceDescriptor_html_a33e9148593d8cf426208f844a978e6e9"><div class="ttname"><a href="structUsbInterfaceDescriptor.html#a33e9148593d8cf426208f844a978e6e9">UsbInterfaceDescriptor::bInterfaceClass</a></div><div class="ttdeci">u8 bInterfaceClass</div><div class="ttdef"><b>Definition:</b> <a href="usbd_8h_source.html#l00096">usbd.h:96</a></div></div>
<div class="ttc" id="astructUsbInterfaceDescriptor_html_a52137693093efad4878952a943cb9a27"><div class="ttname"><a href="structUsbInterfaceDescriptor.html#a52137693093efad4878952a943cb9a27">UsbInterfaceDescriptor::bInterfaceProtocol</a></div><div class="ttdeci">u8 bInterfaceProtocol</div><div class="ttdef"><b>Definition:</b> <a href="usbd_8h_source.html#l00098">usbd.h:98</a></div></div>
<div class="ttc" id="astructUsbInterfaceDescriptor_html_adb9e76d3ba09d655defce155fed43a87"><div class="ttname"><a href="structUsbInterfaceDescriptor.html#adb9e76d3ba09d655defce155fed43a87">UsbInterfaceDescriptor::bInterfaceSubClass</a></div><div class="ttdeci">u8 bInterfaceSubClass</div><div class="ttdef"><b>Definition:</b> <a href="usbd_8h_source.html#l00097">usbd.h:97</a></div></div>
<div class="ttc" id="ausb__driver_8c_html_a8a366d2bb2a83af0a4e251186e51b123"><div class="ttname"><a href="usb__driver_8c.html#a8a366d2bb2a83af0a4e251186e51b123">USB_SUBCLASS_MASS_SFF_8070I</a></div><div class="ttdeci">#define USB_SUBCLASS_MASS_SFF_8070I</div><div class="ttdef"><b>Definition:</b> <a href="usb__driver_8c_source.html#l00028">usb_driver.c:28</a></div></div>
<div class="ttc" id="ausb__driver_8c_html_ae2835e96e62e9592c4beb40d87839775"><div class="ttname"><a href="usb__driver_8c.html#ae2835e96e62e9592c4beb40d87839775">USB_SUBCLASS_MASS_SCSI</a></div><div class="ttdeci">#define USB_SUBCLASS_MASS_SCSI</div><div class="ttdef"><b>Definition:</b> <a href="usb__driver_8c_source.html#l00029">usb_driver.c:29</a></div></div>
<div class="ttc" id="ausb__driver_8c_html_aed35669bb866993c4dca2d7eac7b0e45"><div class="ttname"><a href="usb__driver_8c.html#aed35669bb866993c4dca2d7eac7b0e45">USB_PROTOCOL_MASS_BULK_ONLY</a></div><div class="ttdeci">#define USB_PROTOCOL_MASS_BULK_ONLY</div><div class="ttdef"><b>Definition:</b> <a href="usb__driver_8c_source.html#l00033">usb_driver.c:33</a></div></div>
<div class="ttc" id="ausbd_8h_html_aa99b73e335df09e6545fc44798a3c1f2"><div class="ttname"><a href="usbd_8h.html#aa99b73e335df09e6545fc44798a3c1f2">USB_CLASS_MASS_STORAGE</a></div><div class="ttdeci">#define USB_CLASS_MASS_STORAGE</div><div class="ttdef"><b>Definition:</b> <a href="usbd_8h_source.html#l00144">usbd.h:144</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="usbd_8h_source.html#l00096">UsbInterfaceDescriptor::bInterfaceClass</a>, <a class="el" href="usbd_8h_source.html#l00098">UsbInterfaceDescriptor::bInterfaceProtocol</a>, <a class="el" href="usbd_8h_source.html#l00097">UsbInterfaceDescriptor::bInterfaceSubClass</a>, <a class="el" href="usbd_8h_source.html#l00078">UsbConfigDescriptor::bLength</a>, <a class="el" href="usbd_8h_source.html#l00074">UsbDeviceDescriptor::bNumConfigurations</a>, <a class="el" href="usbd_8h_source.html#l00095">UsbInterfaceDescriptor::bNumEndpoints</a>, <a class="el" href="usbd_8h_source.html#l00083">UsbConfigDescriptor::bNumInterfaces</a>, <a class="el" href="usb__driver_8c_source.html#l00741">mass_stor_findDevice()</a>, <a class="el" href="defs_8h_source.html#l00022">NULL</a>, <a class="el" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf()</a>, <a class="el" href="interface_8c_source.html#l00101">sceUsbdScanStaticDescriptor()</a>, <a class="el" href="usb__mass_8c_source.html#l00045">mass_dev::status</a>, <a class="el" href="usbd_8h_source.html#l00144">USB_CLASS_MASS_STORAGE</a>, <a class="el" href="usbd_8h_source.html#l00187">USB_DT_CONFIG</a>, <a class="el" href="usbd_8h_source.html#l00186">USB_DT_DEVICE</a>, <a class="el" href="usb__driver_8c_source.html#l00033">USB_PROTOCOL_MASS_BULK_ONLY</a>, <a class="el" href="usb__driver_8c_source.html#l00029">USB_SUBCLASS_MASS_SCSI</a>, <a class="el" href="usb__driver_8c_source.html#l00028">USB_SUBCLASS_MASS_SFF_8070I</a>, <a class="el" href="usbhdfsd-common_8h_source.html#l00036">USBMASS_DEV_STAT_CONN</a>, <a class="el" href="usbd_8h_source.html#l00082">UsbConfigDescriptor::wTotalLength</a>, and <a class="el" href="iLink_2IEEE1394__disk_2src_2include_2mass__debug_8h_source.html#l00008">XPRINTF</a>.</p>

<p class="reference">Referenced by <a class="el" href="usb__driver_8c_source.html#l01123">InitUSB()</a>.</p>

</div>
</div>
<a id="aad018ebccc3b00d1692c6d82f651a841"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad018ebccc3b00d1692c6d82f651a841">&#9670;&nbsp;</a></span>mass_stor_readSector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mass_stor_readSector </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmass__dev.html">mass_dev</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>sector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short int&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="usb__driver_8c_source.html#l00763">763</a> of file <a class="el" href="usb__driver_8c_source.html">usb_driver.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;{</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        <span class="keywordtype">int</span> retries;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        <span class="keywordflow">for</span>(retries = <a class="code" href="usb__driver_8c.html#a5d1672149faf44168c0aa74c85905737">USB_IO_MAX_RETRIES</a>; retries &gt; 0; retries--)</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        {</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="usb__driver_8c.html#a6fc63303254ac32ac44815291ddcdcb9">cbw_scsi_read_sector</a>(dev, sector, <a class="code" href="sior_8c.html#a12a89c3c8fa5f42541ab342d3b88c82d">buffer</a>, count) == 0)</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        }</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160; </div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="errno_8h.html#a70979f50f9c83e5aebab3d6a1bd4cf35">EIO</a>;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;}</div>
<div class="ttc" id="aerrno_8h_html_a70979f50f9c83e5aebab3d6a1bd4cf35"><div class="ttname"><a href="errno_8h.html#a70979f50f9c83e5aebab3d6a1bd4cf35">EIO</a></div><div class="ttdeci">#define EIO</div><div class="ttdef"><b>Definition:</b> <a href="errno_8h_source.html#l00028">errno.h:28</a></div></div>
<div class="ttc" id="asior_8c_html_a12a89c3c8fa5f42541ab342d3b88c82d"><div class="ttname"><a href="sior_8c.html#a12a89c3c8fa5f42541ab342d3b88c82d">buffer</a></div><div class="ttdeci">static union siorCommsData buffer</div><div class="ttdef"><b>Definition:</b> <a href="sior_8c_source.html#l00023">sior.c:28</a></div></div>
<div class="ttc" id="ausb__driver_8c_html_a5d1672149faf44168c0aa74c85905737"><div class="ttname"><a href="usb__driver_8c.html#a5d1672149faf44168c0aa74c85905737">USB_IO_MAX_RETRIES</a></div><div class="ttdeci">#define USB_IO_MAX_RETRIES</div><div class="ttdef"><b>Definition:</b> <a href="usb__driver_8c_source.html#l00047">usb_driver.c:47</a></div></div>
<div class="ttc" id="ausb__driver_8c_html_a6fc63303254ac32ac44815291ddcdcb9"><div class="ttname"><a href="usb__driver_8c.html#a6fc63303254ac32ac44815291ddcdcb9">cbw_scsi_read_sector</a></div><div class="ttdeci">static int cbw_scsi_read_sector(mass_dev *dev, unsigned int lba, void *buffer, unsigned short int sectorCount)</div><div class="ttdef"><b>Definition:</b> <a href="usb__driver_8c_source.html#l00641">usb_driver.c:641</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="sior_8c_source.html#l00028">buffer</a>, <a class="el" href="usb__driver_8c_source.html#l00641">cbw_scsi_read_sector()</a>, <a class="el" href="errno_8h_source.html#l00028">EIO</a>, and <a class="el" href="usb__driver_8c_source.html#l00047">USB_IO_MAX_RETRIES</a>.</p>

</div>
</div>
<a id="a0813700a4e08c14f8e6e813017933266"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0813700a4e08c14f8e6e813017933266">&#9670;&nbsp;</a></span>mass_stor_stop_unit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mass_stor_stop_unit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmass__dev.html">mass_dev</a> *&#160;</td>
          <td class="paramname"><em>dev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="usb__driver_8c_source.html#l01186">1186</a> of file <a class="el" href="usb__driver_8c_source.html">usb_driver.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;{</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        <span class="keywordtype">int</span> stat;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160; </div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;        <span class="keywordflow">if</span> ((stat = <a class="code" href="usb__driver_8c.html#ad152a2fcc17ce95c8ebd8d808038294d">cbw_scsi_start_stop_unit</a>(dev, 0)) != 0) {</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;                <a class="code" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf</a>(<span class="stringliteral">&quot;USBHDFSD: Error - cbw_scsi_start_stop_unit %d\n&quot;</span>, stat);</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;        }</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160; </div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;        <span class="keywordflow">return</span> stat;</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;}</div>
<div class="ttc" id="ausb__driver_8c_html_ad152a2fcc17ce95c8ebd8d808038294d"><div class="ttname"><a href="usb__driver_8c.html#ad152a2fcc17ce95c8ebd8d808038294d">cbw_scsi_start_stop_unit</a></div><div class="ttdeci">static int cbw_scsi_start_stop_unit(mass_dev *dev, u8 param)</div><div class="ttdef"><b>Definition:</b> <a href="usb__driver_8c_source.html#l00556">usb_driver.c:556</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="usb__driver_8c_source.html#l00556">cbw_scsi_start_stop_unit()</a>, and <a class="el" href="stdio_8h.html#a98631211a4a8aee62f572375d5b637be">printf()</a>.</p>

<p class="reference">Referenced by <a class="el" href="usb_2usbhdfsd_2src_2fs__driver_8c_source.html#l00771">fs_devctl()</a>, and <a class="el" href="usb__driver_8c_source.html#l01197">mass_store_stop_all()</a>.</p>

</div>
</div>
<a id="a34f0975260907a88be14dafd4f392d48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34f0975260907a88be14dafd4f392d48">&#9670;&nbsp;</a></span>mass_stor_writeSector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mass_stor_writeSector </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmass__dev.html">mass_dev</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>sector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short int&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="usb__driver_8c_source.html#l00776">776</a> of file <a class="el" href="usb__driver_8c_source.html">usb_driver.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;{</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        <span class="keywordtype">int</span> retries;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160; </div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        <span class="keywordflow">for</span>(retries = <a class="code" href="usb__driver_8c.html#a5d1672149faf44168c0aa74c85905737">USB_IO_MAX_RETRIES</a>; retries &gt; 0; retries--)</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        {</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                <span class="keywordflow">if</span>(<a class="code" href="usb__driver_8c.html#a9e02364208baf7859b3db3404d332f38">cbw_scsi_write_sector</a>(dev, sector, <a class="code" href="sior_8c.html#a12a89c3c8fa5f42541ab342d3b88c82d">buffer</a>, count) == 0)</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;        }</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        <span class="keywordflow">return</span> -<a class="code" href="errno_8h.html#a70979f50f9c83e5aebab3d6a1bd4cf35">EIO</a>;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;}</div>
<div class="ttc" id="ausb__driver_8c_html_a9e02364208baf7859b3db3404d332f38"><div class="ttname"><a href="usb__driver_8c.html#a9e02364208baf7859b3db3404d332f38">cbw_scsi_write_sector</a></div><div class="ttdeci">static int cbw_scsi_write_sector(mass_dev *dev, unsigned int lba, const void *buffer, unsigned short int sectorCount)</div><div class="ttdef"><b>Definition:</b> <a href="usb__driver_8c_source.html#l00691">usb_driver.c:691</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="sior_8c_source.html#l00028">buffer</a>, <a class="el" href="usb__driver_8c_source.html#l00691">cbw_scsi_write_sector()</a>, <a class="el" href="errno_8h_source.html#l00028">EIO</a>, and <a class="el" href="usb__driver_8c_source.html#l00047">USB_IO_MAX_RETRIES</a>.</p>

</div>
</div>
<a id="a94799aabb4160efa5fe7a64b9b0fe8a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a94799aabb4160efa5fe7a64b9b0fe8a4">&#9670;&nbsp;</a></span>mass_store_stop_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mass_store_stop_all </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="usb__driver_8c_source.html#l01197">1197</a> of file <a class="el" href="usb__driver_8c_source.html">usb_driver.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;{</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160; </div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="usb__driver_8c.html#a7020e20a18e8488cd19315887c473ce2">NUM_DEVICES</a>; ++i)</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        {</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;                <a class="code" href="structmass__dev.html">mass_dev</a> *dev = &amp;<a class="code" href="usb__driver_8c.html#a83eb6082c41fc8330020e4ef4dbffa9a">g_mass_device</a>[i];</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;                <span class="keywordflow">if</span> (dev-&gt;<a class="code" href="structmass__dev.html#afe3c44bc7f3dace3dcb0c55df1ba5910">devId</a> != -1 &amp;&amp; (dev-&gt;<a class="code" href="structmass__dev.html#a6be7575bf966a660f803dac1a3ea93a8">status</a> &amp; <a class="code" href="usbhdfsd-common_8h.html#aa5c99685aa651d8ce438c6a9f0cd3152">USBMASS_DEV_STAT_CONN</a>))</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;                {</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                        <span class="keywordflow">if</span>(!(dev-&gt;<a class="code" href="structmass__dev.html#a6be7575bf966a660f803dac1a3ea93a8">status</a> &amp; <a class="code" href="usbhdfsd-common_8h.html#af2a46b2bb1f8bf8aaae7fb2578328540">USBMASS_DEV_STAT_CONF</a>))</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;                        {       <span class="comment">//Configure unconfigured devices, to be able to shut them down.</span></div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="usb__driver_8c.html#aed1ce7a5a6c88412c4c29698e59fe19f">mass_store_configureDevice</a>(dev) != <a class="code" href="usbd_8h.html#a3b8b9136f0f637fbcc6295a7862051b4">USB_RC_OK</a>)</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;                                        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;                        }</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160; </div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;                        <a class="code" href="usb__driver_8c.html#a0813700a4e08c14f8e6e813017933266">mass_stor_stop_unit</a>(dev);</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                }</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        }</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;}</div>
<div class="ttc" id="ausb__driver_8c_html_a0813700a4e08c14f8e6e813017933266"><div class="ttname"><a href="usb__driver_8c.html#a0813700a4e08c14f8e6e813017933266">mass_stor_stop_unit</a></div><div class="ttdeci">int mass_stor_stop_unit(mass_dev *dev)</div><div class="ttdef"><b>Definition:</b> <a href="usb__driver_8c_source.html#l01186">usb_driver.c:1186</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="usb__mass_8c_source.html#l00043">mass_dev::devId</a>, <a class="el" href="usb__driver_8c_source.html#l00117">g_mass_device</a>, <a class="el" href="usb__driver_8c_source.html#l01186">mass_stor_stop_unit()</a>, <a class="el" href="usb__driver_8c_source.html#l01055">mass_store_configureDevice()</a>, <a class="el" href="usb__driver_8c_source.html#l00116">NUM_DEVICES</a>, <a class="el" href="usb__mass_8c_source.html#l00045">mass_dev::status</a>, <a class="el" href="usbd_8h_source.html#l00211">USB_RC_OK</a>, <a class="el" href="usbhdfsd-common_8h_source.html#l00038">USBMASS_DEV_STAT_CONF</a>, and <a class="el" href="usbhdfsd-common_8h_source.html#l00036">USBMASS_DEV_STAT_CONN</a>.</p>

<p class="reference">Referenced by <a class="el" href="usb_2usbhdfsd_2src_2fs__driver_8c_source.html#l00771">fs_devctl()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_0981ace215aa2029f526b70c145b9fbe.html">iop</a></li><li class="navelem"><a class="el" href="dir_b6c875632944d243a548db157cd77ec2.html">usb</a></li><li class="navelem"><a class="el" href="dir_b8874c233d466218401f983297aca89b.html">usbhdfsd</a></li><li class="navelem"><a class="el" href="dir_35e4cd4c6b68d708ba33184e89b685ac.html">src</a></li><li class="navelem"><a class="el" href="dir_6fd08c545c881b4d2b356c02a10aa6b3.html">include</a></li><li class="navelem"><a class="el" href="mass__stor_8h.html">mass_stor.h</a></li>
    <li class="footer">Generated on Thu Feb 11 2021 11:42:47 for ps2sdk by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
</body>
</html>
