<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ps2sdk: File I/O</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="code.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ps2sdk
   &#160;<span id="projectnumber">1.1</span>
   </div>
   <div id="projectbrief">A collection of Open Source libraries used for developing applications on Sony&#39;s PlayStation 2Â® (PS2).</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__file__io.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Modules</a>  </div>
  <div class="headertitle">
<div class="title">File I/O</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group__libfileio"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__libfileio.html">FILEIO: EE FILEIO RPC Client</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__libfileXio"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__libfileXio.html">FileXio: EE FileXio RPC Client</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>File input and output on the EE. </p>


<h3><a id="file_over"></a>Overview</h3><div class="textblock"><h1><a class="anchor" id="Libraries"></a>
Libraries</h1>
<p>There are two file I/O libraries provided with ps2sdk. Most file I/O is done generally by using a device driver on the IOP and communicating to it through the SIF RPC interface.</p>
<h2><a class="anchor" id="FILEIO"></a>
FILEIO</h2>
<p>The <a class="el" href="group__libfileio.html">FILEIO</a> library provides basic functionality through rom0:XFILEIO in the bios. Newer versions of XFILEIO are incompatible with the EE RPC client protocol in ps2sdk.</p>
<p><b>IRX Modules:</b> </p><ul>
<li>rom0:IOMAN </li>
<li>rom0:XFILEIO</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>These modules are not provided by early Japanese models.</dd></dl>
<h2><a class="anchor" id="FileXio"></a>
FileXio</h2>
<p>The <a class="el" href="group__libfileXio.html">fileXio</a> library provides extended functionality through iomanX.irx and fileXio.irx in ps2sdk.</p>
<p><b>IRX Modules:</b> </p><ul>
<li>iomanX.irx </li>
<li>fileXio.irx</li>
</ul>
<h1><a class="anchor" id="paths"></a>
Paths</h1>
<p>This is how a pathname generally looks. </p><pre class="fragment">  "&lt;device&gt;&lt;unit&gt;:&lt;path&gt;"
</pre> <ul>
<li><code>device</code> is the device specifier. </li>
<li><code>unit</code> is a number specifying the specific device, sometimes optional. </li>
<li><code></code>: is the separator between the device and the path on the device. </li>
<li><code>path</code> is the path on the device.</li>
</ul>
<h1><a class="anchor" id="Devices"></a>
Devices</h1>
<p>Each device on the IOP define their own implementations for the following functions. Their behavior is similar to the related POSIX functions but return values are negatively signed errno codes on failure.</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> open(<span class="keyword">const</span> <span class="keywordtype">char</span> *path, <span class="keywordtype">int</span> flags, <span class="keywordtype">int</span> <a class="code" href="rpc__client_8c.html#ab9b282fdbe49dba4d8d389f3ad40f9c3">mode</a>);</div>
<div class="line"><span class="keywordtype">int</span> close(<span class="keywordtype">int</span> fd);</div>
<div class="line"><span class="keywordtype">int</span> read(<span class="keywordtype">int</span> fd, <span class="keywordtype">void</span>* buf, <span class="keywordtype">int</span> size);</div>
<div class="line"><span class="keywordtype">int</span> write(<span class="keywordtype">int</span> fd, <span class="keywordtype">void</span> *buf, <span class="keywordtype">int</span> size);</div>
<div class="line"><span class="keywordtype">int</span> lseek(<span class="keywordtype">int</span> fd, <span class="keywordtype">int</span> offset, <span class="keywordtype">int</span> whence);</div>
<div class="line"><span class="keywordtype">int</span> ioctl(<span class="keywordtype">int</span> fd, <span class="keywordtype">int</span> <a class="code" href="structrequest.html">request</a>, <span class="keywordtype">void</span> *buf);</div>
<div class="line"><span class="keywordtype">int</span> remove(<span class="keyword">const</span> <span class="keywordtype">char</span> *path);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="ps2sdkapi_8c.html#a548e5b744ca2e97beb61ad7aa41114e2">mkdir</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *path, <span class="keywordtype">int</span> <a class="code" href="rpc__client_8c.html#ab9b282fdbe49dba4d8d389f3ad40f9c3">mode</a>);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="ps2sdkapi_8c.html#ab2df76f2c62ae012c2e417813b5fe8ce">rmdir</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *path);</div>
<div class="line"><span class="keywordtype">int</span> dopen(<span class="keyword">const</span> <span class="keywordtype">char</span> *path);</div>
<div class="line"><span class="keywordtype">int</span> dclose(<span class="keywordtype">int</span> fd);</div>
<div class="line"><span class="keywordtype">int</span> dread(<span class="keywordtype">int</span> fd, <span class="keywordtype">void</span> *buf);</div>
<div class="line"><span class="keywordtype">int</span> getstat(<span class="keyword">const</span> <span class="keywordtype">char</span> *path, <span class="keywordtype">void</span> *buf);</div>
<div class="line"><span class="keywordtype">int</span> chstat(<span class="keyword">const</span> <span class="keywordtype">char</span> *path, <span class="keywordtype">void</span> *buf, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mask);</div>
<div class="line"><span class="keywordtype">int</span> format(<span class="keyword">const</span> <span class="keywordtype">char</span> *dev, <span class="keyword">const</span> <span class="keywordtype">char</span> *block, <span class="keywordtype">void</span> *arg, <span class="keywordtype">int</span> arglen);</div>
<div class="line"><span class="keywordtype">int</span> rename(<span class="keyword">const</span> <span class="keywordtype">char</span> *old_name, <span class="keyword">const</span> <span class="keywordtype">char</span> *new_name);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="init_8c.html#a03af571dfb595681bfa203c83385c07b">chdir</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *name);</div>
<div class="line"><span class="keywordtype">int</span> sync(<span class="keyword">const</span> <span class="keywordtype">char</span> *device, <span class="keywordtype">int</span> flag);</div>
<div class="line"><span class="keywordtype">int</span> mount(<span class="keyword">const</span> <span class="keywordtype">char</span> *mnt, <span class="keyword">const</span> <span class="keywordtype">char</span> *src, <span class="keywordtype">int</span> flag, <span class="keywordtype">void</span> *arg, <span class="keywordtype">int</span> arglen);</div>
<div class="line"><span class="keywordtype">int</span> umount(<span class="keyword">const</span> <span class="keywordtype">char</span> *mnt);</div>
<div class="line"><span class="keywordtype">long</span> <span class="keywordtype">long</span> <a class="code" href="ps2sdkapi_8h.html#a80fbb49a506d5ebb2869beee8c4933e2">lseek64</a>(<span class="keywordtype">int</span> fd, <span class="keywordtype">long</span> <span class="keywordtype">long</span> offset, <span class="keywordtype">int</span> whence);</div>
<div class="line"><span class="keywordtype">int</span> devctl(<span class="keyword">const</span> <span class="keywordtype">char</span> *name, <span class="keywordtype">int</span> cmd, <span class="keywordtype">void</span> *arg, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> arglen, <span class="keywordtype">void</span> *buf, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> buflen);</div>
<div class="line"><span class="keywordtype">int</span> symlink(<span class="keyword">const</span> <span class="keywordtype">char</span> *old, <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">new</span>);</div>
<div class="line"><span class="keywordtype">int</span> readlink(<span class="keyword">const</span> <span class="keywordtype">char</span> *path, <span class="keywordtype">char</span> *buf, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> buflen);</div>
<div class="line"><span class="keywordtype">int</span> ioctl2(<span class="keywordtype">int</span> fd, <span class="keywordtype">int</span> cmd, <span class="keywordtype">void</span> *arg, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> arglen, <span class="keywordtype">void</span> *buf, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> buflen);</div>
<div class="ttc" id="ainit_8c_html_a03af571dfb595681bfa203c83385c07b"><div class="ttname"><a href="init_8c.html#a03af571dfb595681bfa203c83385c07b">chdir</a></div><div class="ttdeci">int chdir(const char *path)</div><div class="ttdef"><b>Definition:</b> <a href="ps2sdkapi_8c_source.html#l00461">ps2sdkapi.c:461</a></div></div>
<div class="ttc" id="aps2sdkapi_8c_html_a548e5b744ca2e97beb61ad7aa41114e2"><div class="ttname"><a href="ps2sdkapi_8c.html#a548e5b744ca2e97beb61ad7aa41114e2">mkdir</a></div><div class="ttdeci">int mkdir(const char *path, mode_t mode)</div><div class="ttdef"><b>Definition:</b> <a href="ps2sdkapi_8c_source.html#l00466">ps2sdkapi.c:466</a></div></div>
<div class="ttc" id="aps2sdkapi_8c_html_ab2df76f2c62ae012c2e417813b5fe8ce"><div class="ttname"><a href="ps2sdkapi_8c.html#ab2df76f2c62ae012c2e417813b5fe8ce">rmdir</a></div><div class="ttdeci">int rmdir(const char *path)</div><div class="ttdef"><b>Definition:</b> <a href="ps2sdkapi_8c_source.html#l00470">ps2sdkapi.c:470</a></div></div>
<div class="ttc" id="aps2sdkapi_8h_html_a80fbb49a506d5ebb2869beee8c4933e2"><div class="ttname"><a href="ps2sdkapi_8h.html#a80fbb49a506d5ebb2869beee8c4933e2">lseek64</a></div><div class="ttdeci">off64_t lseek64(int fd, off64_t offset, int whence)</div><div class="ttdef"><b>Definition:</b> <a href="ps2sdkapi_8c_source.html#l00453">ps2sdkapi.c:453</a></div></div>
<div class="ttc" id="arpc__client_8c_html_ab9b282fdbe49dba4d8d389f3ad40f9c3"><div class="ttname"><a href="rpc__client_8c.html#ab9b282fdbe49dba4d8d389f3ad40f9c3">mode</a></div><div class="ttdeci">s32 mode</div><div class="ttdef"><b>Definition:</b> <a href="rpc__client_8c_source.html#l00015">rpc_client.c:15</a></div></div>
<div class="ttc" id="astructrequest_html"><div class="ttname"><a href="structrequest.html">request</a></div><div class="ttdef"><b>Definition:</b> <a href="thread_8c_source.html#l00017">thread.c:17</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="mcards"></a>
Memory Cards</h2>
<p><b>IRX Modules:</b> </p><ul>
<li>sio2man.irx </li>
<li>mcman.irx </li>
<li>mcserv.irx</li>
</ul>
<dl class="section user"><dt>Path:</dt><dd><pre class="fragment">  "mc&lt;unit&gt;:&lt;path&gt;"
</pre> See <a class="el" href="group__libmc.html">libmc: memorycard library.</a> for more details.</dd></dl>
<h2><a class="anchor" id="mass"></a>
USB Mass Storage Devices</h2>
<p><b>IRX Modules:</b> </p><ul>
<li>usbd.irx </li>
<li>usbhdfsd.irx</li>
</ul>
<dl class="section user"><dt>Path:</dt><dd><pre class="fragment">  "mass&lt;unit&gt;:&lt;path&gt;"
</pre> </dd></dl>
<dl class="section note"><dt>Note</dt><dd>The unit specifier is optional if only accessing the first connected device. E.g "mass:/"</dd>
<dd>
Supports up to two devices with 4 primary partitions.</dd></dl>
<dl class="section attention"><dt>Attention</dt><dd>It takes a few seconds to warm up and initialize USB devices. Introduce a delay prior to accessing files on a USB mass storage device after loading the usbd and usbhdfsd IRX modules.</dd></dl>
<h2><a class="anchor" id="hdd"></a>
Hard Disk Drives</h2>
<p><b>IRX Modules:</b> </p><ul>
<li>ps2dev9.irx </li>
<li>ps2atad.irx (or hdproatad.irx for the HDPro Kit) </li>
<li>ps2hdd.irx </li>
<li>ps2fs.irx</li>
</ul>
<p>The ps2hdd module has two arguments. </p><ul>
<li><code>-o</code> for max open files (default 1) </li>
<li><code>-n</code> for number of caches (default 3)</li>
</ul>
<p>The ps2fs module has three arguments. </p><ul>
<li><code>-m</code> max mounts allowed (default 1) </li>
<li><code>-o</code> max open files (default 2) </li>
<li><code>-n</code> number of buffers (default 8) (add two per open file)</li>
</ul>
<dl class="section user"><dt>Path:</dt><dd><pre class="fragment">  "hdd&lt;unit&gt;:&lt;name&gt;,&lt;fp&gt;,&lt;rp&gt;,&lt;sz&gt;,&lt;PFS&gt;"
</pre> <ul>
<li><code>name</code> is the name of the partition. </li>
<li><code>fp</code> is a string indicating the full access password. </li>
<li><code>rp</code> is a string indicating the read only password. </li>
<li><code>sz</code> is a string indicating size when creating partitions. </li>
<li><code>PFS</code> is the type of partition to open, PFS, CFS, EXT2, EXT2SWAP.</li>
</ul>
</dd></dl>
<dl class="section user"><dt>Example:</dt><dd>Open the partition table and read an entry. <div class="fragment"><div class="line"><span class="keywordtype">int</span> fd = <a class="code" href="fileXio__rpc_8h.html#a856c3c352f2039330d130a12d38f528c">fileXioDopen</a>(<span class="stringliteral">&quot;hdd0:&quot;</span>);</div>
<div class="line"><a class="code" href="fileXio__rpc_8h.html#a0cfa891154acafa36f64eebc8992fb7e">fileXioDread</a>(fd, &amp;io_stat);</div>
<div class="line"><a class="code" href="fileXio__rpc_8h.html#a7b01795bf6048dd2accafe75eebe56db">fileXioDclose</a>(fd);</div>
<div class="ttc" id="afileXio__rpc_8h_html_a0cfa891154acafa36f64eebc8992fb7e"><div class="ttname"><a href="fileXio__rpc_8h.html#a0cfa891154acafa36f64eebc8992fb7e">fileXioDread</a></div><div class="ttdeci">int fileXioDread(int fd, iox_dirent_t *dirent)</div><div class="ttdef"><b>Definition:</b> <a href="fileXio__rpc_8c_source.html#l00948">fileXio_rpc.c:948</a></div></div>
<div class="ttc" id="afileXio__rpc_8h_html_a7b01795bf6048dd2accafe75eebe56db"><div class="ttname"><a href="fileXio__rpc_8h.html#a7b01795bf6048dd2accafe75eebe56db">fileXioDclose</a></div><div class="ttdeci">int fileXioDclose(int fd)</div><div class="ttdef"><b>Definition:</b> <a href="fileXio__rpc_8c_source.html#l00924">fileXio_rpc.c:924</a></div></div>
<div class="ttc" id="afileXio__rpc_8h_html_a856c3c352f2039330d130a12d38f528c"><div class="ttname"><a href="fileXio__rpc_8h.html#a856c3c352f2039330d130a12d38f528c">fileXioDopen</a></div><div class="ttdeci">int fileXioDopen(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="fileXio__rpc_8c_source.html#l00900">fileXio_rpc.c:900</a></div></div>
</div><!-- fragment --></dd></dl>
<dl class="section user"><dt>Example:</dt><dd>Create a 4GB sized +MYPART partition using the PFS format without a password. <div class="fragment"><div class="line"><a class="code" href="fileXio__rpc_8h.html#acc6665879c02861a0f6e8d2fecc527df">fileXioOpen</a>(<span class="stringliteral">&quot;hdd0:+MYPART,,,4G,PFS&quot;</span>,IO_CREAT|IO_RDWR);</div>
<div class="ttc" id="afileXio__rpc_8h_html_acc6665879c02861a0f6e8d2fecc527df"><div class="ttname"><a href="fileXio__rpc_8h.html#acc6665879c02861a0f6e8d2fecc527df">fileXioOpen</a></div><div class="ttdeci">int fileXioOpen(const char *source, int flags,...)</div><div class="ttdef"><b>Definition:</b> <a href="fileXio__rpc_8c_source.html#l00581">fileXio_rpc.c:581</a></div></div>
</div><!-- fragment --></dd></dl>
<dl class="section user"><dt>Example:</dt><dd>Mount the +MYPART partition read only. <div class="fragment"><div class="line"><a class="code" href="fileXio__rpc_8h.html#a6387b98e2ec102eda22bd4fd643b501d">fileXioMount</a>(<span class="stringliteral">&quot;pfs0:&quot;</span>,<span class="stringliteral">&quot;hdd0:+MYPART&quot;</span>,IO_RDONLY);</div>
<div class="ttc" id="afileXio__rpc_8h_html_a6387b98e2ec102eda22bd4fd643b501d"><div class="ttname"><a href="fileXio__rpc_8h.html#a6387b98e2ec102eda22bd4fd643b501d">fileXioMount</a></div><div class="ttdeci">int fileXioMount(const char *mountpoint, const char *blockdev, int flag)</div><div class="ttdef"><b>Definition:</b> <a href="fileXio__rpc_8c_source.html#l00319">fileXio_rpc.c:319</a></div></div>
</div><!-- fragment --></dd></dl>
<dl class="section user"><dt>Example:</dt><dd>Unmount the +MYPART partition. <div class="fragment"><div class="line"><a class="code" href="fileXio__rpc_8h.html#aacd6c43689f6f51cc4f60a2233459df7">fileXioUmount</a>(<span class="stringliteral">&quot;pfs0:&quot;</span>);</div>
<div class="ttc" id="afileXio__rpc_8h_html_aacd6c43689f6f51cc4f60a2233459df7"><div class="ttname"><a href="fileXio__rpc_8h.html#aacd6c43689f6f51cc4f60a2233459df7">fileXioUmount</a></div><div class="ttdeci">int fileXioUmount(const char *mountpoint)</div><div class="ttdef"><b>Definition:</b> <a href="fileXio__rpc_8c_source.html#l00346">fileXio_rpc.c:346</a></div></div>
</div><!-- fragment --></dd></dl>
<dl class="section note"><dt>Note</dt><dd>The general convention is to use a '+' sign to indicate a partition that isn't related to official games or system use.</dd></dl>
<dl class="section attention"><dt>Attention</dt><dd>It takes a while for hard disk drives to initialize so introduce a delay prior to accessing a hard disk or hard disk partition.</dd></dl>
<p>See <a class="el" href="libhdd_8c.html">libhdd.c</a> for more detailed usage. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Thu Feb 11 2021 11:42:26 for ps2sdk by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
</body>
</html>
